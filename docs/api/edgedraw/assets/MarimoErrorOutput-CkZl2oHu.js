var je=Object.defineProperty;var be=(t,e,n)=>e in t?je(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var $=(t,e,n)=>be(t,typeof e!="symbol"?e+"":e,n);import{s as k}from"./chunk-DZLz74EQ.js";import{c as ve,l as Ne,n as K,s as we,u as Ie}from"./jotai-C7U7c6dd.js";import{t as ke}from"./react-cj45iF1i.js";import{Dr as Ae,Gn as $e,Ht as Te,Kr as _e,Ut as Me,ht as Ce,kr as Ee,n as Fe,tn as W,vt as Le,w as Se,wt as Pe,y as ze,yt as Oe}from"./cells-CAMtfgeb.js";import{t as H}from"./compiler-runtime-bbSa6V1W.js";import{u as qe}from"./hotkeys-jCLisiwR.js";import{t as Ue}from"./invariant-D5a0EE05.js";import{r as De}from"./utils-BPcfRUDE.js";import{t as Re}from"./jsx-runtime-DmpivWpf.js";import{t as X}from"./cn-BaXqCYqP.js";import{t as F}from"./button-DCB7VoVL.js";import{a as Be}from"./dist-YP2XXp1Z.js";import{t as Q}from"./createLucideIcon-DbfgBYhq.js";import{_ as We}from"./select-E33nSIDn.js";import{a as He,p as Qe,r as Ve,t as Ge}from"./dropdown-menu-k3cvSs56.js";import{a as Je,n as Ke}from"./state-dWjslxDZ.js";import{t as Y}from"./tooltip-QlUG_0sW.js";import{a as Xe,i as Ye,n as Ze,r as et,t as tt}from"./multi-map-CMSc8wqP.js";import{r as rt,t as st}from"./alert-DZiaW65G.js";import{t as Z}from"./kbd-BEZA_QXE.js";import{n as N}from"./cell-link-CGc-QK-U.js";import{t as L}from"./links-Cd3tV5IK.js";var ee=Q("notebook-pen",[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]]),S=Q("square-arrow-out-up-right",[["path",{d:"M21 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h6",key:"y09zxi"}],["path",{d:"m21 3-9 9",key:"mpx6sq"}],["path",{d:"M15 3h6v6",key:"1q9fwt"}]]),V=Q("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]]),te,T;function nt(t,e,n,s,i){var l={};return Object.keys(s).forEach(function(a){l[a]=s[a]}),l.enumerable=!!l.enumerable,l.configurable=!!l.configurable,("value"in l||l.initializer)&&(l.writable=!0),l=n.slice().reverse().reduce(function(a,o){return o(t,e,a)||a},l),i&&l.initializer!==void 0&&(l.value=l.initializer?l.initializer.call(i):void 0,l.initializer=void 0),l.initializer===void 0?(Object.defineProperty(t,e,l),null):l}var re=class{async getAttachments(t){return[]}asURI(t){return`${this.contextType}://${t}`}parseContextIds(t){let e=RegExp(`${this.mentionPrefix}([\\w-]+):\\/\\/([\\w./-]+)`,"g"),n=[...t.matchAll(e)],s=l=>l.slice(1),i=n.filter(([,l])=>l===this.contextType).map(([l])=>s(l));return[...new Set(i)]}createBasicCompletion(t,e){return{label:`${this.mentionPrefix}${t.uri.split("://")[1]}`,displayLabel:t.name,detail:(e==null?void 0:e.detail)||t.description,boost:(e==null?void 0:e.boost)||1,type:(e==null?void 0:e.type)||this.contextType,apply:`${this.mentionPrefix}${t.uri}`,section:(e==null?void 0:e.section)||this.title}}};let lt=(te=Ae(),T=class{constructor(){$(this,"providers",new Set)}register(t){return this.providers.add(t),this}getProviders(){return this.providers}getProvider(t){return[...this.providers].find(e=>e.contextType===t)}getAllItems(){return[...this.providers].flatMap(t=>t.getItems())}parseAllContextIds(t){return[...this.providers].flatMap(e=>e.parseContextIds(t))}getContextInfo(t){let e=[],n=new Map(this.getAllItems().map(s=>[s.uri,s]));for(let s of t){let i=n.get(s);i&&e.push(i)}return e}formatContextForAI(t){let e=new Map(this.getAllItems().map(s=>[s.uri,s])),n=[];for(let s of t){let i=e.get(s);i&&n.push(i)}return n.length===0?"":n.map(s=>{var i;return((i=this.getProvider(s.type))==null?void 0:i.formatContext(s))||""}).join(`

`)}async getAttachmentsForContext(t){let e=new Map(this.getAllItems().map(l=>[l.uri,l])),n=[];for(let l of t){let a=e.get(l);a&&n.push(a)}if(n.length===0)return[];let s=new tt;for(let l of n){let a=l.type;s.add(a,l)}let i=[...s.entries()].map(async([l,a])=>{let o=this.getProvider(l);if(!o)return[];try{return await o.getAttachments(a)}catch(d){return qe.error("Error getting attachments from provider",d),[]}});return(await Promise.all(i)).flat()}},nt(T.prototype,"getAllItems",[te],Object.getOwnPropertyDescriptor(T.prototype,"getAllItems"),T.prototype),T);function se(t){return t.replaceAll("<","&lt;").replaceAll(">","&gt;")}function ne(t){let{type:e,data:n,details:s}=t,i=`<${e}`;for(let[l,a]of Object.entries(n))if(a!==void 0){let o=se(typeof a=="object"&&a?JSON.stringify(a):String(a));i+=` ${l}="${o}"`}return i+=">",s&&(i+=se(s)),i+=`</${e}>`,i}const le={LOCAL_TABLE:7,REMOTE_TABLE:5,HIGH:4,MEDIUM:3,CELL_OUTPUT:2,LOW:2},ie={ERROR:{name:"Error",rank:1},TABLE:{name:"Table",rank:2},DATA_SOURCES:{name:"Data Sources",rank:3},VARIABLE:{name:"Variable",rank:4},CELL_OUTPUT:{name:"Cell Output",rank:5},FILE:{name:"File",rank:6}};var it=k(_e(),1),ae="datasource",at=class extends re{constructor(e,n){super();$(this,"title","Datasource");$(this,"mentionPrefix","@");$(this,"contextType",ae);this.connectionsMap=e,this.dataframes=[...n.values()].filter(s=>Me(s)==="dataframe")}getItems(){return[...this.connectionsMap.values()].map(e=>{var i;let n="Database schema.",s={connection:e};return W.has(e.name)&&(s.tables=this.dataframes,n="Database schema and the dataframes that can be queried"),e.databases.length===0&&(((i=s.tables)==null?void 0:i.length)??0)===0?null:{uri:this.asURI(e.name),name:e.name,description:n,type:this.contextType,data:s}}).filter(Boolean)}formatContext(e){let n=e.data,{name:s,display_name:i,source:l,...a}=n.connection,o=a;return W.has(s)||(o={...a,engine_name:s}),ne({type:this.contextType,data:{connection:o,tables:n.tables}})}formatCompletion(e){let n=e.data,s=n.connection,i=n.tables,l=s.name;return W.has(s.name)&&(l="In-Memory"),{label:`@${l}`,displayLabel:l,detail:Pe(s.dialect),boost:le.MEDIUM,type:this.contextType,section:ie.DATA_SOURCES,info:()=>{let a=document.createElement("div");return a.classList.add("mo-cm-tooltip","docs-documentation"),(0,it.createRoot)(a).render(Oe(s,i)),a}}}};function ot(t){var a;let e=(a=K.get(Fe(t)))==null?void 0:a.code;if(!e||e.trim()==="")return null;let[n,s,i]=Ce.sql.transformIn(e),l=K.get(Te).connectionsMap.get(i.engine);return l?`@${ae}://${l.name}`:null}function ct(t){let e=null,n=t.cursor();do n.name==="ExpressionStatement"&&(e=n.node);while(n.next());return e}function dt(t){let e=t.split(`
`),n="    ",s=ct(Be.parse(t));if(!s)return["def _():",...G(e,n),`${n}return`,"","","_()"].join(`
`);let i=t.slice(0,s.from).trim(),l=t.slice(s.from).trim(),a=i.split(`
`),o=l.split(`
`);return["def _():",...G(a,n),`${n}return ${o[0]}`,...G(o.slice(1),n),"","","_()"].join(`
`)}function G(t,e){if(t.length===1&&t[0]==="")return[];let n=[];for(let s of t)s===""?n.push(""):n.push(e+s);return n}function mt(t,e){var n;if(t.type==="multiple-defs")return[{title:"Fix: Wrap in a function",description:"Make this cell's variables local by wrapping the cell in a function.",fixType:"manual",onFix:async s=>{Ue(s.editor,"Editor is null");let i=dt(s.editor.state.doc.toString());s.editor.dispatch({changes:{from:0,to:s.editor.state.doc.length,insert:i}})}}];if(t.type==="exception"&&t.exception_type==="NameError"){let s=(n=t.msg.match(/name '(.+)' is not defined/))==null?void 0:n[1];if(!s||!(s in oe))return[];let i=pt(s);return[{title:`Fix: Add '${i}'`,description:"Add a new cell for the missing import",fixType:"manual",onFix:async l=>{l.addCodeBelow(i)}}]}return t.type==="sql-error"&&e.aiEnabled?[{title:"Fix with AI",description:"Fix the SQL statement",fixType:"ai",onFix:async s=>{var a;let i=ot(s.cellId),l=`Fix the SQL statement: ${t.msg}.`;i&&(l+=`
Database schema: ${i}`),(a=s.aiFix)==null||a.setAiCompletionCell({cellId:s.cellId,initialPrompt:l,triggerImmediately:s.aiFix.triggerFix})}}]:[]}function pt(t){let e=oe[t];return e===t?`import ${e}`:`import ${e} as ${t}`}var oe={mo:"marimo",alt:"altair",bokeh:"bokeh",dask:"dask",np:"numpy",pd:"pandas",pl:"polars",plotly:"plotly",plt:"matplotlib.pyplot",px:"plotly.express",scipy:"scipy",sk:"sklearn",sns:"seaborn",stats:"scipy.stats",tf:"tensorflow",torch:"torch",xr:"xarray",dt:"datetime",json:"json",math:"math",os:"os",re:"re",sys:"sys"},ut=k(H(),1),ht=Ee("marimo:ai-autofix-mode","autofix",Le);function xt(){let t=(0,ut.c)(3),[e,n]=we(ht),s;return t[0]!==e||t[1]!==n?(s={fixMode:e,setFixMode:n},t[0]=e,t[1]=n,t[2]=s):s=t[2],s}var J=k(H(),1),r=k(Re(),1);const v=t=>{let e=(0,J.c)(21),{errors:n,cellId:s,className:i}=t,l=Ie(),{createNewCell:a}=Se(),o=ve(De),d;if(e[0]!==o||e[1]!==n){let x;e[3]===o?x=e[4]:(x=j=>mt(j,{aiEnabled:o}),e[3]=o,e[4]=x),d=n.flatMap(x),e[0]=o,e[1]=n,e[2]=d}else d=e[2];let u=d,m=Ne(Ke);if(u.length===0)return null;let c=u[0],y;e[5]!==s||e[6]!==a||e[7]!==c||e[8]!==m||e[9]!==l?(y=x=>{var w;let j=(w=l.get(ze).cellHandles[s].current)==null?void 0:w.editorView;c.onFix({addCodeBelow:A=>{a({cellId:s,autoFocus:!1,before:!1,code:A})},editor:j,cellId:s,aiFix:{setAiCompletionCell:m,triggerFix:x}}),j==null||j.focus()},e[5]=s,e[6]=a,e[7]=c,e[8]=m,e[9]=l,e[10]=y):y=e[10];let p=y,f;e[11]===i?f=e[12]:(f=X("my-2",i),e[11]=i,e[12]=f);let h;e[13]!==c.description||e[14]!==c.fixType||e[15]!==c.title||e[16]!==p?(h=c.fixType==="ai"?(0,r.jsx)(ue,{tooltip:c.description,openPrompt:()=>p(!1),applyAutofix:()=>p(!0)}):(0,r.jsx)(Y,{content:c.description,align:"start",children:(0,r.jsxs)(F,{size:"xs",variant:"outline",className:"font-normal",onClick:()=>p(!1),children:[(0,r.jsx)(V,{className:"h-3 w-3 mr-2"}),c.title]})}),e[13]=c.description,e[14]=c.fixType,e[15]=c.title,e[16]=p,e[17]=h):h=e[17];let g;return e[18]!==f||e[19]!==h?(g=(0,r.jsx)("div",{className:f,children:h}),e[18]=f,e[19]=h,e[20]=g):g=e[20],g};var ce=Je,de=V,me="Suggest a prompt",pe="Fix with AI";const ue=t=>{let e=(0,J.c)(21),{tooltip:n,openPrompt:s,applyAutofix:i}=t,{fixMode:l,setFixMode:a}=xt(),o=l==="prompt"?s:i,d;e[0]===l?d=e[1]:(d=l==="prompt"?(0,r.jsx)(ce,{className:"h-3 w-3 mr-2 mb-0.5"}):(0,r.jsx)(de,{className:"h-3 w-3 mr-2 mb-0.5"}),e[0]=l,e[1]=d);let u=l==="prompt"?me:pe,m;e[2]!==o||e[3]!==d||e[4]!==u?(m=(0,r.jsxs)(F,{size:"xs",variant:"outline",className:"font-normal rounded-r-none border-r-0",onClick:o,children:[d,u]}),e[2]=o,e[3]=d,e[4]=u,e[5]=m):m=e[5];let c;e[6]!==m||e[7]!==n?(c=(0,r.jsx)(Y,{content:n,align:"start",children:m}),e[6]=m,e[7]=n,e[8]=c):c=e[8];let y;e[9]===Symbol.for("react.memo_cache_sentinel")?(y=(0,r.jsx)(Qe,{asChild:!0,children:(0,r.jsx)(F,{size:"xs",variant:"outline",className:"rounded-l-none px-2","aria-label":"Fix options",children:(0,r.jsx)(We,{className:"h-3 w-3"})})}),e[9]=y):y=e[9];let p;e[10]!==l||e[11]!==a?(p=()=>{a(l==="prompt"?"autofix":"prompt")},e[10]=l,e[11]=a,e[12]=p):p=e[12];let f=l==="prompt"?"autofix":"prompt",h;e[13]===f?h=e[14]:(h=(0,r.jsx)(ft,{mode:f}),e[13]=f,e[14]=h);let g;e[15]!==p||e[16]!==h?(g=(0,r.jsxs)(Ge,{children:[y,(0,r.jsx)(Ve,{align:"end",className:"w-56",children:(0,r.jsx)(He,{className:"flex items-center gap-2",onClick:p,children:h})})]}),e[15]=p,e[16]=h,e[17]=g):g=e[17];let x;return e[18]!==g||e[19]!==c?(x=(0,r.jsxs)("div",{className:"flex",children:[c,g]}),e[18]=g,e[19]=c,e[20]=x):x=e[20],x};var ft=t=>{let e=(0,J.c)(12),{mode:n}=t,s;e[0]===n?s=e[1]:(s=n==="prompt"?(0,r.jsx)(ce,{className:"h-4 w-4"}):(0,r.jsx)(de,{className:"h-4 w-4"}),e[0]=n,e[1]=s);let i=s,l=n==="prompt"?me:pe,a=n==="prompt"?"Edit the prompt before applying":"Apply AI fixes automatically",o;e[2]===l?o=e[3]:(o=(0,r.jsx)("span",{className:"font-medium",children:l}),e[2]=l,e[3]=o);let d;e[4]===a?d=e[5]:(d=(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:a}),e[4]=a,e[5]=d);let u;e[6]!==o||e[7]!==d?(u=(0,r.jsxs)("div",{className:"flex flex-col",children:[o,d]}),e[6]=o,e[7]=d,e[8]=u):u=e[8];let m;return e[9]!==i||e[10]!==u?(m=(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[i,u]}),e[9]=i,e[10]=u,e[11]=m):m=e[11],m},he=k(H(),1),yt=k(ke(),1),I=t=>{let e=(0,he.c)(10),n=t.title??"Tip",s;e[0]===n?s=e[1]:(s=(0,r.jsx)(Xe,{className:"pt-2 pb-2 font-normal",children:n}),e[0]=n,e[1]=s);let i;e[2]===t.children?i=e[3]:(i=(0,r.jsx)(et,{className:"mr-24 text-[0.84375rem]",children:t.children}),e[2]=t.children,e[3]=i);let l;e[4]!==s||e[5]!==i?(l=(0,r.jsxs)(Ye,{value:"item-1",className:"text-muted-foreground",children:[s,i]}),e[4]=s,e[5]=i,e[6]=l):l=e[6];let a;return e[7]!==t.className||e[8]!==l?(a=(0,r.jsx)(Ze,{type:"single",collapsible:!0,className:t.className,children:l}),e[7]=t.className,e[8]=l,e[9]=a):a=e[9],a};const gt=t=>{let e=(0,he.c)(31),{errors:n,cellId:s,className:i}=t,l=$e(),a="This cell wasn't run because it has errors",o="destructive",d="text-error";if(n.some(jt))a="Interrupted";else if(n.some(bt))a="An internal error occurred";else if(n.some(vt))a="Ancestor prevented from running",o="default",d="text-secondary-foreground";else if(n.some(Nt))a="Ancestor stopped",o="default",d="text-secondary-foreground";else if(n.some(wt))a="SQL error";else{let x;e[0]===n?x=e[1]:(x=n.find(It),e[0]=n,e[1]=x);let j=x;j&&"exception_type"in j&&(a=j.exception_type)}let u,m,c,y,p,f;if(e[2]!==o||e[3]!==s||e[4]!==l||e[5]!==i||e[6]!==n||e[7]!==d||e[8]!==a){let x=n.filter(kt),j=n.filter(At),w=n.filter($t),A=n.filter(Tt),P=n.filter(_t),_=n.filter(Mt),M=n.filter(Ct),z=n.filter(Et),O=n.filter(Ft),q=n.filter(Lt),U=n.filter(St),D=n.filter(Pt),R=n.filter(zt),C;e[15]===l?C=e[16]:(C=()=>{l.openApplication("scratchpad")},e[15]=l,e[16]=C);let xe=C,fe=()=>{let b=[];if((U.length>0||D.length>0)&&b.push((0,r.jsxs)("div",{children:[U.map(Ot),D.map(qt),s&&(0,r.jsx)(v,{errors:[...U,...D],cellId:s})]},"syntax-unknown")),x.length>0&&b.push((0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-muted-foreground font-medium",children:"The setup cell cannot be run because it has references."}),(0,r.jsx)("ul",{className:"list-disc",children:x.flatMap(Ut)}),s&&(0,r.jsx)(v,{errors:x,cellId:s}),(0,r.jsxs)(I,{title:"Why can't the setup cell have references?",className:"mb-2",children:[(0,r.jsx)("p",{className:"pb-2",children:"The setup cell contains logic that must be run before any other cell runs, including top-level imports used by top-level functions. For this reason, it can't refer to other cells' variables."}),(0,r.jsx)("p",{className:"py-2",children:"Try simplifying the setup cell to only contain only necessary variables."}),(0,r.jsxs)("p",{className:"py-2",children:[(0,r.jsxs)(L,{href:"https://links.marimo.app/errors-setup",children:["Learn more at our docs"," ",(0,r.jsx)(S,{size:"0.75rem",className:"inline"})]}),"."]})]})]},"setup-refs")),j.length>0&&b.push((0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-muted-foreground font-medium",children:"This cell is in a cycle."}),(0,r.jsx)("ul",{className:"list-disc",children:j.flatMap(Dt)}),s&&(0,r.jsx)(v,{errors:j,cellId:s}),(0,r.jsxs)(I,{title:"What are cycles and how do I resolve them?",className:"mb-2",children:[(0,r.jsx)("p",{className:"pb-2",children:"An example of a cycle is if one cell declares a variable 'a' and reads 'b', and another cell declares 'b' and and reads 'a'. Cycles like this make it impossible for marimo to know how to run your cells, and generally suggest that your code has a bug."}),(0,r.jsx)("p",{className:"py-2",children:"Try merging these cells into a single cell to eliminate the cycle."}),(0,r.jsxs)("p",{className:"py-2",children:[(0,r.jsxs)(L,{href:"https://links.marimo.app/errors-cycles",children:["Learn more at our docs"," ",(0,r.jsx)(S,{size:"0.75rem",className:"inline"})]}),"."]})]})]},"cycle")),w.length>0){let ge=w[0].name;b.push((0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-muted-foreground font-medium",children:"This cell redefines variables from other cells."}),w.map(Bt),s&&(0,r.jsx)(v,{errors:w,cellId:s}),(0,r.jsxs)(I,{title:"Why can't I redefine variables?",children:[(0,r.jsx)("p",{className:"pb-2",children:"marimo requires that each variable is defined in just one cell. This constraint enables reactive and reproducible execution, arbitrary cell reordering, seamless UI elements, execution as a script, and more."}),(0,r.jsxs)("p",{className:"py-2",children:["Try merging this cell with the mentioned cells or wrapping it in a function. Alternatively, rename variables to make them private to this cell by prefixing them with an underscore (e.g."," ",(0,r.jsxs)(Z,{className:"inline",children:["_",ge]}),")."]}),(0,r.jsxs)("p",{className:"py-2",children:[(0,r.jsxs)(L,{href:"https://links.marimo.app/errors-multiple-definitions",children:["Learn more at our docs"," ",(0,r.jsx)(S,{size:"0.75rem",className:"inline"})]}),"."]})]}),(0,r.jsx)(I,{title:"Need a scratchpad?",children:(0,r.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,r.jsxs)(F,{size:"xs",variant:"link",className:"my-2 font-normal mx-0 px-0",onClick:xe,children:[(0,r.jsx)(ee,{className:"h-3"}),(0,r.jsx)("span",{children:"Try the scratchpad"})]}),(0,r.jsx)("span",{children:"to experiment without restrictions on variable names."})]})})]},"multiple-defs"))}return A.length>0&&b.push((0,r.jsxs)("div",{children:[A.map(Wt),s&&(0,r.jsx)(v,{errors:A,cellId:s}),(0,r.jsxs)(I,{title:"Why can't I use `import *`?",children:[(0,r.jsx)("p",{className:"pb-2",children:"Star imports are incompatible with marimo's git-friendly file format and reproducible reactive execution."}),(0,r.jsx)("p",{className:"py-2",children:"marimo's Python file format stores code in functions, so notebooks can be imported as regular Python modules without executing all their code. But Python disallows `import *` everywhere except at the top-level of a module."}),(0,r.jsx)("p",{className:"py-2",children:"Star imports would also silently add names to globals, which would be incompatible with reactive execution."}),(0,r.jsxs)("p",{className:"py-2",children:[(0,r.jsxs)(L,{href:"https://links.marimo.app/errors-import-star",children:["Learn more at our docs"," ",(0,r.jsx)(S,{size:"0.75rem",className:"inline"})]}),"."]})]})]},"import-star")),P.length>0&&b.push((0,r.jsxs)("div",{children:[P.map(Ht),s&&(0,r.jsx)(v,{errors:P,cellId:s})]},"interruption")),_.length>0&&b.push((0,r.jsxs)("ul",{children:[_.map(Qt),_.some(Vt)&&(0,r.jsx)(I,{children:"Fix the error in the mentioned cells, or handle the exceptions with try/except blocks."}),s&&(0,r.jsx)(v,{errors:_,cellId:s})]},"exception")),M.length>0&&b.push((0,r.jsxs)("ul",{children:[M.map(Gt),s&&(0,r.jsx)(v,{errors:M,cellId:s}),(0,r.jsx)(I,{children:M.some(Jt)?"Ensure that the referenced cells define the required variables, or turn off strict execution.":"Something is wrong with your declarations. Fix any discrepancies, or turn off strict execution."})]},"strict-exception")),z.length>0&&b.push((0,r.jsxs)("div",{children:[z.map(Kt),s&&(0,r.jsx)(v,{errors:z,cellId:s})]},"internal")),O.length>0&&b.push((0,r.jsxs)("div",{children:[O.map(Xt),s&&(0,r.jsx)(v,{errors:O,cellId:s})]},"ancestor-prevented")),q.length>0&&b.push((0,r.jsxs)("div",{children:[q.map(Yt),s&&(0,r.jsx)(v,{errors:q,cellId:s})]},"ancestor-stopped")),R.length>0&&b.push((0,r.jsxs)("div",{children:[R.map(Zt),s&&(0,r.jsx)(v,{errors:R,cellId:s,className:"mt-2.5"})]},"sql-errors")),b},B=`font-code font-medium tracking-wide ${d}`,E;e[17]!==B||e[18]!==a?(E=(0,r.jsx)(rt,{className:B,children:a}),e[17]=B,e[18]=a,e[19]=E):E=e[19];let ye=E;u=st,y=o,e[20]===i?p=e[21]:(p=X("border-none font-code text-sm text-[0.84375rem] px-0 text-muted-foreground normal [&:has(svg)]:pl-0 space-y-4",i),e[20]=i,e[21]=p),f=ye,m="flex flex-col gap-8",c=fe(),e[2]=o,e[3]=s,e[4]=l,e[5]=i,e[6]=n,e[7]=d,e[8]=a,e[9]=u,e[10]=m,e[11]=c,e[12]=y,e[13]=p,e[14]=f}else u=e[9],m=e[10],c=e[11],y=e[12],p=e[13],f=e[14];let h;e[22]!==m||e[23]!==c?(h=(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:m,children:c})}),e[22]=m,e[23]=c,e[24]=h):h=e[24];let g;return e[25]!==u||e[26]!==y||e[27]!==p||e[28]!==f||e[29]!==h?(g=(0,r.jsxs)(u,{variant:y,className:p,children:[f,h]}),e[25]=u,e[26]=y,e[27]=p,e[28]=f,e[29]=h,e[30]=g):g=e[30],g};function jt(t){return t.type==="interruption"}function bt(t){return t.type==="internal"}function vt(t){return t.type==="ancestor-prevented"}function Nt(t){return t.type==="ancestor-stopped"}function wt(t){return t.type==="sql-error"}function It(t){return t.type==="exception"}function kt(t){return t.type==="setup-refs"}function At(t){return t.type==="cycle"}function $t(t){return t.type==="multiple-defs"}function Tt(t){return t.type==="import-star"}function _t(t){return t.type==="interruption"}function Mt(t){return t.type==="exception"}function Ct(t){return t.type==="strict-exception"}function Et(t){return t.type==="internal"}function Ft(t){return t.type==="ancestor-prevented"}function Lt(t){return t.type==="ancestor-stopped"}function St(t){return t.type==="syntax"}function Pt(t){return t.type==="unknown"}function zt(t){return t.type==="sql-error"}function Ot(t,e){return(0,r.jsx)("p",{children:t.msg},`syntax-${e}`)}function qt(t,e){return(0,r.jsx)("p",{children:t.msg},`unknown-${e}`)}function Ut(t,e){return t.edges_with_vars.map((n,s)=>(0,r.jsxs)("li",{className:"my-0.5 ml-8 text-muted-foreground/40",children:[(0,r.jsx)(N,{cellId:n[0]}),(0,r.jsxs)("span",{className:"text-muted-foreground",children:[": "," ",n[1].length===1?n[1][0]:n[1].join(", ")]})]},`setup-refs-${e}-${s}`))}function Dt(t,e){return t.edges_with_vars.map((n,s)=>(0,r.jsxs)("li",{className:"my-0.5 ml-8 text-muted-foreground/40",children:[(0,r.jsx)(N,{cellId:n[0]}),(0,r.jsxs)("span",{className:"text-muted-foreground",children:[" -> ",n[1].length===1?n[1][0]:n[1].join(", ")," -> "]}),(0,r.jsx)(N,{cellId:n[2]})]},`cycle-${e}-${s}`))}function Rt(t,e){return(0,r.jsx)("li",{className:"my-0.5 ml-8 text-muted-foreground/40",children:(0,r.jsx)(N,{cellId:t})},`cell-${e}`)}function Bt(t,e){return(0,r.jsxs)(yt.Fragment,{children:[(0,r.jsx)("p",{className:"text-muted-foreground mt-2",children:`'${t.name}' was also defined by:`}),(0,r.jsx)("ul",{className:"list-disc",children:t.cells.map(Rt)})]},`multiple-defs-${e}`)}function Wt(t,e){return(0,r.jsx)("p",{className:"text-muted-foreground",children:t.msg},`import-star-${e}`)}function Ht(t,e){return(0,r.jsx)("p",{children:"This cell was interrupted and needs to be re-run."},`interruption-${e}`)}function Qt(t,e){return t.exception_type==="NameError"&&t.msg.startsWith("name 'mo'")?(0,r.jsx)("li",{className:"my-2",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-muted-foreground",children:"name 'mo' is not defined."}),(0,r.jsxs)("p",{className:"text-muted-foreground mt-2",children:["The marimo module (imported as"," ",(0,r.jsx)(Z,{className:"inline",children:"mo"}),") is required for Markdown, SQL, and UI elements."]})]})},`exception-${e}`):(0,r.jsx)("li",{className:"my-2",children:t.raising_cell==null?(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-muted-foreground",children:t.msg}),(0,r.jsx)("div",{className:"text-muted-foreground mt-2",children:"See the console area for a traceback."})]}):(0,r.jsxs)("div",{children:[t.msg,(0,r.jsx)(N,{cellId:t.raising_cell})]})},`exception-${e}`)}function Vt(t){return t.raising_cell!=null}function Gt(t,e){return(0,r.jsx)("li",{className:"my-2",children:t.blamed_cell==null?(0,r.jsx)("p",{children:t.msg}):(0,r.jsxs)("div",{children:[t.msg,(0,r.jsx)(N,{cellId:t.blamed_cell})]})},`strict-exception-${e}`)}function Jt(t){return t.blamed_cell!=null}function Kt(t,e){return(0,r.jsx)("p",{children:t.msg},`internal-${e}`)}function Xt(t,e){return(0,r.jsxs)("div",{children:[t.msg,t.blamed_cell==null?(0,r.jsxs)("span",{children:["(",(0,r.jsx)(N,{cellId:t.raising_cell}),")"]}):(0,r.jsxs)("span",{children:["(",(0,r.jsx)(N,{cellId:t.raising_cell}),"\xA0blames\xA0",(0,r.jsx)(N,{cellId:t.blamed_cell}),")"]})]},`ancestor-prevented-${e}`)}function Yt(t,e){return(0,r.jsxs)("div",{children:[t.msg,(0,r.jsx)(N,{cellId:t.raising_cell})]},`ancestor-stopped-${e}`)}function Zt(t,e){return(0,r.jsx)("div",{className:"space-y-2 mt-2",children:(0,r.jsx)("p",{className:"text-muted-foreground whitespace-pre-wrap",children:t.msg})},`sql-error-${e}`)}export{ie as a,lt as c,le as i,V as l,ue as n,ne as o,at as r,re as s,gt as t,ee as u};
