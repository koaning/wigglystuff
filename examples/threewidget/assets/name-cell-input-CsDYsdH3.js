import{s as b}from"./chunk-LvLJmgfZ.js";import{t as L}from"./react-BGmjiNul.js";import{C as T,f as j,gt as C,ht as y,mt as F}from"./cells-D_SkyFDn.js";import{t as E}from"./compiler-runtime-DeeZ7FnK.js";import{t as H}from"./useLifecycle-CmDXEyIC.js";import{t as K}from"./jsx-runtime-DN_bIXfG.js";import{r as x}from"./button-DuYGqRtX.js";import{t as w}from"./cn-C1rgT0yh.js";import{r as _}from"./input-CaEtLL8p.js";import{r as k}from"./dist-RKnr9SNh.js";import{r as D}from"./useTheme-DfP1CWaW.js";import{t as I}from"./tooltip-CvjcEpZC.js";import{r as M,t as P}from"./esm-B3JckBtM.js";var R=E(),g=b(L(),1),d=b(K(),1),W=[k(),M({syntaxHighlighting:!0,highlightSpecialChars:!1,history:!1,drawSelection:!1,defaultKeymap:!1,historyKeymap:!1})];const B=(0,g.memo)(i=>{let e=(0,R.c)(8),{code:a,className:r}=i,{theme:s}=D(),o;e[0]===r?o=e[1]:(o=w(r,"text-muted-foreground flex flex-col overflow-hidden"),e[0]=r,e[1]=o);let l=s==="dark"?"dark":"light",t;e[2]!==a||e[3]!==l?(t=(0,d.jsx)(P,{minHeight:"10px",theme:l,height:"100%",className:"tiny-code",editable:!1,basicSetup:!1,extensions:W,value:a}),e[2]=a,e[3]=l,e[4]=t):t=e[4];let n;return e[5]!==o||e[6]!==t?(n=(0,d.jsx)("div",{className:o,children:t}),e[5]=o,e[6]=t,e[7]=n):n=e[7],n});B.displayName="TinyCode";var N=E();const q=i=>{let e=(0,N.c)(16),a,r,s,o,l;e[0]===i?(a=e[1],r=e[2],s=e[3],o=e[4],l=e[5]):({value:l,onChange:a,placeholder:s,onEnterKey:r,...o}=i,e[0]=i,e[1]=a,e[2]=r,e[3]=s,e[4]=o,e[5]=l);let t=(0,g.useRef)(null),n=S(l,a),m;e[6]===n.onBlur?m=e[7]:(m=()=>{let c=n.onBlur,f=t.current;if(f)return f.addEventListener("blur",c),()=>{f.removeEventListener("blur",c)}},e[6]=n.onBlur,e[7]=m),H(m);let p=n.value,v=n.onChange,h;e[8]===r?h=e[9]:(h=x.onEnter(c=>{x.stopPropagation()(c),r==null||r()}),e[8]=r,e[9]=h);let u;return e[10]!==n.onChange||e[11]!==n.value||e[12]!==s||e[13]!==o||e[14]!==h?(u=(0,d.jsx)(_,{"data-testid":"cell-name-input",value:p,onChange:v,ref:t,placeholder:s,className:"shadow-none! hover:shadow-none focus:shadow-none focus-visible:shadow-none",onKeyDown:h,...o}),e[10]=n.onChange,e[11]=n.value,e[12]=s,e[13]=o,e[14]=h,e[15]=u):u=e[15],u},z=i=>{let e=(0,N.c)(13),{value:a,cellId:r,className:s}=i,{updateCellName:o}=T(),l;e[0]!==r||e[1]!==o?(l=f=>o({cellId:r,name:f}),e[0]=r,e[1]=o,e[2]=l):l=e[2];let t=S(a,l);if(y(a))return null;let n=t.focusing?"":"text-ellipsis",m;e[3]!==s||e[4]!==n?(m=w("outline-hidden border hover:border-cyan-500/40 focus:border-cyan-500/40",n,s),e[3]=s,e[4]=n,e[5]=m):m=e[5];let p=t.onChange,v=t.onBlur,h=t.onFocus,u;e[6]===Symbol.for("react.memo_cache_sentinel")?(u=x.onEnter(A),e[6]=u):u=e[6];let c;return e[7]!==t.onBlur||e[8]!==t.onChange||e[9]!==t.onFocus||e[10]!==m||e[11]!==a?(c=(0,d.jsx)(I,{content:"Click to rename",children:(0,d.jsx)("span",{className:m,contentEditable:!0,suppressContentEditableWarning:!0,onChange:p,onBlur:v,onFocus:h,onKeyDown:u,children:a})}),e[7]=t.onBlur,e[8]=t.onChange,e[9]=t.onFocus,e[10]=m,e[11]=a,e[12]=c):c=e[12],c};function S(i,e){let[a,r]=(0,g.useState)(i),[s,o]=(0,g.useState)(!1),l=t=>{if(t!==i){if(!t||y(t)){e(t);return}e(F(t,j()))}};return{value:y(a)?"":a,focusing:s,onChange:t=>{let n=t.target.value;r(C(n))},onBlur:t=>{if(t.target instanceof HTMLInputElement){let n=t.target.value;l(C(n))}else t.target instanceof HTMLSpanElement&&(l(C(t.target.innerText.trim())),t.target.scrollLeft=0,o(!1))},onFocus:()=>{o(!0)}}}function A(i){i.target instanceof HTMLElement&&i.target.blur()}export{q as n,B as r,z as t};
