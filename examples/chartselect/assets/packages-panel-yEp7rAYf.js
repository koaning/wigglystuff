import{s as H}from"./chunk-LvLJmgfZ.js";import{d as ae,u as oe}from"./useEvent-BhXAndur.js";import{t as le}from"./react-Bj1aDYRI.js";import{Xn as V}from"./cells-DPp5cDaO.js";import"./react-dom-CSu739Rf.js";import{t as ie}from"./compiler-runtime-B3qBwwSJ.js";import{r as ce}from"./ai-model-dropdown-Dk2SdB3C.js";import{y as de}from"./utils-YqBXNpsM.js";import{S as me}from"./config-Q0O7_stz.js";import{t as pe}from"./jsx-runtime-ZmTK25f3.js";import{r as xe}from"./button-CZ3Cs4qb.js";import{t as K}from"./cn-BKtXLv3a.js";import"./dist-DBwNzi3C.js";import"./cjs-CH5Rj0g8.js";import"./main-U5Goe76G.js";import"./useNonce-CS26E0hA.js";import{r as W}from"./requests-B4FYHTZl.js";import{r as ue}from"./x-ZP5cObgf.js";import{t as fe}from"./chevron-right--18M_6o9.js";import{u as ge}from"./toDate-DETS9bBd.js";import{t as R}from"./spinner-DA8-7wQv.js";import{a as he}from"./input-DUrq2DiR.js";import"./dist-bBwmhqty.js";import"./dist-Btv5Rh1v.js";import"./dist-Dcqqg9UU.js";import"./dist-sMh6mJ2d.js";import"./dist-CoCQUAeM.js";import{t as ve}from"./use-toast-BDYuj3zG.js";import"./session-BOFn9QrD.js";import"./Combination-BAEdC-rz.js";import{t as J}from"./tooltip-CMQz28hC.js";import"./popover-CH1FzjxU.js";import{t as je}from"./copy-DHrHayPa.js";import{i as be,n as X,r as F,s as Q,t as ke}from"./useInstallPackage-D4fX0Ee_.js";import{n as Y}from"./error-banner-B9ts0mNl.js";import{n as ye}from"./useAsyncData-BMGLSTg8.js";import{a as Ne,i as q,n as we,o as Z,r as B,t as Se}from"./table-DScsXgJW.js";import{t as ee}from"./empty-state-B8Cxr9nj.js";var G=ie(),I=H(le(),1);function _e(t){let e=t.trim();for(let s of["pip install","pip3 install","uv add","uv pip install","poetry add","conda install","pipenv install"])if(e.toLowerCase().startsWith(s.toLowerCase()))return e.slice(s.length).trim();return e}var r=H(pe(),1),te=t=>{let e=(0,G.c)(9),{onClick:s,loading:n,children:i,className:p}=t;if(n){let l;return e[0]===Symbol.for("react.memo_cache_sentinel")?(l=(0,r.jsx)(R,{size:"small",className:"h-4 w-4 shrink-0 opacity-50"}),e[0]=l):l=e[0],l}let c;e[1]===p?c=e[2]:(c=K("px-2 h-full text-xs text-muted-foreground hover:text-foreground","invisible group-hover:visible",p),e[1]=p,e[2]=c);let a;e[3]===s?a=e[4]:(a=xe.stopPropagation(s),e[3]=s,e[4]=a);let o;return e[5]!==i||e[6]!==c||e[7]!==a?(o=(0,r.jsx)("button",{type:"button",className:c,onClick:a,children:i}),e[5]=i,e[6]=c,e[7]=a,e[8]=o):o=e[8],o},Ce=()=>{var w,S;let t=(0,G.c)(30),[e]=de(),s=e.package_management.manager,{getDependencyTree:n,getPackageList:i}=W(),[p,c]=I.useState(null),a;t[0]!==n||t[1]!==i?(a=async()=>{let[u,C]=await Promise.all([i(),n()]);return{list:u.packages,tree:C.tree}},t[0]=n,t[1]=i,t[2]=a):a=t[2];let o;t[3]===s?o=t[4]:(o=[s],t[3]=s,t[4]=o);let{data:l,error:m,refetch:j,isPending:g}=ye(a,o);if(g){let u;return t[5]===Symbol.for("react.memo_cache_sentinel")?(u=(0,r.jsx)(R,{size:"medium",centered:!0}),t[5]=u):u=t[5],u}if(m){let u;return t[6]===m?u=t[7]:(u=(0,r.jsx)(Y,{error:m}),t[6]=m,t[7]=u),u}let h=l.tree!=null,d;t[8]!==h||t[9]!==p?(d=De(p,h),t[8]=h,t[9]=p,t[10]=d):d=t[10];let f=d,x=(w=l.tree)==null?void 0:w.name,P=(S=l==null?void 0:l.tree)==null?void 0:S.version,y=x==="<root>",k;t[11]!==s||t[12]!==j?(k=(0,r.jsx)(Pe,{packageManager:s,onSuccess:j}),t[11]=s,t[12]=j,t[13]=k):k=t[13];let b;t[14]!==y||t[15]!==h||t[16]!==x||t[17]!==P||t[18]!==f?(b=h&&(0,r.jsxs)("div",{className:"flex items-center justify-between px-2 py-1 border-b",children:[(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsx)("button",{type:"button",className:K("px-2 py-1 text-xs rounded",f==="list"?"bg-accent text-accent-foreground":"text-muted-foreground hover:text-foreground"),onClick:()=>c("list"),children:"List"}),(0,r.jsx)("button",{type:"button",className:K("px-2 py-1 text-xs rounded",f==="tree"?"bg-accent text-accent-foreground":"text-muted-foreground hover:text-foreground"),onClick:()=>c("tree"),children:"Tree"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"items-center border px-2 py-0.5 text-xs transition-colors focus:outline-hidden focus:ring-2 focus:ring-ring focus:ring-offset-2 text-foreground rounded-sm text-ellipsis block overflow-hidden max-w-fit font-medium",title:y?"sandbox":"project",children:y?"sandbox":"project"}),x&&!y&&(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:[x,P&&` v${P}`]})]})]}),t[14]=y,t[15]=h,t[16]=x,t[17]=P,t[18]=f,t[19]=b):b=t[19];let v;t[20]!==l.list||t[21]!==l.tree||t[22]!==m||t[23]!==j||t[24]!==f?(v=f==="list"?(0,r.jsx)(Ee,{packages:l.list,onSuccess:j}):(0,r.jsx)($e,{tree:l.tree,error:m,onSuccess:j}),t[20]=l.list,t[21]=l.tree,t[22]=m,t[23]=j,t[24]=f,t[25]=v):v=t[25];let _;return t[26]!==k||t[27]!==b||t[28]!==v?(_=(0,r.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[k,b,v]}),t[26]=k,t[27]=b,t[28]=v,t[29]=_):_=t[29],_},Pe=t=>{let e=(0,G.c)(40),{onSuccess:s,packageManager:n}=t,[i,p]=I.useState(""),{handleClick:c}=ce(),a=oe(Q),o=ae(Q),l,m;e[0]!==a||e[1]!==o?(l=()=>{a&&(p(a),o(null))},m=[a,o],e[0]=a,e[1]=o,e[2]=l,e[3]=m):(l=e[2],m=e[3]),I.useEffect(l,m);let{loading:j,handleInstallPackages:g}=ke(),h;e[4]===s?h=e[5]:(h=()=>{s(),p("")},e[4]=s,e[5]=h);let d=h,f;e[6]!==g||e[7]!==i||e[8]!==d?(f=()=>{g([_e(i)],d)},e[6]=g,e[7]=i,e[8]=d,e[9]=f):f=e[9];let x=f,P=`Install packages with ${n}...`,y;e[10]!==j||e[11]!==c?(y=j?(0,r.jsx)(R,{size:"small",className:"mr-2 h-4 w-4 shrink-0 opacity-50"}):(0,r.jsx)(J,{content:"Change package manager",children:(0,r.jsx)(V,{onClick:()=>c("packageManagementAndData"),className:"mr-2 h-4 w-4 shrink-0 opacity-50 hover:opacity-80 cursor-pointer"})}),e[10]=j,e[11]=c,e[12]=y):y=e[12];let k;e[13]===x?k=e[14]:(k=U=>{U.key==="Enter"&&(U.preventDefault(),x())},e[13]=x,e[14]=k);let b;e[15]===Symbol.for("react.memo_cache_sentinel")?(b=U=>p(U.target.value),e[15]=b):b=e[15];let v;e[16]!==i||e[17]!==P||e[18]!==y||e[19]!==k?(v=(0,r.jsx)(he,{placeholder:P,id:be,icon:y,rootClassName:"flex-1 border-none",value:i,onKeyDown:k,onChange:b}),e[16]=i,e[17]=P,e[18]=y,e[19]=k,e[20]=v):v=e[20];let _;e[21]===Symbol.for("react.memo_cache_sentinel")?(_=(0,r.jsx)("span",{className:"font-bold tracking-wide",children:"Package name:"}),e[21]=_):_=e[21];let w,S;e[22]===Symbol.for("react.memo_cache_sentinel")?(w=(0,r.jsxs)("div",{children:[_," A package name; this will install the latest version.",(0,r.jsx)("div",{className:"text-muted-foreground",children:"Example: httpx"})]}),S=(0,r.jsx)("span",{className:"font-bold tracking-wide",children:"Package and version:"}),e[22]=w,e[23]=S):(w=e[22],S=e[23]);let u,C;e[24]===Symbol.for("react.memo_cache_sentinel")?(u=(0,r.jsxs)("div",{children:[S," ","A package with a specific version or version range.",(0,r.jsx)("div",{className:"text-muted-foreground",children:"Examples: httpx==0.27.0, httpx>=0.27.0"})]}),C=(0,r.jsx)("span",{className:"font-bold tracking-wide",children:"Git:"}),e[24]=u,e[25]=C):(u=e[24],C=e[25]);let E,$;e[26]===Symbol.for("react.memo_cache_sentinel")?(E=(0,r.jsxs)("div",{children:[C," A Git repository",(0,r.jsx)("div",{className:"text-muted-foreground",children:"Example: git+https://github.com/encode/httpx"})]}),$=(0,r.jsx)("span",{className:"font-bold tracking-wide",children:"URL:"}),e[26]=E,e[27]=$):(E=e[26],$=e[27]);let D,T;e[28]===Symbol.for("react.memo_cache_sentinel")?(D=(0,r.jsxs)("div",{children:[$," A remote wheel or source distribution.",(0,r.jsx)("div",{className:"text-muted-foreground",children:"Example: https://example.com/httpx-0.27.0.tar.gz"})]}),T=(0,r.jsx)("span",{className:"font-bold tracking-wide",children:"Path:"}),e[28]=D,e[29]=T):(D=e[28],T=e[29]);let A;e[30]===Symbol.for("react.memo_cache_sentinel")?(A=(0,r.jsx)(J,{delayDuration:300,side:"left",align:"start",content:(0,r.jsxs)("div",{className:"text-sm flex flex-col w-full max-w-[360px]",children:["Packages are installed using the package manager specified in your user configuration. Depending on your package manager, you can install packages with various formats:",(0,r.jsxs)("div",{className:"flex flex-col gap-2 mt-2",children:[w,u,E,D,(0,r.jsxs)("div",{children:[T," A local wheel, source distribution, or project directory.",(0,r.jsx)("div",{className:"text-muted-foreground",children:"Example: /example/foo-0.1.0-py3-none-any.whl"})]})]})]}),children:(0,r.jsx)(ge,{className:"h-4 w-4 cursor-help text-muted-foreground hover:text-foreground bg-transparent"})}),e[30]=A):A=e[30];let L=i&&"bg-accent text-accent-foreground",N;e[31]===L?N=e[32]:(N=K("float-right px-2 m-0 h-full text-sm text-secondary-foreground ml-2",L,"disabled:cursor-not-allowed disabled:opacity-50"),e[31]=L,e[32]=N);let z=!i,M;e[33]!==x||e[34]!==N||e[35]!==z?(M=(0,r.jsx)("button",{type:"button",className:N,onClick:x,disabled:z,children:"Add"}),e[33]=x,e[34]=N,e[35]=z,e[36]=M):M=e[36];let O;return e[37]!==M||e[38]!==v?(O=(0,r.jsxs)("div",{className:"flex items-center w-full border-b",children:[v,A,M]}),e[37]=M,e[38]=v,e[39]=O):O=e[39],O},Ee=t=>{let e=(0,G.c)(9),{onSuccess:s,packages:n}=t;if(n.length===0){let a;return e[0]===Symbol.for("react.memo_cache_sentinel")?(a=(0,r.jsx)(ee,{title:"No packages",description:"No packages are installed in this environment.",icon:(0,r.jsx)(V,{})}),e[0]=a):a=e[0],a}let i;e[1]===Symbol.for("react.memo_cache_sentinel")?(i=(0,r.jsx)(Ne,{children:(0,r.jsxs)(Z,{children:[(0,r.jsx)(q,{children:"Name"}),(0,r.jsx)(q,{children:"Version"}),(0,r.jsx)(q,{})]})}),e[1]=i):i=e[1];let p;if(e[2]!==s||e[3]!==n){let a;e[5]===s?a=e[6]:(a=o=>(0,r.jsxs)(Z,{className:"group",onClick:async()=>{await je(`${o.name}==${o.version}`),ve({title:"Copied to clipboard"})},children:[(0,r.jsx)(B,{children:o.name}),(0,r.jsx)(B,{children:o.version}),(0,r.jsxs)(B,{className:"flex justify-end",children:[(0,r.jsx)(re,{packageName:o.name,onSuccess:s}),(0,r.jsx)(se,{packageName:o.name,onSuccess:s})]})]},o.name),e[5]=s,e[6]=a),p=n.map(a),e[2]=s,e[3]=n,e[4]=p}else p=e[4];let c;return e[7]===p?c=e[8]:(c=(0,r.jsxs)(Se,{className:"overflow-auto flex-1",children:[i,(0,r.jsx)(we,{children:p})]}),e[7]=p,e[8]=c),c},re=({packageName:t,tags:e,onSuccess:s})=>{let[n,i]=I.useState(!1),{addPackage:p}=W();return me()?null:(0,r.jsx)(te,{onClick:async()=>{var c;try{i(!0);let a=(c=e==null?void 0:e.find(l=>l.kind==="group"))==null?void 0:c.value,o=await p({package:t,upgrade:!0,group:a});o.success?(s(),F(t)):F(t,o.error)}finally{i(!1)}},loading:n,children:"Upgrade"})},se=({packageName:t,tags:e,onSuccess:s})=>{let[n,i]=I.useState(!1),{removePackage:p}=W();return(0,r.jsx)(te,{onClick:async()=>{var c;try{i(!0);let a=(c=e==null?void 0:e.find(l=>l.kind==="group"))==null?void 0:c.value,o=await p({package:t,group:a});o.success?(s(),X(t)):X(t,o.error)}finally{i(!1)}},loading:n,children:"Remove"})},$e=t=>{let e=(0,G.c)(18),{tree:s,error:n,onSuccess:i}=t,p;e[0]===Symbol.for("react.memo_cache_sentinel")?(p=new Set,e[0]=p):p=e[0];let[c,a]=I.useState(p),o;e[1]===Symbol.for("react.memo_cache_sentinel")?(o=()=>{a(new Set)},e[1]=o):o=e[1];let l;if(e[2]===s?l=e[3]:(l=[s],e[2]=s,e[3]=l),I.useEffect(o,l),n){let d;return e[4]===n?d=e[5]:(d=(0,r.jsx)(Y,{error:n}),e[4]=n,e[5]=d),d}if(!s){let d;return e[6]===Symbol.for("react.memo_cache_sentinel")?(d=(0,r.jsx)(R,{size:"medium",centered:!0}),e[6]=d):d=e[6],d}if(s.dependencies.length===0){let d;return e[7]===Symbol.for("react.memo_cache_sentinel")?(d=(0,r.jsx)(ee,{title:"No dependencies",description:"No package dependencies found in this environment.",icon:(0,r.jsx)(V,{})}),e[7]=d):d=e[7],d}let m;e[8]===Symbol.for("react.memo_cache_sentinel")?(m=d=>{a(f=>{let x=new Set(f);return x.has(d)?x.delete(d):x.add(d),x})},e[8]=m):m=e[8];let j=m,g;if(e[9]!==c||e[10]!==i||e[11]!==s.dependencies){let d;e[13]!==c||e[14]!==i?(d=(f,x)=>(0,r.jsx)("div",{className:"border-b",children:(0,r.jsx)(ne,{nodeId:`root-${x}`,node:f,level:0,isTopLevel:!0,expandedNodes:c,onToggle:j,onSuccess:i})},`${f.name}-${x}`),e[13]=c,e[14]=i,e[15]=d):d=e[15],g=s.dependencies.map(d),e[9]=c,e[10]=i,e[11]=s.dependencies,e[12]=g}else g=e[12];let h;return e[16]===g?h=e[17]:(h=(0,r.jsx)("div",{className:"flex-1 overflow-auto",children:(0,r.jsx)("div",{children:g})}),e[16]=g,e[17]=h),h},ne=t=>{let e=(0,G.c)(58),{nodeId:s,node:n,level:i,isTopLevel:p,expandedNodes:c,onToggle:a,onSuccess:o}=t,l=p===void 0?!1:p,m=n.dependencies.length>0,j;e[0]!==c||e[1]!==s?(j=c.has(s),e[0]=c,e[1]=s,e[2]=j):j=e[2];let g=j,h=l?0:16+i*16,d;e[3]!==m||e[4]!==s||e[5]!==a?(d=N=>{(N.key==="Enter"||N.key===" ")&&(N.preventDefault(),m&&a(s))},e[3]=m,e[4]=s,e[5]=a,e[6]=d):d=e[6];let f=d,x;e[7]!==m||e[8]!==s||e[9]!==a?(x=N=>{N.stopPropagation(),m&&a(s)},e[7]=m,e[8]=s,e[9]=a,e[10]=x):x=e[10];let P=x,y=m&&"select-none",k=l?"px-2 py-0.5":"",b;e[11]!==y||e[12]!==k?(b=K("flex items-center group cursor-pointer text-sm whitespace-nowrap","hover:bg-(--slate-2) focus:bg-(--slate-2) focus:outline-hidden",y,k),e[11]=y,e[12]=k,e[13]=b):b=e[13];let v;e[14]!==h||e[15]!==l?(v=l?{}:{paddingLeft:`${h}px`},e[14]=h,e[15]=l,e[16]=v):v=e[16];let _=m?g:void 0,w;e[17]!==m||e[18]!==g?(w=m?g?(0,r.jsx)(ue,{className:"w-4 h-4 mr-2 shrink-0"}):(0,r.jsx)(fe,{className:"w-4 h-4 mr-2 shrink-0"}):(0,r.jsx)("div",{className:"w-4 mr-2 shrink-0"}),e[17]=m,e[18]=g,e[19]=w):w=e[19];let S;e[20]===n.name?S=e[21]:(S=(0,r.jsx)("span",{className:"font-medium truncate",children:n.name}),e[20]=n.name,e[21]=S);let u;e[22]===n.version?u=e[23]:(u=n.version&&(0,r.jsxs)("span",{className:"text-muted-foreground text-xs",children:["v",n.version]}),e[22]=n.version,e[23]=u);let C;e[24]!==S||e[25]!==u?(C=(0,r.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0 py-1.5",children:[S,u]}),e[24]=S,e[25]=u,e[26]=C):C=e[26];let E;e[27]===n.tags?E=e[28]:(E=n.tags.map(Te),e[27]=n.tags,e[28]=E);let $;e[29]===E?$=e[30]:($=(0,r.jsx)("div",{className:"flex items-center gap-1 ml-2",children:E}),e[29]=E,e[30]=$);let D;e[31]!==l||e[32]!==n.name||e[33]!==n.tags||e[34]!==o?(D=l&&(0,r.jsxs)("div",{className:"flex gap-1 invisible group-hover:visible",children:[(0,r.jsx)(re,{packageName:n.name,tags:n.tags,onSuccess:o}),(0,r.jsx)(se,{packageName:n.name,tags:n.tags,onSuccess:o})]}),e[31]=l,e[32]=n.name,e[33]=n.tags,e[34]=o,e[35]=D):D=e[35];let T;e[36]!==P||e[37]!==f||e[38]!==w||e[39]!==C||e[40]!==$||e[41]!==D||e[42]!==b||e[43]!==v||e[44]!==_?(T=(0,r.jsxs)("div",{className:b,style:v,onClick:P,onKeyDown:f,tabIndex:0,role:"treeitem","aria-selected":!1,"aria-expanded":_,children:[w,C,$,D]}),e[36]=P,e[37]=f,e[38]=w,e[39]=C,e[40]=$,e[41]=D,e[42]=b,e[43]=v,e[44]=_,e[45]=T):T=e[45];let A;e[46]!==c||e[47]!==m||e[48]!==g||e[49]!==i||e[50]!==n.dependencies||e[51]!==s||e[52]!==o||e[53]!==a?(A=m&&g&&(0,r.jsx)("div",{role:"group",children:n.dependencies.map((N,z)=>(0,r.jsx)(ne,{nodeId:`${s}-${z}`,node:N,level:i+1,isTopLevel:!1,expandedNodes:c,onToggle:a,onSuccess:o},`${N.name}-${z}`))}),e[46]=c,e[47]=m,e[48]=g,e[49]=i,e[50]=n.dependencies,e[51]=s,e[52]=o,e[53]=a,e[54]=A):A=e[54];let L;return e[55]!==T||e[56]!==A?(L=(0,r.jsxs)("div",{children:[T,A]}),e[55]=T,e[56]=A,e[57]=L):L=e[57],L};function De(t,e){return t==="list"?"list":e?t||"tree":"list"}function Te(t,e){return t.kind==="cycle"?(0,r.jsx)("div",{className:"items-center border px-2 py-0.5 text-xs transition-colors focus:outline-hidden focus:ring-2 focus:ring-ring focus:ring-offset-2 text-foreground rounded-sm text-ellipsis block overflow-hidden max-w-fit font-medium border-orange-300 dark:border-orange-700 text-orange-700 dark:text-orange-300",title:"cycle",children:"cycle"},e):t.kind==="extra"?(0,r.jsx)("div",{className:"items-center border px-2 py-0.5 text-xs transition-colors focus:outline-hidden focus:ring-2 focus:ring-ring focus:ring-offset-2 text-foreground rounded-sm text-ellipsis block overflow-hidden max-w-fit font-medium border-blue-300 dark:border-blue-700 text-blue-700 dark:text-blue-300",title:t.value,children:t.value},e):t.kind==="group"?(0,r.jsx)("div",{className:"items-center border px-2 py-0.5 text-xs transition-colors focus:outline-hidden focus:ring-2 focus:ring-ring focus:ring-offset-2 text-foreground rounded-sm text-ellipsis block overflow-hidden max-w-fit font-medium border-green-300 dark:border-green-700 text-green-700 dark:text-green-300",title:t.value,children:t.value},e):null}export{Ce as default};
