var Fr=Object.defineProperty;var Yr=(t,e,n)=>e in t?Fr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ie=(t,e,n)=>Yr(t,typeof e!="symbol"?e+"":e,n);import{s as It,t as q}from"./chunk-LvLJmgfZ.js";import{c as Zr,d as yn,n as ht,s as vn}from"./jotai-D74Ef_p1.js";import{t as Wr}from"./react-XTZdWHwa.js";import{E as Kr,d as Gr,k as bn,mt as Ur,sn as qr,vn as Qr,vt as Jr}from"./cells-B1ds6ZjK.js";import{t as ea}from"./react-dom-BZDtXk6t.js";import"./zod-BBqism5D.js";import{t as Re}from"./compiler-runtime-QczY1yfQ.js";import"./_Uint8Array-BGESiCQL.js";import"./isSymbol-BGkTcW3U.js";import"./toString-DlRqgfqz.js";import"./toNumber-GB_lFVaq.js";import"./toInteger-Cl1doThW.js";import"./isArrayLikeObject-BkJc8lDE.js";import"./_getTag-BWqNuuwU.js";import"./_baseIsEqual-C8v2yRqO.js";import"./merge-DVX6Ez37.js";import"./_baseSlice-CskhCEVH.js";import"./useLifecycle-bYJVBwo9.js";import"./_hasUnicode-BC4vb_bF.js";import"./_arrayReduce-BPS6ICyD.js";import"./type-Bx7IFbhF.js";import"./_baseProperty-Bl8lQyHQ.js";import"./now-DBnXnRPe.js";import"./debounce-BzCP2SOK.js";import"./hotkeys-sK-kaEBC.js";import"./invariant-EWlZS5z8.js";import"./utils-Clm_pCuX.js";import"./constants-Bt6NlroV.js";import"./config-BwUC_LRl.js";import"./useEventListener-BMXqdHZ5.js";import{t as ta}from"./jsx-runtime-B4_2-8Ho.js";import{r as na,t as Xe}from"./button-BtVgadIf.js";import"./clsx-CGw3WJH5.js";import{t as xn}from"./cn-f3ruLt4G.js";import"./dist-hQAzR0Cy.js";import"./dist-BWV-5FQQ.js";import{r as En}from"./once-DF3Ybce_.js";import"./capabilities-DPEuN0Kv.js";import"./cjs-VdEqhsWH.js";import"./createReducer-uDMmKGBt.js";import"./requests-CMMs4cl8.js";import"./dist-a5AhnPua.js";import"./dist-AYL4p4Dn.js";import{t as gt}from"./createLucideIcon-C9QGcv--.js";import{n as oa,r as ra}from"./cell-actions-Juc9p4m9.js";import"./check-Pczj-rmu.js";import{h as aa}from"./select-Dre1F6mo.js";import"./chevron-right-Cn1LhTdd.js";import{o as ia,s as sa}from"./download-Yhx6Ym5-.js";import{o as wn}from"./useCellActionButton-BDj2KBhe.js";import"./circle-plus-Bi4xcvVC.js";import"./toDate-J43JkZRd.js";import"./circle-x-72ItD0Ur.js";import"./dropdown-menu-DL4QHRL7.js";import"./code-xml-fIuLXB6s.js";import{t as la}from"./ellipsis-vertical-BLHGoVMA.js";import"./eye-off-CkynlJbW.js";import"./image-D-xr8yWr.js";import"./DeferredRequestRegistry-DUZWfqOX.js";import"./link-CbS4fPBa.js";import"./name-cell-input-Do6XiA3C.js";import"./input-fjIzfaON.js";import{t as da}from"./settings-DCyJEp5F.js";import"./state-GOQmrHWh.js";import{t as ca}from"./square-function-DNygr9WL.js";import"./trash-2-DkyoQBeV.js";import{t as ua}from"./workflow-DpU95Ph-.js";import"./badge-DjEl44tW.js";import"./preload-helper-WDmkW-6F.js";import"./dist-BFZNB01C.js";import"./dist-DjRxw7g7.js";import"./dist-BRKC9vDH.js";import"./dist-C2lGLtUJ.js";import"./dist-CiIxDFsH.js";import"./stex-BQjjdb1n.js";import"./Deferred-cELqHKYi.js";import"./uuid-DFgsIVBI.js";import"./use-toast-CTk3v2Fk.js";import"./main-B1nOh376.js";import"./useNonce-BPtPhVM4.js";import"./connection-DZfQ0nfK.js";import"./useTheme-DNzypnwR.js";import"./Combination-DIF6wDxT.js";import"./dist-DTKIwXcy.js";import{t as ha}from"./tooltip-DEUNsdbK.js";import"./menu-items-QU91GQzu.js";import"./mode-DQrmKtLw.js";import"./alert-dialog-CYJZg0vV.js";import"./dialog-C-S4uQH4.js";import"./usePress-CuSksPzr.js";import"./SSRProvider-DrIPqn2D.js";import"./context-C5uPODSj.js";import"./useNumberFormatter-C1aNc7b4.js";import"./shim-DZsTM49a.js";import"./numbers-BWXaNlZC.js";import{n as Sn}from"./useEvent-bc5jSpSz.js";import{n as ga}from"./useDebounce-Dz48GAub.js";import"./ImperativeModal-DD50EU1G.js";import"./copy-CL0ql7QN.js";import"./useRunCells-D8WfVv85.js";import"./extends-r-9mmG40.js";import"./objectWithoutPropertiesLoose-dfl_7i8r.js";import"./kbd-BGS9frER.js";import"./renderShortcut-CF5R2n1d.js";import"./dist-CSuUnJvL.js";import{t as ma}from"./label-CzgZucd0.js";import{i as fa,r as pa,t as ya}from"./popover-CmnWYkoH.js";import{i as Cn,t as jt}from"./cell-link-ByqSnfe2.js";import"./esm-DDxkZACy.js";import{i as va}from"./focus-BwsN5YFR.js";import"./add-missing-import-BkauGlV2.js";import"./useDeleteCell-BCwFj4vN.js";import"./icons-CVbUY4lM.js";import"./switch-DXZyYXuk.js";import{b as ba}from"./timer-CjInJf90.js";import{a as Rt,c as At,i as xa,l as Bt,n as Fe,o as Ea,r as wa,s as Nn,t as Sa,u as mt}from"./src-R7nIPgRU.js";import{t as Ca}from"./TinyCode-Cao0NuXg.js";import"./multi-icon-Du4jZia9.js";import"./useSplitCell-BwGnS2JP.js";import{n as Na,t as kn}from"./common-BYQt3-He.js";var ka=gt("arrow-right-from-line",[["path",{d:"M3 5v14",key:"1nt18q"}],["path",{d:"M21 12H7",key:"13ipq5"}],["path",{d:"m15 18 6-6-6-6",key:"6tx3qv"}]]),Ma=gt("arrow-right-to-line",[["path",{d:"M17 12H3",key:"8awo09"}],["path",{d:"m11 18 6-6-6-6",key:"8c2y43"}],["path",{d:"M21 5v14",key:"nzette"}]]),_a=gt("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Oa=gt("rows-3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M21 9H3",key:"1338ky"}],["path",{d:"M21 15H3",key:"9uk58r"}]]);function he(t){if(typeof t=="string"||typeof t=="number")return""+t;let e="";if(Array.isArray(t))for(let n=0,o;n<t.length;n++)(o=he(t[n]))!==""&&(e+=(e&&" ")+o);else for(let n in t)t[n]&&(e+=(e&&" ")+n);return e}var y=It(Wr(),1),Pa=It(ia(),1),{useDebugValue:Da}=y.default,{useSyncExternalStoreWithSelector:Ia}=Pa.default,ja=t=>t;function Mn(t,e=ja,n){let o=Ia(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return Da(o),o}var _n=(t,e)=>{let n=sa(t),o=(i,l=e)=>Mn(n,i,l);return Object.assign(o,n),o},Ra=(t,e)=>t?_n(t,e):_n;function ue(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||!t||typeof e!="object"||!e)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(let[o,i]of t)if(!Object.is(i,e.get(o)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(let o of t)if(!e.has(o))return!1;return!0}let n=Object.keys(t);if(n.length!==Object.keys(e).length)return!1;for(let o of n)if(!Object.prototype.hasOwnProperty.call(e,o)||!Object.is(t[o],e[o]))return!1;return!0}var ft=t=>()=>t;function zt(t,{sourceEvent:e,subject:n,target:o,identifier:i,active:l,x:a,y:d,dx:s,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:l,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:d,enumerable:!0,configurable:!0},dx:{value:s,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}zt.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Aa(t){return!t.ctrlKey&&!t.button}function Ba(){return this.parentNode}function za(t,e){return e??{x:t.x,y:t.y}}function La(){return navigator.maxTouchPoints||"ontouchstart"in this}function $a(){var t=Aa,e=Ba,n=za,o=La,i={},l=ba("start","drag","end"),a=0,d,s,c,u,r=0;function g(f){f.on("mousedown.drag",h).filter(o).on("touchstart.drag",v).on("touchmove.drag",x,Ea).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(f,C){if(!(u||!t.call(this,f,C))){var M=N(this,e.call(this,f,C),f,C,"mouse");M&&(mt(f.view).on("mousemove.drag",p,Nn).on("mouseup.drag",m,Nn),wa(f.view),At(f),c=!1,d=f.clientX,s=f.clientY,M("start",f))}}function p(f){if(Rt(f),!c){var C=f.clientX-d,M=f.clientY-s;c=C*C+M*M>r}i.mouse("drag",f)}function m(f){mt(f.view).on("mousemove.drag mouseup.drag",null),xa(f.view,c),Rt(f),i.mouse("end",f)}function v(f,C){if(t.call(this,f,C)){var M=f.changedTouches,O=e.call(this,f,C),D=M.length,P,E;for(P=0;P<D;++P)(E=N(this,O,f,C,M[P].identifier,M[P]))&&(At(f),E("start",f,M[P]))}}function x(f){var C=f.changedTouches,M=C.length,O,D;for(O=0;O<M;++O)(D=i[C[O].identifier])&&(Rt(f),D("drag",f,C[O]))}function b(f){var C=f.changedTouches,M=C.length,O,D;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),O=0;O<M;++O)(D=i[C[O].identifier])&&(At(f),D("end",f,C[O]))}function N(f,C,M,O,D,P){var E=l.copy(),w=Bt(P||M,C),_,k,S;if((S=n.call(f,new zt("beforestart",{sourceEvent:M,target:g,identifier:D,active:a,x:w[0],y:w[1],dx:0,dy:0,dispatch:E}),O))!=null)return _=S.x-w[0]||0,k=S.y-w[1]||0,function R(z,$,F){var j=w,T;switch(z){case"start":i[D]=R,T=a++;break;case"end":delete i[D],--a;case"drag":w=Bt(F||$,C),T=a;break}E.call(z,f,new zt(z,{sourceEvent:$,subject:S,target:g,identifier:D,active:T,x:w[0]+_,y:w[1]+k,dx:w[0]-j[0],dy:w[1]-j[1],dispatch:E}),O)}}return g.filter=function(f){return arguments.length?(t=typeof f=="function"?f:ft(!!f),g):t},g.container=function(f){return arguments.length?(e=typeof f=="function"?f:ft(f),g):e},g.subject=function(f){return arguments.length?(n=typeof f=="function"?f:ft(f),g):n},g.touchable=function(f){return arguments.length?(o=typeof f=="function"?f:ft(!!f),g):o},g.on=function(){var f=l.on.apply(l,arguments);return f===l?g:f},g.clickDistance=function(f){return arguments.length?(r=(f=+f)*f,g):Math.sqrt(r)},g}ea();var pt=(0,y.createContext)(null),Ta=pt.Provider,xe={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,e)=>`Couldn't create edge for ${t?"target":"source"} handle id: "${t?e.targetHandle:e.sourceHandle}", edge id: ${e.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`,error012:t=>`Node with id "${t}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},On=xe.error001();function ne(t,e){let n=(0,y.useContext)(pt);if(n===null)throw Error(On);return Mn(n,t,e)}var le=()=>{let t=(0,y.useContext)(pt);if(t===null)throw Error(On);return(0,y.useMemo)(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe,destroy:t.destroy}),[t])},Ha=t=>t.userSelectionActive?"none":"all";function yt({position:t,children:e,className:n,style:o,...i}){let l=ne(Ha),a=`${t}`.split("-");return y.createElement("div",{className:he(["react-flow__panel",n,...a]),style:{...o,pointerEvents:l},...i},e)}function Va({proOptions:t,position:e="bottom-right"}){return t!=null&&t.hideAttribution?null:y.createElement(yt,{position:e,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},y.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}var Xa=(0,y.memo)(({x:t,y:e,label:n,labelStyle:o={},labelShowBg:i=!0,labelBgStyle:l={},labelBgPadding:a=[2,4],labelBgBorderRadius:d=2,children:s,className:c,...u})=>{let r=(0,y.useRef)(null),[g,h]=(0,y.useState)({x:0,y:0,width:0,height:0}),p=he(["react-flow__edge-textwrapper",c]);return(0,y.useEffect)(()=>{if(r.current){let m=r.current.getBBox();h({x:m.x,y:m.y,width:m.width,height:m.height})}},[n]),n===void 0||!n?null:y.createElement("g",{transform:`translate(${t-g.width/2} ${e-g.height/2})`,className:p,visibility:g.width?"visible":"hidden",...u},i&&y.createElement("rect",{width:g.width+2*a[0],x:-a[0],y:-a[1],height:g.height+2*a[1],className:"react-flow__edge-textbg",style:l,rx:d,ry:d}),y.createElement("text",{className:"react-flow__edge-text",y:g.height/2,dy:"0.3em",ref:r,style:o},n),s)}),Lt=t=>({width:t.offsetWidth,height:t.offsetHeight}),Ye=(t,e=0,n=1)=>Math.min(Math.max(t,e),n),$t=(t={x:0,y:0},e)=>({x:Ye(t.x,e[0][0],e[1][0]),y:Ye(t.y,e[0][1],e[1][1])}),Pn=(t,e,n)=>t<e?Ye(Math.abs(t-e),1,50)/50:t>n?-Ye(Math.abs(t-n),1,50)/50:0,Dn=(t,e)=>[Pn(t.x,35,e.width-35)*20,Pn(t.y,35,e.height-35)*20],In=t=>{var e;return((e=t.getRootNode)==null?void 0:e.call(t))||(window==null?void 0:window.document)},Fa=(t,e)=>({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x2,e.x2),y2:Math.max(t.y2,e.y2)}),Tt=({x:t,y:e,width:n,height:o})=>({x:t,y:e,x2:t+n,y2:e+o}),Ya=({x:t,y:e,x2:n,y2:o})=>({x:t,y:e,width:n-t,height:o-e}),jn=t=>({...t.positionAbsolute||{x:0,y:0},width:t.width||0,height:t.height||0}),Ht=(t,e)=>{let n=Math.max(0,Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x)),o=Math.max(0,Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y));return Math.ceil(n*o)},Za=t=>pe(t.width)&&pe(t.height)&&pe(t.x)&&pe(t.y),pe=t=>!isNaN(t)&&isFinite(t),re=Symbol.for("internals"),Rn=["Enter"," ","Escape"],Wa=(t,e)=>{},Ka=t=>"nativeEvent"in t;function Vt(t){var n,o,i;let e=((i=(o=(n=Ka(t)?t.nativeEvent:t).composedPath)==null?void 0:o.call(n))==null?void 0:i[0])||t.target;return["INPUT","SELECT","TEXTAREA"].includes(e==null?void 0:e.nodeName)||(e==null?void 0:e.hasAttribute("contenteditable"))||!!(e!=null&&e.closest(".nokey"))}var An=t=>"clientX"in t,Se=(t,e)=>{var l,a;let n=An(t),o=n?t.clientX:(l=t.touches)==null?void 0:l[0].clientX,i=n?t.clientY:(a=t.touches)==null?void 0:a[0].clientY;return{x:o-((e==null?void 0:e.left)??0),y:i-((e==null?void 0:e.top)??0)}},vt=()=>{var t;return typeof navigator<"u"&&((t=navigator==null?void 0:navigator.userAgent)==null?void 0:t.indexOf("Mac"))>=0},rt=({id:t,path:e,labelX:n,labelY:o,label:i,labelStyle:l,labelShowBg:a,labelBgStyle:d,labelBgPadding:s,labelBgBorderRadius:c,style:u,markerEnd:r,markerStart:g,interactionWidth:h=20})=>y.createElement(y.Fragment,null,y.createElement("path",{id:t,style:u,d:e,fill:"none",className:"react-flow__edge-path",markerEnd:r,markerStart:g}),h&&y.createElement("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),i&&pe(n)&&pe(o)?y.createElement(Xa,{x:n,y:o,label:i,labelStyle:l,labelShowBg:a,labelBgStyle:d,labelBgPadding:s,labelBgBorderRadius:c}):null);rt.displayName="BaseEdge";function at(t,e,n){return n===void 0?n:o=>{let i=e().edges.find(l=>l.id===t);i&&n(o,{...i})}}function Bn({sourceX:t,sourceY:e,targetX:n,targetY:o}){let i=Math.abs(n-t)/2,l=n<t?n+i:n-i,a=Math.abs(o-e)/2;return[l,o<e?o+a:o-a,i,a]}function zn({sourceX:t,sourceY:e,targetX:n,targetY:o,sourceControlX:i,sourceControlY:l,targetControlX:a,targetControlY:d}){let s=t*.125+i*.375+a*.375+n*.125,c=e*.125+l*.375+d*.375+o*.125;return[s,c,Math.abs(s-t),Math.abs(c-e)]}var Ze;(function(t){t.Strict="strict",t.Loose="loose"})(Ze||(Ze={}));var Ae;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})(Ae||(Ae={}));var bt;(function(t){t.Partial="partial",t.Full="full"})(bt||(bt={}));var Be;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})(Be||(Be={}));var it;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})(it||(it={}));var Y;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})(Y||(Y={}));function Ln({pos:t,x1:e,y1:n,x2:o,y2:i}){return t===Y.Left||t===Y.Right?[.5*(e+o),n]:[e,.5*(n+i)]}function $n({sourceX:t,sourceY:e,sourcePosition:n=Y.Bottom,targetX:o,targetY:i,targetPosition:l=Y.Top}){let[a,d]=Ln({pos:n,x1:t,y1:e,x2:o,y2:i}),[s,c]=Ln({pos:l,x1:o,y1:i,x2:t,y2:e}),[u,r,g,h]=zn({sourceX:t,sourceY:e,targetX:o,targetY:i,sourceControlX:a,sourceControlY:d,targetControlX:s,targetControlY:c});return[`M${t},${e} C${a},${d} ${s},${c} ${o},${i}`,u,r,g,h]}var Xt=(0,y.memo)(({sourceX:t,sourceY:e,targetX:n,targetY:o,sourcePosition:i=Y.Bottom,targetPosition:l=Y.Top,label:a,labelStyle:d,labelShowBg:s,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:r,style:g,markerEnd:h,markerStart:p,interactionWidth:m})=>{let[v,x,b]=$n({sourceX:t,sourceY:e,sourcePosition:i,targetX:n,targetY:o,targetPosition:l});return y.createElement(rt,{path:v,labelX:x,labelY:b,label:a,labelStyle:d,labelShowBg:s,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:r,style:g,markerEnd:h,markerStart:p,interactionWidth:m})});Xt.displayName="SimpleBezierEdge";var Tn={[Y.Left]:{x:-1,y:0},[Y.Right]:{x:1,y:0},[Y.Top]:{x:0,y:-1},[Y.Bottom]:{x:0,y:1}},Ga=({source:t,sourcePosition:e=Y.Bottom,target:n})=>e===Y.Left||e===Y.Right?t.x<n.x?{x:1,y:0}:{x:-1,y:0}:t.y<n.y?{x:0,y:1}:{x:0,y:-1},Hn=(t,e)=>Math.sqrt((e.x-t.x)**2+(e.y-t.y)**2);function Ua({source:t,sourcePosition:e=Y.Bottom,target:n,targetPosition:o=Y.Top,center:i,offset:l}){let a=Tn[e],d=Tn[o],s={x:t.x+a.x*l,y:t.y+a.y*l},c={x:n.x+d.x*l,y:n.y+d.y*l},u=Ga({source:s,sourcePosition:e,target:c}),r=u.x===0?"y":"x",g=u[r],h=[],p,m,v={x:0,y:0},x={x:0,y:0},[b,N,f,C]=Bn({sourceX:t.x,sourceY:t.y,targetX:n.x,targetY:n.y});if(a[r]*d[r]===-1){p=i.x??b,m=i.y??N;let M=[{x:p,y:s.y},{x:p,y:c.y}],O=[{x:s.x,y:m},{x:c.x,y:m}];h=a[r]===g?r==="x"?M:O:r==="x"?O:M}else{let M=[{x:s.x,y:c.y}],O=[{x:c.x,y:s.y}];if(h=r==="x"?a.x===g?O:M:a.y===g?M:O,e===o){let E=Math.abs(t[r]-n[r]);if(E<=l){let w=Math.min(l-1,l-E);a[r]===g?v[r]=(s[r]>t[r]?-1:1)*w:x[r]=(c[r]>n[r]?-1:1)*w}}if(e!==o){let E=r==="x"?"y":"x",w=a[r]===d[E],_=s[E]>c[E],k=s[E]<c[E];(a[r]===1&&(!w&&_||w&&k)||a[r]!==1&&(!w&&k||w&&_))&&(h=r==="x"?M:O)}let D={x:s.x+v.x,y:s.y+v.y},P={x:c.x+x.x,y:c.y+x.y};Math.max(Math.abs(D.x-h[0].x),Math.abs(P.x-h[0].x))>=Math.max(Math.abs(D.y-h[0].y),Math.abs(P.y-h[0].y))?(p=(D.x+P.x)/2,m=h[0].y):(p=h[0].x,m=(D.y+P.y)/2)}return[[t,{x:s.x+v.x,y:s.y+v.y},...h,{x:c.x+x.x,y:c.y+x.y},n],p,m,f,C]}function qa(t,e,n,o){let i=Math.min(Hn(t,e)/2,Hn(e,n)/2,o),{x:l,y:a}=e;if(t.x===l&&l===n.x||t.y===a&&a===n.y)return`L${l} ${a}`;if(t.y===a){let s=t.x<n.x?-1:1,c=t.y<n.y?1:-1;return`L ${l+i*s},${a}Q ${l},${a} ${l},${a+i*c}`}let d=t.x<n.x?1:-1;return`L ${l},${a+i*(t.y<n.y?-1:1)}Q ${l},${a} ${l+i*d},${a}`}function Ft({sourceX:t,sourceY:e,sourcePosition:n=Y.Bottom,targetX:o,targetY:i,targetPosition:l=Y.Top,borderRadius:a=5,centerX:d,centerY:s,offset:c=20}){let[u,r,g,h,p]=Ua({source:{x:t,y:e},sourcePosition:n,target:{x:o,y:i},targetPosition:l,center:{x:d,y:s},offset:c});return[u.reduce((m,v,x)=>{let b="";return b=x>0&&x<u.length-1?qa(u[x-1],v,u[x+1],a):`${x===0?"M":"L"}${v.x} ${v.y}`,m+=b,m},""),r,g,h,p]}var xt=(0,y.memo)(({sourceX:t,sourceY:e,targetX:n,targetY:o,label:i,labelStyle:l,labelShowBg:a,labelBgStyle:d,labelBgPadding:s,labelBgBorderRadius:c,style:u,sourcePosition:r=Y.Bottom,targetPosition:g=Y.Top,markerEnd:h,markerStart:p,pathOptions:m,interactionWidth:v})=>{let[x,b,N]=Ft({sourceX:t,sourceY:e,sourcePosition:r,targetX:n,targetY:o,targetPosition:g,borderRadius:m==null?void 0:m.borderRadius,offset:m==null?void 0:m.offset});return y.createElement(rt,{path:x,labelX:b,labelY:N,label:i,labelStyle:l,labelShowBg:a,labelBgStyle:d,labelBgPadding:s,labelBgBorderRadius:c,style:u,markerEnd:h,markerStart:p,interactionWidth:v})});xt.displayName="SmoothStepEdge";var Yt=(0,y.memo)(t=>{var e;return y.createElement(xt,{...t,pathOptions:(0,y.useMemo)(()=>{var n;return{borderRadius:0,offset:(n=t.pathOptions)==null?void 0:n.offset}},[(e=t.pathOptions)==null?void 0:e.offset])})});Yt.displayName="StepEdge";function Qa({sourceX:t,sourceY:e,targetX:n,targetY:o}){let[i,l,a,d]=Bn({sourceX:t,sourceY:e,targetX:n,targetY:o});return[`M ${t},${e}L ${n},${o}`,i,l,a,d]}var Zt=(0,y.memo)(({sourceX:t,sourceY:e,targetX:n,targetY:o,label:i,labelStyle:l,labelShowBg:a,labelBgStyle:d,labelBgPadding:s,labelBgBorderRadius:c,style:u,markerEnd:r,markerStart:g,interactionWidth:h})=>{let[p,m,v]=Qa({sourceX:t,sourceY:e,targetX:n,targetY:o});return y.createElement(rt,{path:p,labelX:m,labelY:v,label:i,labelStyle:l,labelShowBg:a,labelBgStyle:d,labelBgPadding:s,labelBgBorderRadius:c,style:u,markerEnd:r,markerStart:g,interactionWidth:h})});Zt.displayName="StraightEdge";function Et(t,e){return t>=0?.5*t:e*25*Math.sqrt(-t)}function Vn({pos:t,x1:e,y1:n,x2:o,y2:i,c:l}){switch(t){case Y.Left:return[e-Et(e-o,l),n];case Y.Right:return[e+Et(o-e,l),n];case Y.Top:return[e,n-Et(n-i,l)];case Y.Bottom:return[e,n+Et(i-n,l)]}}function Xn({sourceX:t,sourceY:e,sourcePosition:n=Y.Bottom,targetX:o,targetY:i,targetPosition:l=Y.Top,curvature:a=.25}){let[d,s]=Vn({pos:n,x1:t,y1:e,x2:o,y2:i,c:a}),[c,u]=Vn({pos:l,x1:o,y1:i,x2:t,y2:e,c:a}),[r,g,h,p]=zn({sourceX:t,sourceY:e,targetX:o,targetY:i,sourceControlX:d,sourceControlY:s,targetControlX:c,targetControlY:u});return[`M${t},${e} C${d},${s} ${c},${u} ${o},${i}`,r,g,h,p]}var wt=(0,y.memo)(({sourceX:t,sourceY:e,targetX:n,targetY:o,sourcePosition:i=Y.Bottom,targetPosition:l=Y.Top,label:a,labelStyle:d,labelShowBg:s,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:r,style:g,markerEnd:h,markerStart:p,pathOptions:m,interactionWidth:v})=>{let[x,b,N]=Xn({sourceX:t,sourceY:e,sourcePosition:i,targetX:n,targetY:o,targetPosition:l,curvature:m==null?void 0:m.curvature});return y.createElement(rt,{path:x,labelX:b,labelY:N,label:a,labelStyle:d,labelShowBg:s,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:r,style:g,markerEnd:h,markerStart:p,interactionWidth:v})});wt.displayName="BezierEdge";var Wt=(0,y.createContext)(null),Ja=Wt.Provider;Wt.Consumer;var ei=()=>(0,y.useContext)(Wt),ti=t=>"id"in t&&"source"in t&&"target"in t,ni=({source:t,sourceHandle:e,target:n,targetHandle:o})=>`reactflow__edge-${t}${e||""}-${n}${o||""}`,Kt=(t,e)=>t===void 0?"":typeof t=="string"?t:`${e?`${e}__`:""}${Object.keys(t).sort().map(n=>`${n}=${t[n]}`).join("&")}`,oi=(t,e)=>e.some(n=>n.source===t.source&&n.target===t.target&&(n.sourceHandle===t.sourceHandle||!n.sourceHandle&&!t.sourceHandle)&&(n.targetHandle===t.targetHandle||!n.targetHandle&&!t.targetHandle)),ri=(t,e)=>{if(!t.source||!t.target)return xe.error006(),e;let n;return n=ti(t)?{...t}:{...t,id:ni(t)},oi(n,e)?e:e.concat(n)},Gt=({x:t,y:e},[n,o,i],l,[a,d])=>{let s={x:(t-n)/i,y:(e-o)/i};return l?{x:a*Math.round(s.x/a),y:d*Math.round(s.y/d)}:s},Fn=({x:t,y:e},[n,o,i])=>({x:t*i+n,y:e*i+o}),We=(t,e=[0,0])=>{if(!t)return{x:0,y:0,positionAbsolute:{x:0,y:0}};let n=(t.width??0)*e[0],o=(t.height??0)*e[1],i={x:t.position.x-n,y:t.position.y-o};return{...i,positionAbsolute:t.positionAbsolute?{x:t.positionAbsolute.x-n,y:t.positionAbsolute.y-o}:i}},Ut=(t,e=[0,0])=>t.length===0?{x:0,y:0,width:0,height:0}:Ya(t.reduce((n,o)=>{let{x:i,y:l}=We(o,e).positionAbsolute;return Fa(n,Tt({x:i,y:l,width:o.width||0,height:o.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0})),Yn=(t,e,[n,o,i]=[0,0,1],l=!1,a=!1,d=[0,0])=>{let s={x:(e.x-n)/i,y:(e.y-o)/i,width:e.width/i,height:e.height/i},c=[];return t.forEach(u=>{let{width:r,height:g,selectable:h=!0,hidden:p=!1}=u;if(a&&!h||p)return!1;let{positionAbsolute:m}=We(u,d),v=Ht(s,{x:m.x,y:m.y,width:r||0,height:g||0}),x=r===void 0||g===void 0||r===null||g===null,b=l&&v>0,N=(r||0)*(g||0);(x||b||v>=N||u.dragging)&&c.push(u)}),c},Zn=(t,e)=>{let n=t.map(o=>o.id);return e.filter(o=>n.includes(o.source)||n.includes(o.target))},Wn=(t,e,n,o,i,l=.1)=>{let a=e/(t.width*(1+l)),d=n/(t.height*(1+l)),s=Ye(Math.min(a,d),o,i),c=t.x+t.width/2,u=t.y+t.height/2;return{x:e/2-c*s,y:n/2-u*s,zoom:s}},ze=(t,e=0)=>t.transition().duration(e);function Kn(t,e,n,o){return(e[n]||[]).reduce((i,l)=>{var a,d;return`${t.id}-${l.id}-${n}`!==o&&i.push({id:l.id||null,type:n,nodeId:t.id,x:(((a=t.positionAbsolute)==null?void 0:a.x)??0)+l.x+l.width/2,y:(((d=t.positionAbsolute)==null?void 0:d.y)??0)+l.y+l.height/2}),i},[])}function ai(t,e,n,o,i,l){let{x:a,y:d}=Se(t),s=e.elementsFromPoint(a,d).find(h=>h.classList.contains("react-flow__handle"));if(s){let h=s.getAttribute("data-nodeid");if(h){let p=qt(void 0,s),m=s.getAttribute("data-handleid"),v=l({nodeId:h,id:m,type:p});if(v){let x=i.find(b=>b.nodeId===h&&b.type===p&&b.id===m);return{handle:{id:m,type:p,nodeId:h,x:(x==null?void 0:x.x)||n.x,y:(x==null?void 0:x.y)||n.y},validHandleResult:v}}}}let c=[],u=1/0;if(i.forEach(h=>{let p=Math.sqrt((h.x-n.x)**2+(h.y-n.y)**2);if(p<=o){let m=l(h);p<=u&&(p<u?c=[{handle:h,validHandleResult:m}]:p===u&&c.push({handle:h,validHandleResult:m}),u=p)}}),!c.length)return{handle:null,validHandleResult:Gn()};if(c.length===1)return c[0];let r=c.some(({validHandleResult:h})=>h.isValid),g=c.some(({handle:h})=>h.type==="target");return c.find(({handle:h,validHandleResult:p})=>g?h.type==="target":r?p.isValid:!0)||c[0]}var ii={source:null,target:null,sourceHandle:null,targetHandle:null},Gn=()=>({handleDomNode:null,isValid:!1,connection:ii,endHandle:null});function Un(t,e,n,o,i,l,a){let d=i==="target",s=a.querySelector(`.react-flow__handle[data-id="${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`),c={...Gn(),handleDomNode:s};if(s){let u=qt(void 0,s),r=s.getAttribute("data-nodeid"),g=s.getAttribute("data-handleid"),h=s.classList.contains("connectable"),p=s.classList.contains("connectableend"),m={source:d?r:n,sourceHandle:d?g:o,target:d?n:r,targetHandle:d?o:g};c.connection=m,h&&p&&(e===Ze.Strict?d&&u==="source"||!d&&u==="target":r!==n||g!==o)&&(c.endHandle={nodeId:r,handleId:g,type:u},c.isValid=l(m))}return c}function si({nodes:t,nodeId:e,handleId:n,handleType:o}){return t.reduce((i,l)=>{if(l[re]){let{handleBounds:a}=l[re],d=[],s=[];a&&(d=Kn(l,a,"source",`${e}-${n}-${o}`),s=Kn(l,a,"target",`${e}-${n}-${o}`)),i.push(...d,...s)}return i},[])}function qt(t,e){return t||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function Qt(t){t==null||t.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function li(t,e){let n=null;return e?n="valid":t&&!e&&(n="invalid"),n}function qn({event:t,handleId:e,nodeId:n,onConnect:o,isTarget:i,getState:l,setState:a,isValidConnection:d,edgeUpdaterType:s,onReconnectEnd:c}){let u=In(t.target),{connectionMode:r,domNode:g,autoPanOnConnect:h,connectionRadius:p,onConnectStart:m,panBy:v,getNodes:x,cancelConnection:b}=l(),N=0,f,{x:C,y:M}=Se(t),O=u==null?void 0:u.elementFromPoint(C,M),D=qt(s,O),P=g==null?void 0:g.getBoundingClientRect();if(!P||!D)return;let E,w=Se(t,P),_=!1,k=null,S=!1,R=null,z=si({nodes:x(),nodeId:n,handleId:e,handleType:D}),$=()=>{if(!h)return;let[T,V]=Dn(w,P);v({x:T,y:V}),N=requestAnimationFrame($)};a({connectionPosition:w,connectionStatus:null,connectionNodeId:n,connectionHandleId:e,connectionHandleType:D,connectionStartHandle:{nodeId:n,handleId:e,type:D},connectionEndHandle:null}),m==null||m(t,{nodeId:n,handleId:e,handleType:D});function F(T){let{transform:V}=l();w=Se(T,P);let{handle:X,validHandleResult:W}=ai(T,u,Gt(w,V,!1,[1,1]),p,z,U=>Un(U,r,n,e,i?"target":"source",d,u));if(f=X,_||(_=($(),!0)),R=W.handleDomNode,k=W.connection,S=W.isValid,a({connectionPosition:f&&S?Fn({x:f.x,y:f.y},V):w,connectionStatus:li(!!f,S),connectionEndHandle:W.endHandle}),!f&&!S&&!R)return Qt(E);k.source!==k.target&&R&&(Qt(E),E=R,R.classList.add("connecting","react-flow__handle-connecting"),R.classList.toggle("valid",S),R.classList.toggle("react-flow__handle-valid",S))}function j(T){var V,X;(f||R)&&k&&S&&(o==null||o(k)),(X=(V=l()).onConnectEnd)==null||X.call(V,T),s&&(c==null||c(T)),Qt(E),b(),cancelAnimationFrame(N),_=!1,S=!1,k=null,R=null,u.removeEventListener("mousemove",F),u.removeEventListener("mouseup",j),u.removeEventListener("touchmove",F),u.removeEventListener("touchend",j)}u.addEventListener("mousemove",F),u.addEventListener("mouseup",j),u.addEventListener("touchmove",F),u.addEventListener("touchend",j)}var Qn=()=>!0,di=t=>({connectionStartHandle:t.connectionStartHandle,connectOnClick:t.connectOnClick,noPanClassName:t.noPanClassName}),ci=(t,e,n)=>o=>{let{connectionStartHandle:i,connectionEndHandle:l,connectionClickStartHandle:a}=o;return{connecting:(i==null?void 0:i.nodeId)===t&&(i==null?void 0:i.handleId)===e&&(i==null?void 0:i.type)===n||(l==null?void 0:l.nodeId)===t&&(l==null?void 0:l.handleId)===e&&(l==null?void 0:l.type)===n,clickConnecting:(a==null?void 0:a.nodeId)===t&&(a==null?void 0:a.handleId)===e&&(a==null?void 0:a.type)===n}},Jn=(0,y.forwardRef)(({type:t="source",position:e=Y.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:i=!0,isConnectableEnd:l=!0,id:a,onConnect:d,children:s,className:c,onMouseDown:u,onTouchStart:r,...g},h)=>{var P,E;let p=a||null,m=t==="target",v=le(),x=ei(),{connectOnClick:b,noPanClassName:N}=ne(di,ue),{connecting:f,clickConnecting:C}=ne(ci(x,p,t),ue);x||((E=(P=v.getState()).onError)==null||E.call(P,"010",xe.error010()));let M=w=>{let{defaultEdgeOptions:_,onConnect:k,hasDefaultEdges:S}=v.getState(),R={..._,...w};if(S){let{edges:z,setEdges:$}=v.getState();$(ri(R,z))}k==null||k(R),d==null||d(R)},O=w=>{if(!x)return;let _=An(w);i&&(_&&w.button===0||!_)&&qn({event:w,handleId:p,nodeId:x,onConnect:M,isTarget:m,getState:v.getState,setState:v.setState,isValidConnection:n||v.getState().isValidConnection||Qn}),_?u==null||u(w):r==null||r(w)},D=w=>{let{onClickConnectStart:_,onClickConnectEnd:k,connectionClickStartHandle:S,connectionMode:R,isValidConnection:z}=v.getState();if(!x||!S&&!i)return;if(!S){_==null||_(w,{nodeId:x,handleId:p,handleType:t}),v.setState({connectionClickStartHandle:{nodeId:x,type:t,handleId:p}});return}let $=In(w.target),F=n||z||Qn,{connection:j,isValid:T}=Un({nodeId:x,id:p,type:t},R,S.nodeId,S.handleId||null,S.type,F,$);T&&M(j),k==null||k(w),v.setState({connectionClickStartHandle:null})};return y.createElement("div",{"data-handleid":p,"data-nodeid":x,"data-handlepos":e,"data-id":`${x}-${p}-${t}`,className:he(["react-flow__handle",`react-flow__handle-${e}`,"nodrag",N,c,{source:!m,target:m,connectable:o,connectablestart:i,connectableend:l,connecting:C,connectionindicator:o&&(i&&!f||l&&f)}]),onMouseDown:O,onTouchStart:O,onClick:b?D:void 0,ref:h,...g},s)});Jn.displayName="Handle";var Ce=(0,y.memo)(Jn),eo=({data:t,isConnectable:e,targetPosition:n=Y.Top,sourcePosition:o=Y.Bottom})=>y.createElement(y.Fragment,null,y.createElement(Ce,{type:"target",position:n,isConnectable:e}),t==null?void 0:t.label,y.createElement(Ce,{type:"source",position:o,isConnectable:e}));eo.displayName="DefaultNode";var Jt=(0,y.memo)(eo),to=({data:t,isConnectable:e,sourcePosition:n=Y.Bottom})=>y.createElement(y.Fragment,null,t==null?void 0:t.label,y.createElement(Ce,{type:"source",position:n,isConnectable:e}));to.displayName="InputNode";var no=(0,y.memo)(to),oo=({data:t,isConnectable:e,targetPosition:n=Y.Top})=>y.createElement(y.Fragment,null,y.createElement(Ce,{type:"target",position:n,isConnectable:e}),t==null?void 0:t.label);oo.displayName="OutputNode";var ro=(0,y.memo)(oo),en=()=>null;en.displayName="GroupNode";var ui=t=>({selectedNodes:t.getNodes().filter(e=>e.selected),selectedEdges:t.edges.filter(e=>e.selected).map(e=>({...e}))}),St=t=>t.id;function hi(t,e){return ue(t.selectedNodes.map(St),e.selectedNodes.map(St))&&ue(t.selectedEdges.map(St),e.selectedEdges.map(St))}var ao=(0,y.memo)(({onSelectionChange:t})=>{let e=le(),{selectedNodes:n,selectedEdges:o}=ne(ui,hi);return(0,y.useEffect)(()=>{let i={nodes:n,edges:o};t==null||t(i),e.getState().onSelectionChange.forEach(l=>l(i))},[n,o,t]),null});ao.displayName="SelectionListener";var gi=t=>!!t.onSelectionChange;function mi({onSelectionChange:t}){let e=ne(gi);return t||e?y.createElement(ao,{onSelectionChange:t}):null}var fi=t=>({setNodes:t.setNodes,setEdges:t.setEdges,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset});function Ke(t,e){(0,y.useEffect)(()=>{t!==void 0&&e(t)},[t])}function Q(t,e,n){(0,y.useEffect)(()=>{e!==void 0&&n({[t]:e})},[e])}var pi=({nodes:t,edges:e,defaultNodes:n,defaultEdges:o,onConnect:i,onConnectStart:l,onConnectEnd:a,onClickConnectStart:d,onClickConnectEnd:s,nodesDraggable:c,nodesConnectable:u,nodesFocusable:r,edgesFocusable:g,edgesUpdatable:h,elevateNodesOnSelect:p,minZoom:m,maxZoom:v,nodeExtent:x,onNodesChange:b,onEdgesChange:N,elementsSelectable:f,connectionMode:C,snapGrid:M,snapToGrid:O,translateExtent:D,connectOnClick:P,defaultEdgeOptions:E,fitView:w,fitViewOptions:_,onNodesDelete:k,onEdgesDelete:S,onNodeDrag:R,onNodeDragStart:z,onNodeDragStop:$,onSelectionDrag:F,onSelectionDragStart:j,onSelectionDragStop:T,noPanClassName:V,nodeOrigin:X,rfId:W,autoPanOnConnect:U,autoPanOnNodeDrag:I,onError:A,connectionRadius:B,isValidConnection:H,nodeDragThreshold:Z})=>{let{setNodes:G,setEdges:ee,setDefaultNodesAndEdges:ae,setMinZoom:ge,setMaxZoom:oe,setTranslateExtent:J,setNodeExtent:de,reset:te}=ne(fi,ue),K=le();return(0,y.useEffect)(()=>{let me=o==null?void 0:o.map(Me=>({...Me,...E}));return ae(n,me),()=>{te()}},[]),Q("defaultEdgeOptions",E,K.setState),Q("connectionMode",C,K.setState),Q("onConnect",i,K.setState),Q("onConnectStart",l,K.setState),Q("onConnectEnd",a,K.setState),Q("onClickConnectStart",d,K.setState),Q("onClickConnectEnd",s,K.setState),Q("nodesDraggable",c,K.setState),Q("nodesConnectable",u,K.setState),Q("nodesFocusable",r,K.setState),Q("edgesFocusable",g,K.setState),Q("edgesUpdatable",h,K.setState),Q("elementsSelectable",f,K.setState),Q("elevateNodesOnSelect",p,K.setState),Q("snapToGrid",O,K.setState),Q("snapGrid",M,K.setState),Q("onNodesChange",b,K.setState),Q("onEdgesChange",N,K.setState),Q("connectOnClick",P,K.setState),Q("fitViewOnInit",w,K.setState),Q("fitViewOnInitOptions",_,K.setState),Q("onNodesDelete",k,K.setState),Q("onEdgesDelete",S,K.setState),Q("onNodeDrag",R,K.setState),Q("onNodeDragStart",z,K.setState),Q("onNodeDragStop",$,K.setState),Q("onSelectionDrag",F,K.setState),Q("onSelectionDragStart",j,K.setState),Q("onSelectionDragStop",T,K.setState),Q("noPanClassName",V,K.setState),Q("nodeOrigin",X,K.setState),Q("rfId",W,K.setState),Q("autoPanOnConnect",U,K.setState),Q("autoPanOnNodeDrag",I,K.setState),Q("onError",A,K.setState),Q("connectionRadius",B,K.setState),Q("isValidConnection",H,K.setState),Q("nodeDragThreshold",Z,K.setState),Ke(t,G),Ke(e,ee),Ke(m,ge),Ke(v,oe),Ke(D,J),Ke(x,de),null},io={display:"none"},yi={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},so="react-flow__node-desc",lo="react-flow__edge-desc",vi="react-flow__aria-live",bi=t=>t.ariaLiveMessage;function xi({rfId:t}){let e=ne(bi);return y.createElement("div",{id:`${vi}-${t}`,"aria-live":"assertive","aria-atomic":"true",style:yi},e)}function Ei({rfId:t,disableKeyboardA11y:e}){return y.createElement(y.Fragment,null,y.createElement("div",{id:`${so}-${t}`,style:io},"Press enter or space to select a node.",!e&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),y.createElement("div",{id:`${lo}-${t}`,style:io},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!e&&y.createElement(xi,{rfId:t}))}var st=(t=null,e={actInsideInputWithModifier:!0})=>{let[n,o]=(0,y.useState)(!1),i=(0,y.useRef)(!1),l=(0,y.useRef)(new Set([])),[a,d]=(0,y.useMemo)(()=>{if(t!==null){let s=(Array.isArray(t)?t:[t]).filter(c=>typeof c=="string").map(c=>c.split("+"));return[s,s.reduce((c,u)=>c.concat(...u),[])]}return[[],[]]},[t]);return(0,y.useEffect)(()=>{let s=typeof document<"u"?document:null,c=(e==null?void 0:e.target)||s;if(t!==null){let u=h=>{if(i.current=h.ctrlKey||h.metaKey||h.shiftKey,(!i.current||i.current&&!e.actInsideInputWithModifier)&&Vt(h))return!1;let p=uo(h.code,d);l.current.add(h[p]),co(a,l.current,!1)&&(h.preventDefault(),o(!0))},r=h=>{if((!i.current||i.current&&!e.actInsideInputWithModifier)&&Vt(h))return!1;let p=uo(h.code,d);co(a,l.current,!0)?(o(!1),l.current.clear()):l.current.delete(h[p]),h.key==="Meta"&&l.current.clear(),i.current=!1},g=()=>{l.current.clear(),o(!1)};return c==null||c.addEventListener("keydown",u),c==null||c.addEventListener("keyup",r),window.addEventListener("blur",g),()=>{c==null||c.removeEventListener("keydown",u),c==null||c.removeEventListener("keyup",r),window.removeEventListener("blur",g)}}},[t,o]),n};function co(t,e,n){return t.filter(o=>n||o.length===e.size).some(o=>o.every(i=>e.has(i)))}function uo(t,e){return e.includes(t)?"code":"key"}function ho(t,e,n,o){var d,s;let i=t.parentNode||t.parentId;if(!i)return n;let l=e.get(i),a=We(l,o);return ho(l,e,{x:(n.x??0)+a.x,y:(n.y??0)+a.y,z:(((d=l[re])==null?void 0:d.z)??0)>(n.z??0)?((s=l[re])==null?void 0:s.z)??0:n.z??0},o)}function go(t,e,n){t.forEach(o=>{var l;let i=o.parentNode||o.parentId;if(i&&!t.has(i))throw Error(`Parent node ${i} not found`);if(i||n!=null&&n[o.id]){let{x:a,y:d,z:s}=ho(o,t,{...o.position,z:((l=o[re])==null?void 0:l.z)??0},e);o.positionAbsolute={x:a,y:d},o[re].z=s,n!=null&&n[o.id]&&(o[re].isParent=!0)}})}function tn(t,e,n,o){let i=new Map,l={},a=o?1e3:0;return t.forEach(d=>{var h;let s=(pe(d.zIndex)?d.zIndex:0)+(d.selected?a:0),c=e.get(d.id),u={...d,positionAbsolute:{x:d.position.x,y:d.position.y}},r=d.parentNode||d.parentId;r&&(l[r]=!0);let g=(c==null?void 0:c.type)&&(c==null?void 0:c.type)!==d.type;Object.defineProperty(u,re,{enumerable:!1,value:{handleBounds:g||(h=c==null?void 0:c[re])==null?void 0:h.handleBounds,z:s}}),i.set(d.id,u)}),go(i,n,l),i}function mo(t,e={}){let{getNodes:n,width:o,height:i,minZoom:l,maxZoom:a,d3Zoom:d,d3Selection:s,fitViewOnInitDone:c,fitViewOnInit:u,nodeOrigin:r}=t(),g=e.initial&&!c&&u;if(d&&s&&(g||!e.initial)){let h=n().filter(m=>{var x;let v=e.includeHiddenNodes?m.width&&m.height:!m.hidden;return(x=e.nodes)!=null&&x.length?v&&e.nodes.some(b=>b.id===m.id):v}),p=h.every(m=>m.width&&m.height);if(h.length>0&&p){let{x:m,y:v,zoom:x}=Wn(Ut(h,r),o,i,e.minZoom??l,e.maxZoom??a,e.padding??.1),b=Fe.translate(m,v).scale(x);return typeof e.duration=="number"&&e.duration>0?d.transform(ze(s,e.duration),b):d.transform(s,b),!0}}return!1}function wi(t,e){return t.forEach(n=>{let o=e.get(n.id);o&&e.set(o.id,{...o,[re]:o[re],selected:n.selected})}),new Map(e)}function Si(t,e){return e.map(n=>{let o=t.find(i=>i.id===n.id);return o&&(n.selected=o.selected),n})}function Ct({changedNodes:t,changedEdges:e,get:n,set:o}){let{nodeInternals:i,edges:l,onNodesChange:a,onEdgesChange:d,hasDefaultNodes:s,hasDefaultEdges:c}=n();t!=null&&t.length&&(s&&o({nodeInternals:wi(t,i)}),a==null||a(t)),e!=null&&e.length&&(c&&o({edges:Si(e,l)}),d==null||d(e))}var Ge=()=>{},Ci={zoomIn:Ge,zoomOut:Ge,zoomTo:Ge,getZoom:()=>1,setViewport:Ge,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Ge,fitBounds:Ge,project:t=>t,screenToFlowPosition:t=>t,flowToScreenPosition:t=>t,viewportInitialized:!1},Ni=t=>({d3Zoom:t.d3Zoom,d3Selection:t.d3Selection}),ki=()=>{let t=le(),{d3Zoom:e,d3Selection:n}=ne(Ni,ue);return(0,y.useMemo)(()=>n&&e?{zoomIn:o=>e.scaleBy(ze(n,o==null?void 0:o.duration),1.2),zoomOut:o=>e.scaleBy(ze(n,o==null?void 0:o.duration),1/1.2),zoomTo:(o,i)=>e.scaleTo(ze(n,i==null?void 0:i.duration),o),getZoom:()=>t.getState().transform[2],setViewport:(o,i)=>{let[l,a,d]=t.getState().transform,s=Fe.translate(o.x??l,o.y??a).scale(o.zoom??d);e.transform(ze(n,i==null?void 0:i.duration),s)},getViewport:()=>{let[o,i,l]=t.getState().transform;return{x:o,y:i,zoom:l}},fitView:o=>mo(t.getState,o),setCenter:(o,i,l)=>{let{width:a,height:d,maxZoom:s}=t.getState(),c=(l==null?void 0:l.zoom)===void 0?s:l.zoom,u=a/2-o*c,r=d/2-i*c,g=Fe.translate(u,r).scale(c);e.transform(ze(n,l==null?void 0:l.duration),g)},fitBounds:(o,i)=>{let{width:l,height:a,minZoom:d,maxZoom:s}=t.getState(),{x:c,y:u,zoom:r}=Wn(o,l,a,d,s,(i==null?void 0:i.padding)??.1),g=Fe.translate(c,u).scale(r);e.transform(ze(n,i==null?void 0:i.duration),g)},project:o=>{let{transform:i,snapToGrid:l,snapGrid:a}=t.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Gt(o,i,l,a)},screenToFlowPosition:o=>{let{transform:i,snapToGrid:l,snapGrid:a,domNode:d}=t.getState();if(!d)return o;let{x:s,y:c}=d.getBoundingClientRect();return Gt({x:o.x-s,y:o.y-c},i,l,a)},flowToScreenPosition:o=>{let{transform:i,domNode:l}=t.getState();if(!l)return o;let{x:a,y:d}=l.getBoundingClientRect(),s=Fn(o,i);return{x:s.x+a,y:s.y+d}},viewportInitialized:!0}:Ci,[e,n])};function lt(){let t=ki(),e=le(),n=(0,y.useCallback)(()=>e.getState().getNodes().map(m=>({...m})),[]),o=(0,y.useCallback)(m=>e.getState().nodeInternals.get(m),[]),i=(0,y.useCallback)(()=>{let{edges:m=[]}=e.getState();return m.map(v=>({...v}))},[]),l=(0,y.useCallback)(m=>{let{edges:v=[]}=e.getState();return v.find(x=>x.id===m)},[]),a=(0,y.useCallback)(m=>{let{getNodes:v,setNodes:x,hasDefaultNodes:b,onNodesChange:N}=e.getState(),f=v(),C=typeof m=="function"?m(f):m;b?x(C):N&&N(C.length===0?f.map(M=>({type:"remove",id:M.id})):C.map(M=>({item:M,type:"reset"})))},[]),d=(0,y.useCallback)(m=>{let{edges:v=[],setEdges:x,hasDefaultEdges:b,onEdgesChange:N}=e.getState(),f=typeof m=="function"?m(v):m;b?x(f):N&&N(f.length===0?v.map(C=>({type:"remove",id:C.id})):f.map(C=>({item:C,type:"reset"})))},[]),s=(0,y.useCallback)(m=>{let v=Array.isArray(m)?m:[m],{getNodes:x,setNodes:b,hasDefaultNodes:N,onNodesChange:f}=e.getState();N?b([...x(),...v]):f&&f(v.map(C=>({item:C,type:"add"})))},[]),c=(0,y.useCallback)(m=>{let v=Array.isArray(m)?m:[m],{edges:x=[],setEdges:b,hasDefaultEdges:N,onEdgesChange:f}=e.getState();N?b([...x,...v]):f&&f(v.map(C=>({item:C,type:"add"})))},[]),u=(0,y.useCallback)(()=>{let{getNodes:m,edges:v=[],transform:x}=e.getState(),[b,N,f]=x;return{nodes:m().map(C=>({...C})),edges:v.map(C=>({...C})),viewport:{x:b,y:N,zoom:f}}},[]),r=(0,y.useCallback)(({nodes:m,edges:v})=>{let{nodeInternals:x,getNodes:b,edges:N,hasDefaultNodes:f,hasDefaultEdges:C,onNodesDelete:M,onEdgesDelete:O,onNodesChange:D,onEdgesChange:P}=e.getState(),E=(m||[]).map(R=>R.id),w=(v||[]).map(R=>R.id),_=b().reduce((R,z)=>{let $=z.parentNode||z.parentId,F=!E.includes(z.id)&&$&&R.find(j=>j.id===$);return(typeof z.deletable!="boolean"||z.deletable)&&(E.includes(z.id)||F)&&R.push(z),R},[]),k=N.filter(R=>typeof R.deletable=="boolean"?R.deletable:!0),S=k.filter(R=>w.includes(R.id));if(_||S){let R=Zn(_,k),z=[...S,...R],$=z.reduce((F,j)=>(F.includes(j.id)||F.push(j.id),F),[]);(C||f)&&(C&&e.setState({edges:N.filter(F=>!$.includes(F.id))}),f&&(_.forEach(F=>{x.delete(F.id)}),e.setState({nodeInternals:new Map(x)}))),$.length>0&&(O==null||O(z),P&&P($.map(F=>({id:F,type:"remove"})))),_.length>0&&(M==null||M(_),D&&D(_.map(F=>({id:F.id,type:"remove"}))))}},[]),g=(0,y.useCallback)(m=>{let v=Za(m),x=v?null:e.getState().nodeInternals.get(m.id);return!v&&!x?[null,null,v]:[v?m:jn(x),x,v]},[]),h=(0,y.useCallback)((m,v=!0,x)=>{let[b,N,f]=g(m);return b?(x||e.getState().getNodes()).filter(C=>{if(!f&&(C.id===N.id||!C.positionAbsolute))return!1;let M=Ht(jn(C),b);return v&&M>0||M>=b.width*b.height}):[]},[]),p=(0,y.useCallback)((m,v,x=!0)=>{let[b]=g(m);if(!b)return!1;let N=Ht(b,v);return x&&N>0||N>=b.width*b.height},[]);return(0,y.useMemo)(()=>({...t,getNodes:n,getNode:o,getEdges:i,getEdge:l,setNodes:a,setEdges:d,addNodes:s,addEdges:c,toObject:u,deleteElements:r,getIntersectingNodes:h,isNodeIntersecting:p}),[t,n,o,i,l,a,d,s,c,u,r,h,p])}var Mi={actInsideInputWithModifier:!1},_i=({deleteKeyCode:t,multiSelectionKeyCode:e})=>{let n=le(),{deleteElements:o}=lt(),i=st(t,Mi),l=st(e);(0,y.useEffect)(()=>{if(i){let{edges:a,getNodes:d}=n.getState();o({nodes:d().filter(s=>s.selected),edges:a.filter(s=>s.selected)}),n.setState({nodesSelectionActive:!1})}},[i]),(0,y.useEffect)(()=>{n.setState({multiSelectionActive:l})},[l])};function Oi(t){let e=le();(0,y.useEffect)(()=>{let n,o=()=>{var l,a;if(!t.current)return;let i=Lt(t.current);(i.height===0||i.width===0)&&((a=(l=e.getState()).onError)==null||a.call(l,"004",xe.error004())),e.setState({width:i.width||500,height:i.height||500})};return o(),window.addEventListener("resize",o),t.current&&(n=new ResizeObserver(()=>o()),n.observe(t.current)),()=>{window.removeEventListener("resize",o),n&&t.current&&n.unobserve(t.current)}},[])}var nn={position:"absolute",width:"100%",height:"100%",top:0,left:0},Pi=(t,e)=>t.x!==e.x||t.y!==e.y||t.zoom!==e.k,Nt=t=>({x:t.x,y:t.y,zoom:t.k}),Ue=(t,e)=>t.target.closest(`.${e}`),fo=(t,e)=>e===2&&Array.isArray(t)&&t.includes(2),po=t=>{let e=t.ctrlKey&&vt()?10:1;return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*e},Di=t=>({d3Zoom:t.d3Zoom,d3Selection:t.d3Selection,d3ZoomHandler:t.d3ZoomHandler,userSelectionActive:t.userSelectionActive}),Ii=({onMove:t,onMoveStart:e,onMoveEnd:n,onPaneContextMenu:o,zoomOnScroll:i=!0,zoomOnPinch:l=!0,panOnScroll:a=!1,panOnScrollSpeed:d=.5,panOnScrollMode:s=Ae.Free,zoomOnDoubleClick:c=!0,elementsSelectable:u,panOnDrag:r=!0,defaultViewport:g,translateExtent:h,minZoom:p,maxZoom:m,zoomActivationKeyCode:v,preventScrolling:x=!0,children:b,noWheelClassName:N,noPanClassName:f})=>{let C=(0,y.useRef)(),M=le(),O=(0,y.useRef)(!1),D=(0,y.useRef)(!1),P=(0,y.useRef)(null),E=(0,y.useRef)({x:0,y:0,zoom:0}),{d3Zoom:w,d3Selection:_,d3ZoomHandler:k,userSelectionActive:S}=ne(Di,ue),R=st(v),z=(0,y.useRef)(0),$=(0,y.useRef)(!1),F=(0,y.useRef)();return Oi(P),(0,y.useEffect)(()=>{if(P.current){let j=P.current.getBoundingClientRect(),T=Sa().scaleExtent([p,m]).translateExtent(h),V=mt(P.current).call(T),X=Fe.translate(g.x,g.y).scale(Ye(g.zoom,p,m)),W=[[0,0],[j.width,j.height]],U=T.constrain()(X,W,h);T.transform(V,U),T.wheelDelta(po),M.setState({d3Zoom:T,d3Selection:V,d3ZoomHandler:V.on("wheel.zoom"),transform:[U.x,U.y,U.k],domNode:P.current.closest(".react-flow")})}},[]),(0,y.useEffect)(()=>{_&&w&&(a&&!R&&!S?_.on("wheel.zoom",j=>{if(Ue(j,N))return!1;j.preventDefault(),j.stopImmediatePropagation();let T=_.property("__zoom").k||1;if(j.ctrlKey&&l){let H=Bt(j),Z=T*2**po(j);w.scaleTo(_,Z,H,j);return}let V=j.deltaMode===1?20:1,X=s===Ae.Vertical?0:j.deltaX*V,W=s===Ae.Horizontal?0:j.deltaY*V;!vt()&&j.shiftKey&&s!==Ae.Vertical&&(X=j.deltaY*V,W=0),w.translateBy(_,-(X/T)*d,-(W/T)*d,{internal:!0});let U=Nt(_.property("__zoom")),{onViewportChangeStart:I,onViewportChange:A,onViewportChangeEnd:B}=M.getState();clearTimeout(F.current),$.current||($.current=!0,e==null||e(j,U),I==null||I(U)),$.current&&(t==null||t(j,U),A==null||A(U),F.current=setTimeout(()=>{n==null||n(j,U),B==null||B(U),$.current=!1},150))},{passive:!1}):k!==void 0&&_.on("wheel.zoom",function(j,T){if(!x&&j.type==="wheel"&&!j.ctrlKey||Ue(j,N))return null;j.preventDefault(),k.call(this,j,T)},{passive:!1}))},[S,a,s,_,w,k,R,l,x,N,e,t,n]),(0,y.useEffect)(()=>{w&&w.on("start",j=>{var X,W;if(!j.sourceEvent||j.sourceEvent.internal)return null;z.current=(X=j.sourceEvent)==null?void 0:X.button;let{onViewportChangeStart:T}=M.getState(),V=Nt(j.transform);O.current=!0,E.current=V,((W=j.sourceEvent)==null?void 0:W.type)==="mousedown"&&M.setState({paneDragging:!0}),T==null||T(V),e==null||e(j.sourceEvent,V)})},[w,e]),(0,y.useEffect)(()=>{w&&(S&&!O.current?w.on("zoom",null):S||w.on("zoom",j=>{var V;let{onViewportChange:T}=M.getState();if(M.setState({transform:[j.transform.x,j.transform.y,j.transform.k]}),D.current=!!(o&&fo(r,z.current??0)),(t||T)&&!((V=j.sourceEvent)!=null&&V.internal)){let X=Nt(j.transform);T==null||T(X),t==null||t(j.sourceEvent,X)}}))},[S,w,t,r,o]),(0,y.useEffect)(()=>{w&&w.on("end",j=>{if(!j.sourceEvent||j.sourceEvent.internal)return null;let{onViewportChangeEnd:T}=M.getState();if(O.current=!1,M.setState({paneDragging:!1}),o&&fo(r,z.current??0)&&!D.current&&o(j.sourceEvent),D.current=!1,(n||T)&&Pi(E.current,j.transform)){let V=Nt(j.transform);E.current=V,clearTimeout(C.current),C.current=setTimeout(()=>{T==null||T(V),n==null||n(j.sourceEvent,V)},a?150:0)}})},[w,a,r,n,o]),(0,y.useEffect)(()=>{w&&w.filter(j=>{let T=R||i,V=l&&j.ctrlKey;if((r===!0||Array.isArray(r)&&r.includes(1))&&j.button===1&&j.type==="mousedown"&&(Ue(j,"react-flow__node")||Ue(j,"react-flow__edge")))return!0;if(!r&&!T&&!a&&!c&&!l||S||!c&&j.type==="dblclick"||Ue(j,N)&&j.type==="wheel"||Ue(j,f)&&(j.type!=="wheel"||a&&j.type==="wheel"&&!R)||!l&&j.ctrlKey&&j.type==="wheel"||!T&&!a&&!V&&j.type==="wheel"||!r&&(j.type==="mousedown"||j.type==="touchstart")||Array.isArray(r)&&!r.includes(j.button)&&j.type==="mousedown")return!1;let X=Array.isArray(r)&&r.includes(j.button)||!j.button||j.button<=1;return(!j.ctrlKey||j.type==="wheel")&&X})},[S,w,i,l,a,c,r,u,R]),y.createElement("div",{className:"react-flow__renderer",ref:P,style:nn},b)},ji=t=>({userSelectionActive:t.userSelectionActive,userSelectionRect:t.userSelectionRect});function Ri(){let{userSelectionActive:t,userSelectionRect:e}=ne(ji,ue);return t&&e?y.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:e.width,height:e.height,transform:`translate(${e.x}px, ${e.y}px)`}}):null}function yo(t,e){let n=e.parentNode||e.parentId,o=t.find(i=>i.id===n);if(o){let i=e.position.x+e.width-o.width,l=e.position.y+e.height-o.height;if(i>0||l>0||e.position.x<0||e.position.y<0){if(o.style={...o.style},o.style.width=o.style.width??o.width,o.style.height=o.style.height??o.height,i>0&&(o.style.width+=i),l>0&&(o.style.height+=l),e.position.x<0){let a=Math.abs(e.position.x);o.position.x=o.position.x-a,o.style.width+=a,e.position.x=0}if(e.position.y<0){let a=Math.abs(e.position.y);o.position.y=o.position.y-a,o.style.height+=a,e.position.y=0}o.width=o.style.width,o.height=o.style.height}}}function vo(t,e){if(t.some(o=>o.type==="reset"))return t.filter(o=>o.type==="reset").map(o=>o.item);let n=t.filter(o=>o.type==="add").map(o=>o.item);return e.reduce((o,i)=>{let l=t.filter(d=>d.id===i.id);if(l.length===0)return o.push(i),o;let a={...i};for(let d of l)if(d)switch(d.type){case"select":a.selected=d.selected;break;case"position":d.position!==void 0&&(a.position=d.position),d.positionAbsolute!==void 0&&(a.positionAbsolute=d.positionAbsolute),d.dragging!==void 0&&(a.dragging=d.dragging),a.expandParent&&yo(o,a);break;case"dimensions":d.dimensions!==void 0&&(a.width=d.dimensions.width,a.height=d.dimensions.height),d.updateStyle!==void 0&&(a.style={...a.style||{},...d.dimensions}),typeof d.resizing=="boolean"&&(a.resizing=d.resizing),a.expandParent&&yo(o,a);break;case"remove":return o}return o.push(a),o},n)}function bo(t,e){return vo(t,e)}function Ai(t,e){return vo(t,e)}var Ne=(t,e)=>({id:t,type:"select",selected:e});function qe(t,e){return t.reduce((n,o)=>{let i=e.includes(o.id);return!o.selected&&i?(o.selected=!0,n.push(Ne(o.id,!0))):o.selected&&!i&&(o.selected=!1,n.push(Ne(o.id,!1))),n},[])}var on=(t,e)=>n=>{n.target===e.current&&(t==null||t(n))},Bi=t=>({userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable,dragging:t.paneDragging}),xo=(0,y.memo)(({isSelecting:t,selectionMode:e=bt.Full,panOnDrag:n,onSelectionStart:o,onSelectionEnd:i,onPaneClick:l,onPaneContextMenu:a,onPaneScroll:d,onPaneMouseEnter:s,onPaneMouseMove:c,onPaneMouseLeave:u,children:r})=>{let g=(0,y.useRef)(null),h=le(),p=(0,y.useRef)(0),m=(0,y.useRef)(0),v=(0,y.useRef)(),{userSelectionActive:x,elementsSelectable:b,dragging:N}=ne(Bi,ue),f=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),p.current=0,m.current=0},C=k=>{l==null||l(k),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},M=k=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){k.preventDefault();return}a==null||a(k)},O=d?k=>d(k):void 0,D=k=>{let{resetSelectedElements:S,domNode:R}=h.getState();if(v.current=R==null?void 0:R.getBoundingClientRect(),!b||!t||k.button!==0||k.target!==g.current||!v.current)return;let{x:z,y:$}=Se(k,v.current);S(),h.setState({userSelectionRect:{width:0,height:0,startX:z,startY:$,x:z,y:$}}),o==null||o(k)},P=k=>{let{userSelectionRect:S,nodeInternals:R,edges:z,transform:$,onNodesChange:F,onEdgesChange:j,nodeOrigin:T,getNodes:V}=h.getState();if(!t||!v.current||!S)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});let X=Se(k,v.current),W=S.startX??0,U=S.startY??0,I={...S,x:X.x<W?X.x:W,y:X.y<U?X.y:U,width:Math.abs(X.x-W),height:Math.abs(X.y-U)},A=V(),B=Yn(R,I,$,e===bt.Partial,!0,T),H=Zn(B,z).map(G=>G.id),Z=B.map(G=>G.id);if(p.current!==Z.length){p.current=Z.length;let G=qe(A,Z);G.length&&(F==null||F(G))}if(m.current!==H.length){m.current=H.length;let G=qe(z,H);G.length&&(j==null||j(G))}h.setState({userSelectionRect:I})},E=k=>{if(k.button!==0)return;let{userSelectionRect:S}=h.getState();!x&&S&&k.target===g.current&&(C==null||C(k)),h.setState({nodesSelectionActive:p.current>0}),f(),i==null||i(k)},w=k=>{x&&(h.setState({nodesSelectionActive:p.current>0}),i==null||i(k)),f()},_=b&&(t||x);return y.createElement("div",{className:he(["react-flow__pane",{dragging:N,selection:t}]),onClick:_?void 0:on(C,g),onContextMenu:on(M,g),onWheel:on(O,g),onMouseEnter:_?void 0:s,onMouseDown:_?D:void 0,onMouseMove:_?P:c,onMouseUp:_?E:void 0,onMouseLeave:_?w:u,ref:g,style:nn},r,y.createElement(Ri,null))});xo.displayName="Pane";function Eo(t,e){let n=t.parentNode||t.parentId;if(!n)return!1;let o=e.get(n);return o?o.selected?!0:Eo(o,e):!1}function wo(t,e,n){let o=t;do{if(o!=null&&o.matches(e))return!0;if(o===n.current)return!1;o=o.parentElement}while(o);return!1}function zi(t,e,n,o){return Array.from(t.values()).filter(i=>(i.selected||i.id===o)&&(!i.parentNode||i.parentId||!Eo(i,t))&&(i.draggable||e&&i.draggable===void 0)).map(i=>{var l,a;return{id:i.id,position:i.position||{x:0,y:0},positionAbsolute:i.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((l=i.positionAbsolute)==null?void 0:l.x)??0),y:n.y-(((a=i.positionAbsolute)==null?void 0:a.y)??0)},delta:{x:0,y:0},extent:i.extent,parentNode:i.parentNode||i.parentId,parentId:i.parentNode||i.parentId,width:i.width,height:i.height,expandParent:i.expandParent}})}function Li(t,e){return!e||e==="parent"?e:[e[0],[e[1][0]-(t.width||0),e[1][1]-(t.height||0)]]}function So(t,e,n,o,i=[0,0],l){let a=Li(t,t.extent||o),d=a,s=t.parentNode||t.parentId;if(t.extent==="parent"&&!t.expandParent)if(s&&t.width&&t.height){let r=n.get(s),{x:g,y:h}=We(r,i).positionAbsolute;d=r&&pe(g)&&pe(h)&&pe(r.width)&&pe(r.height)?[[g+t.width*i[0],h+t.height*i[1]],[g+r.width-t.width+t.width*i[0],h+r.height-t.height+t.height*i[1]]]:d}else l==null||l("005",xe.error005()),d=a;else if(t.extent&&s&&t.extent!=="parent"){let{x:r,y:g}=We(n.get(s),i).positionAbsolute;d=[[t.extent[0][0]+r,t.extent[0][1]+g],[t.extent[1][0]+r,t.extent[1][1]+g]]}let c={x:0,y:0};s&&(c=We(n.get(s),i).positionAbsolute);let u=d&&d!=="parent"?$t(e,d):e;return{position:{x:u.x-c.x,y:u.y-c.y},positionAbsolute:u}}function rn({nodeId:t,dragItems:e,nodeInternals:n}){let o=e.map(i=>({...n.get(i.id),position:i.position,positionAbsolute:i.positionAbsolute}));return[t?o.find(i=>i.id===t):o[0],o]}var Co=(t,e,n,o)=>{let i=e.querySelectorAll(t);if(!i||!i.length)return null;let l=Array.from(i),a=e.getBoundingClientRect(),d={x:a.width*o[0],y:a.height*o[1]};return l.map(s=>{let c=s.getBoundingClientRect();return{id:s.getAttribute("data-handleid"),position:s.getAttribute("data-handlepos"),x:(c.left-a.left-d.x)/n,y:(c.top-a.top-d.y)/n,...Lt(s)}})};function dt(t,e,n){return n===void 0?n:o=>{let i=e().nodeInternals.get(t);i&&n(o,{...i})}}function an({id:t,store:e,unselect:n=!1,nodeRef:o}){let{addSelectedNodes:i,unselectNodesAndEdges:l,multiSelectionActive:a,nodeInternals:d,onError:s}=e.getState(),c=d.get(t);if(!c){s==null||s("012",xe.error012(t));return}e.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&a)&&(l({nodes:[c],edges:[]}),requestAnimationFrame(()=>{var u;return(u=o==null?void 0:o.current)==null?void 0:u.blur()})):i([t])}function $i(){let t=le();return(0,y.useCallback)(({sourceEvent:e})=>{let{transform:n,snapGrid:o,snapToGrid:i}=t.getState(),l=e.touches?e.touches[0].clientX:e.clientX,a=e.touches?e.touches[0].clientY:e.clientY,d={x:(l-n[0])/n[2],y:(a-n[1])/n[2]};return{xSnapped:i?o[0]*Math.round(d.x/o[0]):d.x,ySnapped:i?o[1]*Math.round(d.y/o[1]):d.y,...d}},[])}function sn(t){return(e,n,o)=>t==null?void 0:t(e,o)}function No({nodeRef:t,disabled:e=!1,noDragClassName:n,handleSelector:o,nodeId:i,isSelectable:l,selectNodesOnDrag:a}){let d=le(),[s,c]=(0,y.useState)(!1),u=(0,y.useRef)([]),r=(0,y.useRef)({x:null,y:null}),g=(0,y.useRef)(0),h=(0,y.useRef)(null),p=(0,y.useRef)({x:0,y:0}),m=(0,y.useRef)(null),v=(0,y.useRef)(!1),x=(0,y.useRef)(!1),b=(0,y.useRef)(!1),N=$i();return(0,y.useEffect)(()=>{if(t!=null&&t.current){let f=mt(t.current),C=({x:D,y:P})=>{let{nodeInternals:E,onNodeDrag:w,onSelectionDrag:_,updateNodePositions:k,nodeExtent:S,snapGrid:R,snapToGrid:z,nodeOrigin:$,onError:F}=d.getState();r.current={x:D,y:P};let j=!1,T={x:0,y:0,x2:0,y2:0};if(u.current.length>1&&S&&(T=Tt(Ut(u.current,$))),u.current=u.current.map(X=>{let W={x:D-X.distance.x,y:P-X.distance.y};z&&(W.x=R[0]*Math.round(W.x/R[0]),W.y=R[1]*Math.round(W.y/R[1]));let U=[[S[0][0],S[0][1]],[S[1][0],S[1][1]]];u.current.length>1&&S&&!X.extent&&(U[0][0]=X.positionAbsolute.x-T.x+S[0][0],U[1][0]=X.positionAbsolute.x+(X.width??0)-T.x2+S[1][0],U[0][1]=X.positionAbsolute.y-T.y+S[0][1],U[1][1]=X.positionAbsolute.y+(X.height??0)-T.y2+S[1][1]);let I=So(X,W,E,U,$,F);return j=j||X.position.x!==I.position.x||X.position.y!==I.position.y,X.position=I.position,X.positionAbsolute=I.positionAbsolute,X}),!j)return;k(u.current,!0,!0),c(!0);let V=i?w:sn(_);if(V&&m.current){let[X,W]=rn({nodeId:i,dragItems:u.current,nodeInternals:E});V(m.current,X,W)}},M=()=>{if(!h.current)return;let[D,P]=Dn(p.current,h.current);if(D!==0||P!==0){let{transform:E,panBy:w}=d.getState();r.current.x=(r.current.x??0)-D/E[2],r.current.y=(r.current.y??0)-P/E[2],w({x:D,y:P})&&C(r.current)}g.current=requestAnimationFrame(M)},O=D=>{var $;let{nodeInternals:P,multiSelectionActive:E,nodesDraggable:w,unselectNodesAndEdges:_,onNodeDragStart:k,onSelectionDragStart:S}=d.getState();x.current=!0;let R=i?k:sn(S);(!a||!l)&&!E&&i&&(($=P.get(i))!=null&&$.selected||_()),i&&l&&a&&an({id:i,store:d,nodeRef:t});let z=N(D);if(r.current=z,u.current=zi(P,w,z,i),R&&u.current){let[F,j]=rn({nodeId:i,dragItems:u.current,nodeInternals:P});R(D.sourceEvent,F,j)}};if(e)f.on(".drag",null);else{let D=$a().on("start",P=>{let{domNode:E,nodeDragThreshold:w}=d.getState();w===0&&O(P),b.current=!1,r.current=N(P),h.current=(E==null?void 0:E.getBoundingClientRect())||null,p.current=Se(P.sourceEvent,h.current)}).on("drag",P=>{var k,S;let E=N(P),{autoPanOnNodeDrag:w,nodeDragThreshold:_}=d.getState();if(P.sourceEvent.type==="touchmove"&&P.sourceEvent.touches.length>1&&(b.current=!0),!b.current){if(!v.current&&x.current&&w&&(v.current=!0,M()),!x.current){let R=E.xSnapped-(((k=r==null?void 0:r.current)==null?void 0:k.x)??0),z=E.ySnapped-(((S=r==null?void 0:r.current)==null?void 0:S.y)??0);Math.sqrt(R*R+z*z)>_&&O(P)}(r.current.x!==E.xSnapped||r.current.y!==E.ySnapped)&&u.current&&x.current&&(m.current=P.sourceEvent,p.current=Se(P.sourceEvent,h.current),C(E))}}).on("end",P=>{if(!(!x.current||b.current)&&(c(!1),v.current=!1,x.current=!1,cancelAnimationFrame(g.current),u.current)){let{updateNodePositions:E,nodeInternals:w,onNodeDragStop:_,onSelectionDragStop:k}=d.getState(),S=i?_:sn(k);if(E(u.current,!1,!1),S){let[R,z]=rn({nodeId:i,dragItems:u.current,nodeInternals:w});S(P.sourceEvent,R,z)}}}).filter(P=>{let E=P.target;return!P.button&&(!n||!wo(E,`.${n}`,t))&&(!o||wo(E,o,t))});return f.call(D),()=>{f.on(".drag",null)}}}},[t,e,n,o,l,d,i,a,N]),s}function ko(){let t=le();return(0,y.useCallback)(e=>{let{nodeInternals:n,nodeExtent:o,updateNodePositions:i,getNodes:l,snapToGrid:a,snapGrid:d,onError:s,nodesDraggable:c}=t.getState(),u=l().filter(v=>v.selected&&(v.draggable||c&&v.draggable===void 0)),r=a?d[0]:5,g=a?d[1]:5,h=e.isShiftPressed?4:1,p=e.x*r*h,m=e.y*g*h;i(u.map(v=>{if(v.positionAbsolute){let x={x:v.positionAbsolute.x+p,y:v.positionAbsolute.y+m};a&&(x.x=d[0]*Math.round(x.x/d[0]),x.y=d[1]*Math.round(x.y/d[1]));let{positionAbsolute:b,position:N}=So(v,x,n,o,void 0,s);v.position=N,v.positionAbsolute=b}return v}),!0,!1)},[])}var Qe={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},ct=t=>{let e=({id:n,type:o,data:i,xPos:l,yPos:a,xPosOrigin:d,yPosOrigin:s,selected:c,onClick:u,onMouseEnter:r,onMouseMove:g,onMouseLeave:h,onContextMenu:p,onDoubleClick:m,style:v,className:x,isDraggable:b,isSelectable:N,isConnectable:f,isFocusable:C,selectNodesOnDrag:M,sourcePosition:O,targetPosition:D,hidden:P,resizeObserver:E,dragHandle:w,zIndex:_,isParent:k,noDragClassName:S,noPanClassName:R,initialized:z,disableKeyboardA11y:$,ariaLabel:F,rfId:j,hasHandleBounds:T})=>{let V=le(),X=(0,y.useRef)(null),W=(0,y.useRef)(null),U=(0,y.useRef)(O),I=(0,y.useRef)(D),A=(0,y.useRef)(o),B=N||b||u||r||g||h,H=ko(),Z=dt(n,V.getState,r),G=dt(n,V.getState,g),ee=dt(n,V.getState,h),ae=dt(n,V.getState,p),ge=dt(n,V.getState,m),oe=te=>{let{nodeDragThreshold:K}=V.getState();if(N&&(!M||!b||K>0)&&an({id:n,store:V,nodeRef:X}),u){let me=V.getState().nodeInternals.get(n);me&&u(te,{...me})}},J=te=>{Vt(te)||$||(Rn.includes(te.key)&&N?an({id:n,store:V,unselect:te.key==="Escape",nodeRef:X}):b&&c&&Object.prototype.hasOwnProperty.call(Qe,te.key)&&(V.setState({ariaLiveMessage:`Moved selected node ${te.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~l}, y: ${~~a}`}),H({x:Qe[te.key].x,y:Qe[te.key].y,isShiftPressed:te.shiftKey})))};(0,y.useEffect)(()=>()=>{W.current&&(W.current=(E==null||E.unobserve(W.current),null))},[]),(0,y.useEffect)(()=>{if(X.current&&!P){let te=X.current;(!z||!T||W.current!==te)&&(W.current&&(E==null||E.unobserve(W.current)),E==null||E.observe(te),W.current=te)}},[P,z,T]),(0,y.useEffect)(()=>{let te=A.current!==o,K=U.current!==O,me=I.current!==D;X.current&&(te||K||me)&&(te&&(A.current=o),K&&(U.current=O),me&&(I.current=D),V.getState().updateNodeDimensions([{id:n,nodeElement:X.current,forceUpdate:!0}]))},[n,o,O,D]);let de=No({nodeRef:X,disabled:P||!b,noDragClassName:S,handleSelector:w,nodeId:n,isSelectable:N,selectNodesOnDrag:M});return P?null:y.createElement("div",{className:he(["react-flow__node",`react-flow__node-${o}`,{[R]:b},x,{selected:c,selectable:N,parent:k,dragging:de}]),ref:X,style:{zIndex:_,transform:`translate(${d}px,${s}px)`,pointerEvents:B?"all":"none",visibility:z?"visible":"hidden",...v},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:Z,onMouseMove:G,onMouseLeave:ee,onContextMenu:ae,onClick:oe,onDoubleClick:ge,onKeyDown:C?J:void 0,tabIndex:C?0:void 0,role:C?"button":void 0,"aria-describedby":$?void 0:`${so}-${j}`,"aria-label":F},y.createElement(Ja,{value:n},y.createElement(t,{id:n,data:i,type:o,xPos:l,yPos:a,selected:c,isConnectable:f,sourcePosition:O,targetPosition:D,dragging:de,dragHandle:w,zIndex:_})))};return e.displayName="NodeWrapper",(0,y.memo)(e)},Ti=t=>({...Ut(t.getNodes().filter(e=>e.selected),t.nodeOrigin),transformString:`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`,userSelectionActive:t.userSelectionActive});function Hi({onSelectionContextMenu:t,noPanClassName:e,disableKeyboardA11y:n}){let o=le(),{width:i,height:l,x:a,y:d,transformString:s,userSelectionActive:c}=ne(Ti,ue),u=ko(),r=(0,y.useRef)(null);if((0,y.useEffect)(()=>{var h;n||((h=r.current)==null||h.focus({preventScroll:!0}))},[n]),No({nodeRef:r}),c||!i||!l)return null;let g=t?h=>{t(h,o.getState().getNodes().filter(p=>p.selected))}:void 0;return y.createElement("div",{className:he(["react-flow__nodesselection","react-flow__container",e]),style:{transform:s}},y.createElement("div",{ref:r,className:"react-flow__nodesselection-rect",onContextMenu:g,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h=>{Object.prototype.hasOwnProperty.call(Qe,h.key)&&u({x:Qe[h.key].x,y:Qe[h.key].y,isShiftPressed:h.shiftKey})},style:{width:i,height:l,top:d,left:a}}))}var Vi=(0,y.memo)(Hi),Xi=t=>t.nodesSelectionActive,Mo=({children:t,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:i,onPaneContextMenu:l,onPaneScroll:a,deleteKeyCode:d,onMove:s,onMoveStart:c,onMoveEnd:u,selectionKeyCode:r,selectionOnDrag:g,selectionMode:h,onSelectionStart:p,onSelectionEnd:m,multiSelectionKeyCode:v,panActivationKeyCode:x,zoomActivationKeyCode:b,elementsSelectable:N,zoomOnScroll:f,zoomOnPinch:C,panOnScroll:M,panOnScrollSpeed:O,panOnScrollMode:D,zoomOnDoubleClick:P,panOnDrag:E,defaultViewport:w,translateExtent:_,minZoom:k,maxZoom:S,preventScrolling:R,onSelectionContextMenu:z,noWheelClassName:$,noPanClassName:F,disableKeyboardA11y:j})=>{let T=ne(Xi),V=st(r),X=st(x),W=X||E,U=X||M,I=V||g&&W!==!0;return _i({deleteKeyCode:d,multiSelectionKeyCode:v}),y.createElement(Ii,{onMove:s,onMoveStart:c,onMoveEnd:u,onPaneContextMenu:l,elementsSelectable:N,zoomOnScroll:f,zoomOnPinch:C,panOnScroll:U,panOnScrollSpeed:O,panOnScrollMode:D,zoomOnDoubleClick:P,panOnDrag:!V&&W,defaultViewport:w,translateExtent:_,minZoom:k,maxZoom:S,zoomActivationKeyCode:b,preventScrolling:R,noWheelClassName:$,noPanClassName:F},y.createElement(xo,{onSelectionStart:p,onSelectionEnd:m,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:i,onPaneContextMenu:l,onPaneScroll:a,panOnDrag:W,isSelecting:!!I,selectionMode:h},t,T&&y.createElement(Vi,{onSelectionContextMenu:z,noPanClassName:F,disableKeyboardA11y:j})))};Mo.displayName="FlowRenderer";var Fi=(0,y.memo)(Mo);function Yi(t){return ne((0,y.useCallback)(e=>t?Yn(e.nodeInternals,{x:0,y:0,width:e.width,height:e.height},e.transform,!0):e.getNodes(),[t]))}function Zi(t){let e={input:ct(t.input||no),default:ct(t.default||Jt),output:ct(t.output||ro),group:ct(t.group||en)},n=Object.keys(t).filter(o=>!["input","default","output","group"].includes(o)).reduce((o,i)=>(o[i]=ct(t[i]||Jt),o),{});return{...e,...n}}var Wi=({x:t,y:e,width:n,height:o,origin:i})=>!n||!o||i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:t,y:e}:{x:t-n*i[0],y:e-o*i[1]},Ki=t=>({nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,nodesFocusable:t.nodesFocusable,elementsSelectable:t.elementsSelectable,updateNodeDimensions:t.updateNodeDimensions,onError:t.onError}),_o=t=>{let{nodesDraggable:e,nodesConnectable:n,nodesFocusable:o,elementsSelectable:i,updateNodeDimensions:l,onError:a}=ne(Ki,ue),d=Yi(t.onlyRenderVisibleElements),s=(0,y.useRef)(),c=(0,y.useMemo)(()=>{if(typeof ResizeObserver>"u")return null;let u=new ResizeObserver(r=>{l(r.map(g=>({id:g.target.getAttribute("data-id"),nodeElement:g.target,forceUpdate:!0})))});return s.current=u,u},[]);return(0,y.useEffect)(()=>()=>{var u;(u=s==null?void 0:s.current)==null||u.disconnect()},[]),y.createElement("div",{className:"react-flow__nodes",style:nn},d.map(u=>{var C,M,O;let r=u.type||"default";t.nodeTypes[r]||(a==null||a("003",xe.error003(r)),r="default");let g=t.nodeTypes[r]||t.nodeTypes.default,h=!!(u.draggable||e&&u.draggable===void 0),p=!!(u.selectable||i&&u.selectable===void 0),m=!!(u.connectable||n&&u.connectable===void 0),v=!!(u.focusable||o&&u.focusable===void 0),x=t.nodeExtent?$t(u.positionAbsolute,t.nodeExtent):u.positionAbsolute,b=(x==null?void 0:x.x)??0,N=(x==null?void 0:x.y)??0,f=Wi({x:b,y:N,width:u.width??0,height:u.height??0,origin:t.nodeOrigin});return y.createElement(g,{key:u.id,id:u.id,className:u.className,style:u.style,type:r,data:u.data,sourcePosition:u.sourcePosition||Y.Bottom,targetPosition:u.targetPosition||Y.Top,hidden:u.hidden,xPos:b,yPos:N,xPosOrigin:f.x,yPosOrigin:f.y,selectNodesOnDrag:t.selectNodesOnDrag,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,selected:!!u.selected,isDraggable:h,isSelectable:p,isConnectable:m,isFocusable:v,resizeObserver:c,dragHandle:u.dragHandle,zIndex:((C=u[re])==null?void 0:C.z)??0,isParent:!!((M=u[re])!=null&&M.isParent),noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,initialized:!!u.width&&!!u.height,rfId:t.rfId,disableKeyboardA11y:t.disableKeyboardA11y,ariaLabel:u.ariaLabel,hasHandleBounds:!!((O=u[re])!=null&&O.handleBounds)})}))};_o.displayName="NodeRenderer";var Gi=(0,y.memo)(_o),Ui=(t,e,n)=>n===Y.Left?t-e:n===Y.Right?t+e:t,qi=(t,e,n)=>n===Y.Top?t-e:n===Y.Bottom?t+e:t,Oo="react-flow__edgeupdater",Po=({position:t,centerX:e,centerY:n,radius:o=10,onMouseDown:i,onMouseEnter:l,onMouseOut:a,type:d})=>y.createElement("circle",{onMouseDown:i,onMouseEnter:l,onMouseOut:a,className:he([Oo,`${Oo}-${d}`]),cx:Ui(e,o,t),cy:qi(n,o,t),r:o,stroke:"transparent",fill:"transparent"}),Qi=()=>!0,Je=t=>{let e=({id:n,className:o,type:i,data:l,onClick:a,onEdgeDoubleClick:d,selected:s,animated:c,label:u,labelStyle:r,labelShowBg:g,labelBgStyle:h,labelBgPadding:p,labelBgBorderRadius:m,style:v,source:x,target:b,sourceX:N,sourceY:f,targetX:C,targetY:M,sourcePosition:O,targetPosition:D,elementsSelectable:P,hidden:E,sourceHandleId:w,targetHandleId:_,onContextMenu:k,onMouseEnter:S,onMouseMove:R,onMouseLeave:z,reconnectRadius:$,onReconnect:F,onReconnectStart:j,onReconnectEnd:T,markerEnd:V,markerStart:X,rfId:W,ariaLabel:U,isFocusable:I,isReconnectable:A,pathOptions:B,interactionWidth:H,disableKeyboardA11y:Z})=>{let G=(0,y.useRef)(null),[ee,ae]=(0,y.useState)(!1),[ge,oe]=(0,y.useState)(!1),J=le(),de=(0,y.useMemo)(()=>`url('#${Kt(X,W)}')`,[X,W]),te=(0,y.useMemo)(()=>`url('#${Kt(V,W)}')`,[V,W]);if(E)return null;let K=ce=>{var we;let{edges:fe,addSelectedEdges:Pe,unselectNodesAndEdges:De,multiSelectionActive:Ie}=J.getState(),be=fe.find(nt=>nt.id===n);be&&(P&&(J.setState({nodesSelectionActive:!1}),be.selected&&Ie?(De({nodes:[],edges:[be]}),(we=G.current)==null||we.blur()):Pe([n])),a&&a(ce,be))},me=at(n,J.getState,d),Me=at(n,J.getState,k),tt=at(n,J.getState,S),Le=at(n,J.getState,R),$e=at(n,J.getState,z),Ee=(ce,fe)=>{if(ce.button!==0)return;let{edges:Pe,isValidConnection:De}=J.getState(),Ie=fe?b:x,be=(fe?_:w)||null,we=fe?"target":"source",nt=De||Qi,Pt=fe,ot=Pe.find(je=>je.id===n);oe(!0),j==null||j(ce,ot,we),qn({event:ce,handleId:be,nodeId:Ie,onConnect:je=>F==null?void 0:F(ot,je),isTarget:Pt,getState:J.getState,setState:J.setState,isValidConnection:nt,edgeUpdaterType:we,onReconnectEnd:je=>{oe(!1),T==null||T(je,ot,we)}})},Te=ce=>Ee(ce,!0),_e=ce=>Ee(ce,!1),Oe=()=>ae(!0),He=()=>ae(!1),Ve=!P&&!a;return y.createElement("g",{className:he(["react-flow__edge",`react-flow__edge-${i}`,o,{selected:s,animated:c,inactive:Ve,updating:ee}]),onClick:K,onDoubleClick:me,onContextMenu:Me,onMouseEnter:tt,onMouseMove:Le,onMouseLeave:$e,onKeyDown:I?ce=>{var fe;if(!Z&&Rn.includes(ce.key)&&P){let{unselectNodesAndEdges:Pe,addSelectedEdges:De,edges:Ie}=J.getState();ce.key==="Escape"?((fe=G.current)==null||fe.blur(),Pe({edges:[Ie.find(be=>be.id===n)]})):De([n])}}:void 0,tabIndex:I?0:void 0,role:I?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":U===null?void 0:U||`Edge from ${x} to ${b}`,"aria-describedby":I?`${lo}-${W}`:void 0,ref:G},!ge&&y.createElement(t,{id:n,source:x,target:b,selected:s,animated:c,label:u,labelStyle:r,labelShowBg:g,labelBgStyle:h,labelBgPadding:p,labelBgBorderRadius:m,data:l,style:v,sourceX:N,sourceY:f,targetX:C,targetY:M,sourcePosition:O,targetPosition:D,sourceHandleId:w,targetHandleId:_,markerStart:de,markerEnd:te,pathOptions:B,interactionWidth:H}),A&&y.createElement(y.Fragment,null,(A==="source"||A===!0)&&y.createElement(Po,{position:O,centerX:N,centerY:f,radius:$,onMouseDown:Te,onMouseEnter:Oe,onMouseOut:He,type:"source"}),(A==="target"||A===!0)&&y.createElement(Po,{position:D,centerX:C,centerY:M,radius:$,onMouseDown:_e,onMouseEnter:Oe,onMouseOut:He,type:"target"})))};return e.displayName="EdgeWrapper",(0,y.memo)(e)};function Ji(t){let e={default:Je(t.default||wt),straight:Je(t.bezier||Zt),step:Je(t.step||Yt),smoothstep:Je(t.step||xt),simplebezier:Je(t.simplebezier||Xt)},n=Object.keys(t).filter(o=>!["default","bezier"].includes(o)).reduce((o,i)=>(o[i]=Je(t[i]||wt),o),{});return{...e,...n}}function Do(t,e,n=null){let o=((n==null?void 0:n.x)||0)+e.x,i=((n==null?void 0:n.y)||0)+e.y,l=(n==null?void 0:n.width)||e.width,a=(n==null?void 0:n.height)||e.height;switch(t){case Y.Top:return{x:o+l/2,y:i};case Y.Right:return{x:o+l,y:i+a/2};case Y.Bottom:return{x:o+l/2,y:i+a};case Y.Left:return{x:o,y:i+a/2}}}function Io(t,e){return t?t.length===1||!e?t[0]:e&&t.find(n=>n.id===e)||null:null}var es=(t,e,n,o,i,l)=>{let a=Do(n,t,e),d=Do(l,o,i);return{sourceX:a.x,sourceY:a.y,targetX:d.x,targetY:d.y}};function ts({sourcePos:t,targetPos:e,sourceWidth:n,sourceHeight:o,targetWidth:i,targetHeight:l,width:a,height:d,transform:s}){let c={x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x+n,e.x+i),y2:Math.max(t.y+o,e.y+l)};c.x===c.x2&&(c.x2+=1),c.y===c.y2&&(c.y2+=1);let u=Tt({x:(0-s[0])/s[2],y:(0-s[1])/s[2],width:a/s[2],height:d/s[2]}),r=Math.max(0,Math.min(u.x2,c.x2)-Math.max(u.x,c.x)),g=Math.max(0,Math.min(u.y2,c.y2)-Math.max(u.y,c.y));return Math.ceil(r*g)>0}function jo(t){var o,i,l,a,d;let e=((o=t==null?void 0:t[re])==null?void 0:o.handleBounds)||null,n=e&&(t==null?void 0:t.width)&&(t==null?void 0:t.height)&&((i=t==null?void 0:t.positionAbsolute)==null?void 0:i.x)!==void 0&&((l=t==null?void 0:t.positionAbsolute)==null?void 0:l.y)!==void 0;return[{x:((a=t==null?void 0:t.positionAbsolute)==null?void 0:a.x)||0,y:((d=t==null?void 0:t.positionAbsolute)==null?void 0:d.y)||0,width:(t==null?void 0:t.width)||0,height:(t==null?void 0:t.height)||0},e,!!n]}var ns=[{level:0,isMaxLevel:!0,edges:[]}];function os(t,e,n=!1){let o=-1,i=t.reduce((a,d)=>{var u,r;let s=pe(d.zIndex),c=s?d.zIndex:0;if(n){let g=e.get(d.target),h=e.get(d.source),p=d.selected||(g==null?void 0:g.selected)||(h==null?void 0:h.selected),m=Math.max(((u=h==null?void 0:h[re])==null?void 0:u.z)||0,((r=g==null?void 0:g[re])==null?void 0:r.z)||0,1e3);c=(s?d.zIndex:0)+(p?m:0)}return a[c]?a[c].push(d):a[c]=[d],o=c>o?c:o,a},{}),l=Object.entries(i).map(([a,d])=>{let s=+a;return{edges:d,level:s,isMaxLevel:s===o}});return l.length===0?ns:l}function rs(t,e,n){return os(ne((0,y.useCallback)(o=>t?o.edges.filter(i=>{let l=e.get(i.source),a=e.get(i.target);return(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&ts({sourcePos:l.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:l.width,sourceHeight:l.height,targetWidth:a.width,targetHeight:a.height,width:o.width,height:o.height,transform:o.transform})}):o.edges,[t,e])),e,n)}var as=({color:t="none",strokeWidth:e=1})=>y.createElement("polyline",{style:{stroke:t,strokeWidth:e},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),is=({color:t="none",strokeWidth:e=1})=>y.createElement("polyline",{style:{stroke:t,fill:t,strokeWidth:e},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Ro={[it.Arrow]:as,[it.ArrowClosed]:is};function ss(t){let e=le();return(0,y.useMemo)(()=>{var n,o;return Object.prototype.hasOwnProperty.call(Ro,t)?Ro[t]:((o=(n=e.getState()).onError)==null||o.call(n,"009",xe.error009(t)),null)},[t])}var ls=({id:t,type:e,color:n,width:o=12.5,height:i=12.5,markerUnits:l="strokeWidth",strokeWidth:a,orient:d="auto-start-reverse"})=>{let s=ss(e);return s?y.createElement("marker",{className:"react-flow__arrowhead",id:t,markerWidth:`${o}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:l,orient:d,refX:"0",refY:"0"},y.createElement(s,{color:n,strokeWidth:a})):null},ds=({defaultColor:t,rfId:e})=>n=>{let o=[];return n.edges.reduce((i,l)=>([l.markerStart,l.markerEnd].forEach(a=>{if(a&&typeof a=="object"){let d=Kt(a,e);o.includes(d)||(i.push({id:d,color:a.color||t,...a}),o.push(d))}}),i),[]).sort((i,l)=>i.id.localeCompare(l.id))},Ao=({defaultColor:t,rfId:e})=>{let n=ne((0,y.useCallback)(ds({defaultColor:t,rfId:e}),[t,e]),(o,i)=>!(o.length!==i.length||o.some((l,a)=>l.id!==i[a].id)));return y.createElement("defs",null,n.map(o=>y.createElement(ls,{id:o.id,key:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient})))};Ao.displayName="MarkerDefinitions";var cs=(0,y.memo)(Ao),us=t=>({nodesConnectable:t.nodesConnectable,edgesFocusable:t.edgesFocusable,edgesUpdatable:t.edgesUpdatable,elementsSelectable:t.elementsSelectable,width:t.width,height:t.height,connectionMode:t.connectionMode,nodeInternals:t.nodeInternals,onError:t.onError}),Bo=({defaultMarkerColor:t,onlyRenderVisibleElements:e,elevateEdgesOnSelect:n,rfId:o,edgeTypes:i,noPanClassName:l,onEdgeContextMenu:a,onEdgeMouseEnter:d,onEdgeMouseMove:s,onEdgeMouseLeave:c,onEdgeClick:u,onEdgeDoubleClick:r,onReconnect:g,onReconnectStart:h,onReconnectEnd:p,reconnectRadius:m,children:v,disableKeyboardA11y:x})=>{let{edgesFocusable:b,edgesUpdatable:N,elementsSelectable:f,width:C,height:M,connectionMode:O,nodeInternals:D,onError:P}=ne(us,ue),E=rs(e,D,n);return C?y.createElement(y.Fragment,null,E.map(({level:w,edges:_,isMaxLevel:k})=>y.createElement("svg",{key:w,style:{zIndex:w},width:C,height:M,className:"react-flow__edges react-flow__container"},k&&y.createElement(cs,{defaultColor:t,rfId:o}),y.createElement("g",null,_.map(S=>{let[R,z,$]=jo(D.get(S.source)),[F,j,T]=jo(D.get(S.target));if(!$||!T)return null;let V=S.type||"default";i[V]||(P==null||P("011",xe.error011(V)),V="default");let X=i[V]||i.default,W=O===Ze.Strict?j.target:(j.target??[]).concat(j.source??[]),U=Io(z.source,S.sourceHandle),I=Io(W,S.targetHandle),A=(U==null?void 0:U.position)||Y.Bottom,B=(I==null?void 0:I.position)||Y.Top,H=!!(S.focusable||b&&S.focusable===void 0),Z=S.reconnectable||S.updatable,G=g!==void 0&&(Z||N&&Z===void 0);if(!U||!I)return P==null||P("008",xe.error008(U,S)),null;let{sourceX:ee,sourceY:ae,targetX:ge,targetY:oe}=es(R,U,A,F,I,B);return y.createElement(X,{key:S.id,id:S.id,className:he([S.className,l]),type:V,data:S.data,selected:!!S.selected,animated:!!S.animated,hidden:!!S.hidden,label:S.label,labelStyle:S.labelStyle,labelShowBg:S.labelShowBg,labelBgStyle:S.labelBgStyle,labelBgPadding:S.labelBgPadding,labelBgBorderRadius:S.labelBgBorderRadius,style:S.style,source:S.source,target:S.target,sourceHandleId:S.sourceHandle,targetHandleId:S.targetHandle,markerEnd:S.markerEnd,markerStart:S.markerStart,sourceX:ee,sourceY:ae,targetX:ge,targetY:oe,sourcePosition:A,targetPosition:B,elementsSelectable:f,onContextMenu:a,onMouseEnter:d,onMouseMove:s,onMouseLeave:c,onClick:u,onEdgeDoubleClick:r,onReconnect:g,onReconnectStart:h,onReconnectEnd:p,reconnectRadius:m,rfId:o,ariaLabel:S.ariaLabel,isFocusable:H,isReconnectable:G,pathOptions:"pathOptions"in S?S.pathOptions:void 0,interactionWidth:S.interactionWidth,disableKeyboardA11y:x})})))),v):null};Bo.displayName="EdgeRenderer";var hs=(0,y.memo)(Bo),gs=t=>`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`;function ms({children:t}){let e=ne(gs);return y.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:e}},t)}function fs(t){let e=lt(),n=(0,y.useRef)(!1);(0,y.useEffect)(()=>{!n.current&&e.viewportInitialized&&t&&(setTimeout(()=>t(e),1),n.current=!0)},[t,e.viewportInitialized])}var ps={[Y.Left]:Y.Right,[Y.Right]:Y.Left,[Y.Top]:Y.Bottom,[Y.Bottom]:Y.Top},zo=({nodeId:t,handleType:e,style:n,type:o=Be.Bezier,CustomComponent:i,connectionStatus:l})=>{var M,O,D;let{fromNode:a,handleId:d,toX:s,toY:c,connectionMode:u}=ne((0,y.useCallback)(P=>({fromNode:P.nodeInternals.get(t),handleId:P.connectionHandleId,toX:(P.connectionPosition.x-P.transform[0])/P.transform[2],toY:(P.connectionPosition.y-P.transform[1])/P.transform[2],connectionMode:P.connectionMode}),[t]),ue),r=(M=a==null?void 0:a[re])==null?void 0:M.handleBounds,g=r==null?void 0:r[e];if(u===Ze.Loose&&(g||(g=r==null?void 0:r[e==="source"?"target":"source"])),!a||!g)return null;let h=d?g.find(P=>P.id===d):g[0],p=h?h.x+h.width/2:(a.width??0)/2,m=h?h.y+h.height/2:a.height??0,v=(((O=a.positionAbsolute)==null?void 0:O.x)??0)+p,x=(((D=a.positionAbsolute)==null?void 0:D.y)??0)+m,b=h==null?void 0:h.position,N=b?ps[b]:null;if(!b||!N)return null;if(i)return y.createElement(i,{connectionLineType:o,connectionLineStyle:n,fromNode:a,fromHandle:h,fromX:v,fromY:x,toX:s,toY:c,fromPosition:b,toPosition:N,connectionStatus:l});let f="",C={sourceX:v,sourceY:x,sourcePosition:b,targetX:s,targetY:c,targetPosition:N};return o===Be.Bezier?[f]=Xn(C):o===Be.Step?[f]=Ft({...C,borderRadius:0}):o===Be.SmoothStep?[f]=Ft(C):o===Be.SimpleBezier?[f]=$n(C):f=`M${v},${x} ${s},${c}`,y.createElement("path",{d:f,fill:"none",className:"react-flow__connection-path",style:n})};zo.displayName="ConnectionLine";var ys=t=>({nodeId:t.connectionNodeId,handleType:t.connectionHandleType,nodesConnectable:t.nodesConnectable,connectionStatus:t.connectionStatus,width:t.width,height:t.height});function vs({containerStyle:t,style:e,type:n,component:o}){let{nodeId:i,handleType:l,nodesConnectable:a,width:d,height:s,connectionStatus:c}=ne(ys,ue);return i&&l&&d&&a?y.createElement("svg",{style:t,width:d,height:s,className:"react-flow__edges react-flow__connectionline react-flow__container"},y.createElement("g",{className:he(["react-flow__connection",c])},y.createElement(zo,{nodeId:i,handleType:l,style:e,type:n,CustomComponent:o,connectionStatus:c}))):null}function Lo(t,e){return(0,y.useRef)(null),le(),(0,y.useMemo)(()=>e(t),[t])}var $o=({nodeTypes:t,edgeTypes:e,onMove:n,onMoveStart:o,onMoveEnd:i,onInit:l,onNodeClick:a,onEdgeClick:d,onNodeDoubleClick:s,onEdgeDoubleClick:c,onNodeMouseEnter:u,onNodeMouseMove:r,onNodeMouseLeave:g,onNodeContextMenu:h,onSelectionContextMenu:p,onSelectionStart:m,onSelectionEnd:v,connectionLineType:x,connectionLineStyle:b,connectionLineComponent:N,connectionLineContainerStyle:f,selectionKeyCode:C,selectionOnDrag:M,selectionMode:O,multiSelectionKeyCode:D,panActivationKeyCode:P,zoomActivationKeyCode:E,deleteKeyCode:w,onlyRenderVisibleElements:_,elementsSelectable:k,selectNodesOnDrag:S,defaultViewport:R,translateExtent:z,minZoom:$,maxZoom:F,preventScrolling:j,defaultMarkerColor:T,zoomOnScroll:V,zoomOnPinch:X,panOnScroll:W,panOnScrollSpeed:U,panOnScrollMode:I,zoomOnDoubleClick:A,panOnDrag:B,onPaneClick:H,onPaneMouseEnter:Z,onPaneMouseMove:G,onPaneMouseLeave:ee,onPaneScroll:ae,onPaneContextMenu:ge,onEdgeContextMenu:oe,onEdgeMouseEnter:J,onEdgeMouseMove:de,onEdgeMouseLeave:te,onReconnect:K,onReconnectStart:me,onReconnectEnd:Me,reconnectRadius:tt,noDragClassName:Le,noWheelClassName:$e,noPanClassName:Ee,elevateEdgesOnSelect:Te,disableKeyboardA11y:_e,nodeOrigin:Oe,nodeExtent:He,rfId:Ve})=>{let ce=Lo(t,Zi),fe=Lo(e,Ji);return fs(l),y.createElement(Fi,{onPaneClick:H,onPaneMouseEnter:Z,onPaneMouseMove:G,onPaneMouseLeave:ee,onPaneContextMenu:ge,onPaneScroll:ae,deleteKeyCode:w,selectionKeyCode:C,selectionOnDrag:M,selectionMode:O,onSelectionStart:m,onSelectionEnd:v,multiSelectionKeyCode:D,panActivationKeyCode:P,zoomActivationKeyCode:E,elementsSelectable:k,onMove:n,onMoveStart:o,onMoveEnd:i,zoomOnScroll:V,zoomOnPinch:X,zoomOnDoubleClick:A,panOnScroll:W,panOnScrollSpeed:U,panOnScrollMode:I,panOnDrag:B,defaultViewport:R,translateExtent:z,minZoom:$,maxZoom:F,onSelectionContextMenu:p,preventScrolling:j,noDragClassName:Le,noWheelClassName:$e,noPanClassName:Ee,disableKeyboardA11y:_e},y.createElement(ms,null,y.createElement(hs,{edgeTypes:fe,onEdgeClick:d,onEdgeDoubleClick:c,onlyRenderVisibleElements:_,onEdgeContextMenu:oe,onEdgeMouseEnter:J,onEdgeMouseMove:de,onEdgeMouseLeave:te,onReconnect:K,onReconnectStart:me,onReconnectEnd:Me,reconnectRadius:tt,defaultMarkerColor:T,noPanClassName:Ee,elevateEdgesOnSelect:!!Te,disableKeyboardA11y:_e,rfId:Ve},y.createElement(vs,{style:b,type:x,component:N,containerStyle:f})),y.createElement("div",{className:"react-flow__edgelabel-renderer"}),y.createElement(Gi,{nodeTypes:ce,onNodeClick:a,onNodeDoubleClick:s,onNodeMouseEnter:u,onNodeMouseMove:r,onNodeMouseLeave:g,onNodeContextMenu:h,selectNodesOnDrag:S,onlyRenderVisibleElements:_,noPanClassName:Ee,noDragClassName:Le,disableKeyboardA11y:_e,nodeOrigin:Oe,nodeExtent:He,rfId:Ve})))};$o.displayName="GraphView";var bs=(0,y.memo)($o),ln=[[-1/0,-1/0],[1/0,1/0]],ke={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:ln,nodeExtent:ln,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Ze.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Wa,isValidConnection:void 0},xs=()=>Ra((t,e)=>({...ke,setNodes:n=>{let{nodeInternals:o,nodeOrigin:i,elevateNodesOnSelect:l}=e();t({nodeInternals:tn(n,o,i,l)})},getNodes:()=>Array.from(e().nodeInternals.values()),setEdges:n=>{let{defaultEdgeOptions:o={}}=e();t({edges:n.map(i=>({...o,...i}))})},setDefaultNodesAndEdges:(n,o)=>{let i=n!==void 0,l=o!==void 0;t({nodeInternals:i?tn(n,new Map,e().nodeOrigin,e().elevateNodesOnSelect):new Map,edges:l?o:[],hasDefaultNodes:i,hasDefaultEdges:l})},updateNodeDimensions:n=>{let{onNodesChange:o,nodeInternals:i,fitViewOnInit:l,fitViewOnInitDone:a,fitViewOnInitOptions:d,domNode:s,nodeOrigin:c}=e(),u=s==null?void 0:s.querySelector(".react-flow__viewport");if(!u)return;let r=window.getComputedStyle(u),{m22:g}=new window.DOMMatrixReadOnly(r.transform),h=n.reduce((m,v)=>{let x=i.get(v.id);if(x!=null&&x.hidden)i.set(x.id,{...x,[re]:{...x[re],handleBounds:void 0}});else if(x){let b=Lt(v.nodeElement);b.width&&b.height&&(x.width!==b.width||x.height!==b.height||v.forceUpdate)&&(i.set(x.id,{...x,[re]:{...x[re],handleBounds:{source:Co(".source",v.nodeElement,g,c),target:Co(".target",v.nodeElement,g,c)}},...b}),m.push({id:x.id,type:"dimensions",dimensions:b}))}return m},[]);go(i,c);let p=a||l&&!a&&mo(e,{initial:!0,...d});t({nodeInternals:new Map(i),fitViewOnInitDone:p}),(h==null?void 0:h.length)>0&&(o==null||o(h))},updateNodePositions:(n,o=!0,i=!1)=>{let{triggerNodeChanges:l}=e();l(n.map(a=>{let d={id:a.id,type:"position",dragging:i};return o&&(d.positionAbsolute=a.positionAbsolute,d.position=a.position),d}))},triggerNodeChanges:n=>{let{onNodesChange:o,nodeInternals:i,hasDefaultNodes:l,nodeOrigin:a,getNodes:d,elevateNodesOnSelect:s}=e();n!=null&&n.length&&(l&&t({nodeInternals:tn(bo(n,d()),i,a,s)}),o==null||o(n))},addSelectedNodes:n=>{let{multiSelectionActive:o,edges:i,getNodes:l}=e(),a,d=null;o?a=n.map(s=>Ne(s,!0)):(a=qe(l(),n),d=qe(i,[])),Ct({changedNodes:a,changedEdges:d,get:e,set:t})},addSelectedEdges:n=>{let{multiSelectionActive:o,edges:i,getNodes:l}=e(),a,d=null;o?a=n.map(s=>Ne(s,!0)):(a=qe(i,n),d=qe(l(),[])),Ct({changedNodes:d,changedEdges:a,get:e,set:t})},unselectNodesAndEdges:({nodes:n,edges:o}={})=>{let{edges:i,getNodes:l}=e(),a=n||l(),d=o||i;Ct({changedNodes:a.map(s=>(s.selected=!1,Ne(s.id,!1))),changedEdges:d.map(s=>Ne(s.id,!1)),get:e,set:t})},setMinZoom:n=>{let{d3Zoom:o,maxZoom:i}=e();o==null||o.scaleExtent([n,i]),t({minZoom:n})},setMaxZoom:n=>{let{d3Zoom:o,minZoom:i}=e();o==null||o.scaleExtent([i,n]),t({maxZoom:n})},setTranslateExtent:n=>{var o;(o=e().d3Zoom)==null||o.translateExtent(n),t({translateExtent:n})},resetSelectedElements:()=>{let{edges:n,getNodes:o}=e();Ct({changedNodes:o().filter(i=>i.selected).map(i=>Ne(i.id,!1)),changedEdges:n.filter(i=>i.selected).map(i=>Ne(i.id,!1)),get:e,set:t})},setNodeExtent:n=>{let{nodeInternals:o}=e();o.forEach(i=>{i.positionAbsolute=$t(i.position,n)}),t({nodeExtent:n,nodeInternals:new Map(o)})},panBy:n=>{let{transform:o,width:i,height:l,d3Zoom:a,d3Selection:d,translateExtent:s}=e();if(!a||!d||!n.x&&!n.y)return!1;let c=Fe.translate(o[0]+n.x,o[1]+n.y).scale(o[2]),u=[[0,0],[i,l]],r=a==null?void 0:a.constrain()(c,u,s);return a.transform(d,r),o[0]!==r.x||o[1]!==r.y||o[2]!==r.k},cancelConnection:()=>t({connectionNodeId:ke.connectionNodeId,connectionHandleId:ke.connectionHandleId,connectionHandleType:ke.connectionHandleType,connectionStatus:ke.connectionStatus,connectionStartHandle:ke.connectionStartHandle,connectionEndHandle:ke.connectionEndHandle}),reset:()=>t({...ke})}),Object.is),dn=({children:t})=>{let e=(0,y.useRef)(null);return e.current||(e.current=xs()),y.createElement(Ta,{value:e.current},t)};dn.displayName="ReactFlowProvider";var To=({children:t})=>(0,y.useContext)(pt)?y.createElement(y.Fragment,null,t):y.createElement(dn,null,t);To.displayName="ReactFlowWrapper";var Es={input:no,default:Jt,output:ro,group:en},ws={default:wt,straight:Zt,step:Yt,smoothstep:xt,simplebezier:Xt},Ss=[0,0],Cs=[15,15],Ns={x:0,y:0,zoom:1},ks={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},cn=(0,y.forwardRef)(({nodes:t,edges:e,defaultNodes:n,defaultEdges:o,className:i,nodeTypes:l=Es,edgeTypes:a=ws,onNodeClick:d,onEdgeClick:s,onInit:c,onMove:u,onMoveStart:r,onMoveEnd:g,onConnect:h,onConnectStart:p,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:x,onNodeMouseEnter:b,onNodeMouseMove:N,onNodeMouseLeave:f,onNodeContextMenu:C,onNodeDoubleClick:M,onNodeDragStart:O,onNodeDrag:D,onNodeDragStop:P,onNodesDelete:E,onEdgesDelete:w,onSelectionChange:_,onSelectionDragStart:k,onSelectionDrag:S,onSelectionDragStop:R,onSelectionContextMenu:z,onSelectionStart:$,onSelectionEnd:F,connectionMode:j=Ze.Strict,connectionLineType:T=Be.Bezier,connectionLineStyle:V,connectionLineComponent:X,connectionLineContainerStyle:W,deleteKeyCode:U="Backspace",selectionKeyCode:I="Shift",selectionOnDrag:A=!1,selectionMode:B=bt.Full,panActivationKeyCode:H="Space",multiSelectionKeyCode:Z=vt()?"Meta":"Control",zoomActivationKeyCode:G=vt()?"Meta":"Control",snapToGrid:ee=!1,snapGrid:ae=Cs,onlyRenderVisibleElements:ge=!1,selectNodesOnDrag:oe=!0,nodesDraggable:J,nodesConnectable:de,nodesFocusable:te,nodeOrigin:K=Ss,edgesFocusable:me,edgesUpdatable:Me,elementsSelectable:tt,defaultViewport:Le=Ns,minZoom:$e=.5,maxZoom:Ee=2,translateExtent:Te=ln,preventScrolling:_e=!0,nodeExtent:Oe,defaultMarkerColor:He="#b1b1b7",zoomOnScroll:Ve=!0,zoomOnPinch:ce=!0,panOnScroll:fe=!1,panOnScrollSpeed:Pe=.5,panOnScrollMode:De=Ae.Free,zoomOnDoubleClick:Ie=!0,panOnDrag:be=!0,onPaneClick:we,onPaneMouseEnter:nt,onPaneMouseMove:Pt,onPaneMouseLeave:ot,onPaneScroll:je,onPaneContextMenu:lr,children:dr,onEdgeContextMenu:cr,onEdgeDoubleClick:ur,onEdgeMouseEnter:hr,onEdgeMouseMove:gr,onEdgeMouseLeave:mr,onEdgeUpdate:fr,onEdgeUpdateStart:pr,onEdgeUpdateEnd:yr,onReconnect:vr,onReconnectStart:br,onReconnectEnd:xr,reconnectRadius:Er=10,edgeUpdaterRadius:wr=10,onNodesChange:Sr,onEdgesChange:Cr,noDragClassName:Nr="nodrag",noWheelClassName:kr="nowheel",noPanClassName:mn="nopan",fitView:Mr=!1,fitViewOptions:_r,connectOnClick:Or=!0,attributionPosition:Pr,proOptions:Dr,defaultEdgeOptions:Ir,elevateNodesOnSelect:jr=!0,elevateEdgesOnSelect:Rr=!1,disableKeyboardA11y:fn=!1,autoPanOnConnect:Ar=!0,autoPanOnNodeDrag:Br=!0,connectionRadius:zr=20,isValidConnection:Lr,onError:$r,style:Tr,id:pn,nodeDragThreshold:Hr,...Vr},Xr)=>{let Dt=pn||"1";return y.createElement("div",{...Vr,style:{...Tr,...ks},ref:Xr,className:he(["react-flow",i]),"data-testid":"rf__wrapper",id:pn},y.createElement(To,null,y.createElement(bs,{onInit:c,onMove:u,onMoveStart:r,onMoveEnd:g,onNodeClick:d,onEdgeClick:s,onNodeMouseEnter:b,onNodeMouseMove:N,onNodeMouseLeave:f,onNodeContextMenu:C,onNodeDoubleClick:M,nodeTypes:l,edgeTypes:a,connectionLineType:T,connectionLineStyle:V,connectionLineComponent:X,connectionLineContainerStyle:W,selectionKeyCode:I,selectionOnDrag:A,selectionMode:B,deleteKeyCode:U,multiSelectionKeyCode:Z,panActivationKeyCode:H,zoomActivationKeyCode:G,onlyRenderVisibleElements:ge,selectNodesOnDrag:oe,defaultViewport:Le,translateExtent:Te,minZoom:$e,maxZoom:Ee,preventScrolling:_e,zoomOnScroll:Ve,zoomOnPinch:ce,zoomOnDoubleClick:Ie,panOnScroll:fe,panOnScrollSpeed:Pe,panOnScrollMode:De,panOnDrag:be,onPaneClick:we,onPaneMouseEnter:nt,onPaneMouseMove:Pt,onPaneMouseLeave:ot,onPaneScroll:je,onPaneContextMenu:lr,onSelectionContextMenu:z,onSelectionStart:$,onSelectionEnd:F,onEdgeContextMenu:cr,onEdgeDoubleClick:ur,onEdgeMouseEnter:hr,onEdgeMouseMove:gr,onEdgeMouseLeave:mr,onReconnect:vr??fr,onReconnectStart:br??pr,onReconnectEnd:xr??yr,reconnectRadius:Er??wr,defaultMarkerColor:He,noDragClassName:Nr,noWheelClassName:kr,noPanClassName:mn,elevateEdgesOnSelect:Rr,rfId:Dt,disableKeyboardA11y:fn,nodeOrigin:K,nodeExtent:Oe}),y.createElement(pi,{nodes:t,edges:e,defaultNodes:n,defaultEdges:o,onConnect:h,onConnectStart:p,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:x,nodesDraggable:J,nodesConnectable:de,nodesFocusable:te,edgesFocusable:me,edgesUpdatable:Me,elementsSelectable:tt,elevateNodesOnSelect:jr,minZoom:$e,maxZoom:Ee,nodeExtent:Oe,onNodesChange:Sr,onEdgesChange:Cr,snapToGrid:ee,snapGrid:ae,connectionMode:j,translateExtent:Te,connectOnClick:Or,defaultEdgeOptions:Ir,fitView:Mr,fitViewOptions:_r,onNodesDelete:E,onEdgesDelete:w,onNodeDragStart:O,onNodeDrag:D,onNodeDragStop:P,onSelectionDrag:S,onSelectionDragStart:k,onSelectionDragStop:R,noPanClassName:mn,nodeOrigin:K,rfId:Dt,autoPanOnConnect:Ar,autoPanOnNodeDrag:Br,onError:$r,connectionRadius:zr,isValidConnection:Lr,nodeDragThreshold:Hr}),y.createElement(mi,{onSelectionChange:_}),dr,y.createElement(Va,{proOptions:Dr,position:Pr}),y.createElement(Ei,{rfId:Dt,disableKeyboardA11y:fn})))});cn.displayName="ReactFlow";function Ho(t){return e=>{let[n,o]=(0,y.useState)(e);return[n,o,(0,y.useCallback)(i=>o(l=>t(i,l)),[])]}}var Vo=Ho(bo),Xo=Ho(Ai);function Ms(){return y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},y.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function _s(){return y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},y.createElement("path",{d:"M0 0h32v4.2H0z"}))}function Os(){return y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},y.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function Ps(){return y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},y.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function Ds(){return y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},y.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}var et=({children:t,className:e,...n})=>y.createElement("button",{type:"button",className:he(["react-flow__controls-button",e]),...n},t);et.displayName="ControlButton";var Is=t=>({isInteractive:t.nodesDraggable||t.nodesConnectable||t.elementsSelectable,minZoomReached:t.transform[2]<=t.minZoom,maxZoomReached:t.transform[2]>=t.maxZoom}),Fo=({style:t,showZoom:e=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:i,onZoomIn:l,onZoomOut:a,onFitView:d,onInteractiveChange:s,className:c,children:u,position:r="bottom-left"})=>{let g=le(),[h,p]=(0,y.useState)(!1),{isInteractive:m,minZoomReached:v,maxZoomReached:x}=ne(Is,ue),{zoomIn:b,zoomOut:N,fitView:f}=lt();if((0,y.useEffect)(()=>{p(!0)},[]),!h)return null;let C=()=>{b(),l==null||l()},M=()=>{N(),a==null||a()},O=()=>{f(i),d==null||d()},D=()=>{g.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),s==null||s(!m)};return y.createElement(yt,{className:he(["react-flow__controls",c]),position:r,style:t,"data-testid":"rf__controls"},e&&y.createElement(y.Fragment,null,y.createElement(et,{onClick:C,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:x},y.createElement(Ms,null)),y.createElement(et,{onClick:M,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:v},y.createElement(_s,null))),n&&y.createElement(et,{className:"react-flow__controls-fitview",onClick:O,title:"fit view","aria-label":"fit view"},y.createElement(Os,null)),o&&y.createElement(et,{className:"react-flow__controls-interactive",onClick:D,title:"toggle interactivity","aria-label":"toggle interactivity"},m?y.createElement(Ds,null):y.createElement(Ps,null)),u)};Fo.displayName="Controls";var js=(0,y.memo)(Fo),ye;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(ye||(ye={}));function Rs({color:t,dimensions:e,lineWidth:n}){return y.createElement("path",{stroke:t,strokeWidth:n,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`})}function As({color:t,radius:e}){return y.createElement("circle",{cx:e,cy:e,r:e,fill:t})}var Bs={[ye.Dots]:"#91919a",[ye.Lines]:"#eee",[ye.Cross]:"#e2e2e2"},zs={[ye.Dots]:1,[ye.Lines]:1,[ye.Cross]:6},Ls=t=>({transform:t.transform,patternId:`pattern-${t.rfId}`});function Yo({id:t,variant:e=ye.Dots,gap:n=20,size:o,lineWidth:i=1,offset:l=2,color:a,style:d,className:s}){let c=(0,y.useRef)(null),{transform:u,patternId:r}=ne(Ls,ue),g=a||Bs[e],h=o||zs[e],p=e===ye.Dots,m=e===ye.Cross,v=Array.isArray(n)?n:[n,n],x=[v[0]*u[2]||1,v[1]*u[2]||1],b=h*u[2],N=m?[b,b]:x,f=p?[b/l,b/l]:[N[0]/l,N[1]/l];return y.createElement("svg",{className:he(["react-flow__background",s]),style:{...d,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:c,"data-testid":"rf__background"},y.createElement("pattern",{id:r+t,x:u[0]%x[0],y:u[1]%x[1],width:x[0],height:x[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${f[0]},-${f[1]})`},p?y.createElement(As,{color:g,radius:b/l}):y.createElement(Rs,{dimensions:N,color:g,lineWidth:i})),y.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${r+t})`}))}Yo.displayName="Background";var $s=(0,y.memo)(Yo),Ts=Re();function un(t){return Math.min(t*11+35,200)}const kt="outputs",Mt="inputs";var Hs=class{createEdge(t,e,n){return{type:"smoothstep",pathOptions:{offset:20,borderRadius:100},data:{direction:n},markerEnd:{type:it.Arrow},id:`${t}-${e}-${n}`,source:t,sourceHandle:n,targetHandle:n,target:e}}createNode(t,e,n){let o=ht.get(e).code.trim().split(`
`).length,i=un(o);return{id:t,data:{atom:e},width:250,type:"custom",height:i,position:{x:0,y:n+20}}}createElements(t,e,n,o){let i=0,l=[],a=[];for(let[s,c]of En.zip(t,e)){let u=this.createNode(s,c,i);l.push(u),i=u.position.y+(u.height||0)}let d=new Set;for(let s of Object.values(n)){let{declaredBy:c,usedBy:u}=s;for(let r of c)for(let g of u){let h=`${r}-${g}`;d.has(h)||(d.add(h),a.push(this.createEdge(r,g,Mt),this.createEdge(r,g,kt)))}}return{nodes:l,edges:a}}},Vs=class{createEdge(t,e){return{animated:!0,markerEnd:{type:it.ArrowClosed},id:`${t}-${e}`,style:{strokeWidth:2},source:t,sourceHandle:kt,targetHandle:Mt,target:e}}createNode(t,e){let n=ht.get(e).code.trim().split(`
`).length,o=un(n);return{id:t,data:{atom:e,forceWidth:300},width:300,type:"custom",height:o,position:{x:0,y:0}}}createElements(t,e,n,o){let i=[],l=[],a=new Set,d=new Set;for(let s of Object.values(n)){if(s.value==="marimo"&&s.name==="mo")continue;let{declaredBy:c,usedBy:u}=s;for(let r of c)for(let g of u){let h=`${r}-${g}`;d.has(h)||(d.add(h),a.add(r),a.add(g),l.push(this.createEdge(r,g)))}}for(let[s,c]of En.zip(t,e)){o||i.push(this.createNode(s,c));let u=a.has(s),r=ht.get(c).code.trim().startsWith("mo.md");(u||!r)&&i.push(this.createNode(s,c))}return{nodes:i,edges:l}}},L=It(ta(),1);function Xs(t){return Math.min(Math.max(t-100,100),400)}const Zo=y.createContext("LR"),Wo=(0,y.memo)(t=>{let e=(0,Ts.c)(51),{data:n,selected:o}=t,i=Zr(n.atom),l=bn().inOrderIds.indexOf(i.id),a=o?"var(--gray-9)":"var(--gray-3)",d=ne(Fs),s=(0,y.use)(Zo),c,u,r,g;if(e[0]!==i.code||e[1]!==a||e[2]!==s||e[3]!==o){let E=i.code.split(`
`).length,w=s==="LR"?Y.Left:Y.Top,_;e[8]===a?_=e[9]:(_={background:a},e[8]=a,e[9]=_),e[10]!==w||e[11]!==_?(r=(0,L.jsx)(Ce,{type:"target",id:Mt,"data-testid":"input-one",position:w,style:_}),e[10]=w,e[11]=_,e[12]=r):r=e[12];let k=s==="LR"?Y.Left:Y.Top,S;e[13]===a?S=e[14]:(S={background:a},e[13]=a,e[14]=S),e[15]!==k||e[16]!==S?(g=(0,L.jsx)(Ce,{type:"source",id:Mt,"data-testid":"input-two",position:k,style:S}),e[15]=k,e[16]=S,e[17]=g):g=e[17];let R=o&&"border-primary";e[18]===R?u=e[19]:(u=xn("flex flex-col bg-card border border-input/50 rounded-md mx-[2px] overflow-hidden",R),e[18]=R,e[19]=u),c=un(E),e[0]=i.code,e[1]=a,e[2]=s,e[3]=o,e[4]=c,e[5]=u,e[6]=r,e[7]=g}else c=e[4],u=e[5],r=e[6],g=e[7];let h;e[20]!==n.forceWidth||e[21]!==d?(h=n.forceWidth||Xs(d),e[20]=n.forceWidth,e[21]=d,e[22]=h):h=e[22];let p;e[23]!==c||e[24]!==h?(p={height:c,width:h},e[23]=c,e[24]=h,e[25]=p):p=e[25];let m=Ur(i.name,l),v;e[26]===m?v=e[27]:(v=(0,L.jsx)("div",{className:"text-muted-foreground font-semibold text-xs py-1 px-2 bg-muted border-b",children:m}),e[26]=m,e[27]=v);let x;e[28]===i.code?x=e[29]:(x=(0,L.jsx)(Ca,{code:i.code}),e[28]=i.code,e[29]=x);let b;e[30]!==u||e[31]!==p||e[32]!==v||e[33]!==x?(b=(0,L.jsxs)("div",{className:u,style:p,children:[v,x]}),e[30]=u,e[31]=p,e[32]=v,e[33]=x,e[34]=b):b=e[34];let N=s==="LR"?Y.Right:Y.Bottom,f;e[35]===a?f=e[36]:(f={background:a},e[35]=a,e[36]=f);let C;e[37]!==N||e[38]!==f?(C=(0,L.jsx)(Ce,{type:"source",id:kt,"data-testid":"output-one",position:N,style:f}),e[37]=N,e[38]=f,e[39]=C):C=e[39];let M=s==="LR"?Y.Right:Y.Bottom,O;e[40]===a?O=e[41]:(O={background:a},e[40]=a,e[41]=O);let D;e[42]!==M||e[43]!==O?(D=(0,L.jsx)(Ce,{type:"target",id:kt,"data-testid":"output-two",position:M,style:O}),e[42]=M,e[43]=O,e[44]=D):D=e[44];let P;return e[45]!==b||e[46]!==C||e[47]!==D||e[48]!==r||e[49]!==g?(P=(0,L.jsxs)("div",{children:[r,g,b,C,D]}),e[45]=b,e[46]=C,e[47]=D,e[48]=r,e[49]=g,e[50]=P):P=e[50],P},(t,e)=>["data","selected","id"].every(n=>t[n]===e[n]));Wo.displayName="CustomNode";const Ko={custom:Wo};function Fs(t){let{width:e}=t;return e}var Go=Re();const hn=(0,y.memo)(t=>{let e=(0,Go.c)(41),{onChange:n,view:o,settings:i,onSettingsChange:l}=t,a;e[0]!==l||e[1]!==i?(a=(R,z)=>{l({...i,[R]:z})},e[0]=l,e[1]=i,e[2]=a):a=e[2];let d=a,s=(0,y.useId)(),c;e[3]===Symbol.for("react.memo_cache_sentinel")?(c=(0,L.jsx)(fa,{asChild:!0,children:(0,L.jsx)(Xe,{variant:"text",size:"xs",children:(0,L.jsx)(da,{className:"w-4 h-4"})})}),e[3]=c):c=e[3];let u;e[4]===Symbol.for("react.memo_cache_sentinel")?(u=(0,L.jsx)("div",{className:"font-semibold pb-4",children:"Settings"}),e[4]=u):u=e[4];let r;e[5]===d?r=e[6]:(r=R=>d("hidePureMarkdown",!!R),e[5]=d,e[6]=r);let g;e[7]!==s||e[8]!==i.hidePureMarkdown||e[9]!==r?(g=(0,L.jsx)(Jr,{"data-testid":"hide-pure-markdown-checkbox",id:s,checked:i.hidePureMarkdown,onCheckedChange:r}),e[7]=s,e[8]=i.hidePureMarkdown,e[9]=r,e[10]=g):g=e[10];let h;e[11]===s?h=e[12]:(h=(0,L.jsx)(ma,{htmlFor:s,children:"Hide pure markdown"}),e[11]=s,e[12]=h);let p;e[13]!==g||e[14]!==h?(p=(0,L.jsxs)(ya,{children:[c,(0,L.jsxs)(pa,{className:"w-auto p-2 text-muted-foreground",children:[u,(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[g,h]})]})]}),e[13]=g,e[14]=h,e[15]=p):p=e[15];let m=p,v=o==="_minimap_",x;e[16]===n?x=e[17]:(x=()=>n("_minimap_"),e[16]=n,e[17]=x);let b;e[18]===Symbol.for("react.memo_cache_sentinel")?(b=(0,L.jsx)(Oa,{className:"w-4 h-4 mr-1"}),e[18]=b):b=e[18];let N;e[19]!==v||e[20]!==x?(N=(0,L.jsxs)(Xe,{variant:"outline",className:"bg-background","aria-selected":v,size:"xs",onClick:x,children:[b,"Mini Map"]}),e[19]=v,e[20]=x,e[21]=N):N=e[21];let f=o==="TB",C;e[22]===n?C=e[23]:(C=()=>n("TB"),e[22]=n,e[23]=C);let M;e[24]===Symbol.for("react.memo_cache_sentinel")?(M=(0,L.jsx)(wn,{className:"w-4 h-4 mr-1"}),e[24]=M):M=e[24];let O;e[25]!==f||e[26]!==C?(O=(0,L.jsxs)(Xe,{variant:"outline",className:"bg-background","aria-selected":f,size:"xs",onClick:C,children:[M,"Vertical Tree"]}),e[25]=f,e[26]=C,e[27]=O):O=e[27];let D=o==="LR",P;e[28]===n?P=e[29]:(P=()=>n("LR"),e[28]=n,e[29]=P);let E;e[30]===Symbol.for("react.memo_cache_sentinel")?(E=(0,L.jsx)(wn,{className:"w-4 h-4 mr-1 transform -rotate-90"}),e[30]=E):E=e[30];let w;e[31]!==D||e[32]!==P?(w=(0,L.jsxs)(Xe,{variant:"outline",className:"bg-background","aria-selected":D,size:"xs",onClick:P,children:[E," ","Horizontal Tree"]}),e[31]=D,e[32]=P,e[33]=w):w=e[33];let _;e[34]!==N||e[35]!==O||e[36]!==w?(_=(0,L.jsxs)("div",{className:"flex gap-2",children:[N,O,w]}),e[34]=N,e[35]=O,e[36]=w,e[37]=_):_=e[37];let k=o!=="_minimap_"&&m,S;return e[38]!==_||e[39]!==k?(S=(0,L.jsxs)(yt,{position:"top-right",className:"flex flex-col items-end gap-2",children:[_,k]}),e[38]=_,e[39]=k,e[40]=S):S=e[40],S});hn.displayName="GraphToolbar";const _t=(0,y.memo)(t=>{let e=(0,Go.c)(11),{selection:n,variables:o,onClearSelection:i}=t;if(!n)return null;let l=Ys,a;e[0]!==i||e[1]!==n.id||e[2]!==n.source||e[3]!==n.target||e[4]!==n.type||e[5]!==o?(a=()=>{if(n.type==="node"){let u=Object.values(o).filter(h=>h.usedBy.includes(n.id)),r=Object.values(o).filter(h=>h.declaredBy.includes(n.id)),g=(h,p)=>(0,L.jsxs)(L.Fragment,{children:[h.length===0&&(0,L.jsx)("div",{className:"text-muted-foreground text-sm text-center",children:"--"}),(0,L.jsx)("div",{className:"grid grid-cols-5 gap-3 items-center text-sm py-1 flex-1 empty:hidden",children:h.map(m=>(0,L.jsxs)(y.Fragment,{children:[(0,L.jsx)(kn,{declaredBy:m.declaredBy,name:m.name}),(0,L.jsxs)("div",{className:"truncate col-span-2",title:m.value??"",children:[m.value,(0,L.jsxs)("span",{className:"ml-1 truncate text-foreground/60 font-mono",children:["(",m.dataType,")"]})]}),(0,L.jsx)("div",{className:"truncate col-span-2 gap-1 items-center",children:(0,L.jsx)(Na,{skipScroll:!0,onClick:()=>l(p==="in"?m.declaredBy[0]:m.usedBy[0],m.name),maxCount:3,cellIds:m.usedBy})})]},m.name))})]});return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"font-bold py-2 flex items-center gap-2 border-b px-3",children:[(0,L.jsx)(ca,{className:"w-5 h-5"}),(0,L.jsx)(jt,{cellId:n.id}),(0,L.jsx)("div",{className:"flex-1"}),(0,L.jsx)(oa,{cellId:n.id,children:(0,L.jsx)(Xe,{variant:"ghost",size:"icon",children:(0,L.jsx)(la,{className:"w-4 h-4"})})}),(0,L.jsx)(Xe,{variant:"text",size:"icon",onClick:()=>{i()},children:(0,L.jsx)(aa,{className:"w-4 h-4"})})]}),(0,L.jsxs)("div",{className:"text-sm flex flex-col py-3 pl-2 pr-4 flex-1 justify-center",children:[(0,L.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,L.jsxs)("span",{className:"flex items-center gap-2 font-semibold",children:[(0,L.jsx)(ka,{className:"w-4 h-4"}),"Outputs"]}),g(r,"out")]}),(0,L.jsx)("hr",{className:"border-divider my-3"}),(0,L.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,L.jsxs)("span",{className:"flex items-center gap-2 font-semibold",children:[(0,L.jsx)(Ma,{className:"w-4 h-4"}),"Inputs"]}),g(u,"in")]})]})]})}if(n.type==="edge"){let u=Object.values(o).filter(r=>r.declaredBy.includes(n.source)&&r.usedBy.includes(n.target));return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"font-bold py-2 flex items-center gap-2 border-b px-3",children:[(0,L.jsx)(ua,{className:"w-4 h-4"}),(0,L.jsx)(jt,{cellId:n.source}),(0,L.jsx)(ra,{className:"w-4 h-4"}),(0,L.jsx)(jt,{cellId:n.target})]}),(0,L.jsx)("div",{className:"grid grid-cols-4 gap-3 max-w-[350px] items-center text-sm p-3 flex-1",children:u.map(r=>(0,L.jsxs)(y.Fragment,{children:[(0,L.jsx)(kn,{declaredBy:r.declaredBy,name:r.name,onClick:()=>{l(r.declaredBy[0],r.name)}}),(0,L.jsx)("div",{className:"truncate text-foreground/60 font-mono",children:r.dataType}),(0,L.jsx)("div",{className:"truncate col-span-2",title:r.value??"",children:r.value})]},r.name))})]})}},e[0]=i,e[1]=n.id,e[2]=n.source,e[3]=n.target,e[4]=n.type,e[5]=o,e[6]=a):a=e[6];let d=a,s;e[7]===d?s=e[8]:(s=d(),e[7]=d,e[8]=s);let c;return e[9]===s?c=e[10]:(c=(0,L.jsx)(yt,{position:"bottom-left",className:"max-h-[90%] flex flex-col w-[calc(100%-5rem)]",children:(0,L.jsx)("div",{className:"min-h-[100px] shadow-md rounded-md border max-w-[550px] border-primary/40 my-4 min-w-[240px] bg-(--slate-1) text-muted-foreground/80 flex flex-col overflow-y-auto",children:s})}),e[9]=s,e[10]=c),c});_t.displayName="GraphSelectionPanel";function Ys(t,e){let n=Gr(t);n&&qr(n,e)}var Zs=Re();function Uo(){let t=(0,Zs.c)(7),e=lt(),n=ne(Ks),o=ne(Ws),i;t[0]===e?i=t[1]:(i=()=>{e.fitView({duration:100})},t[0]=e,t[1]=i);let l=ga(i,100),a,d;t[2]!==l||t[3]!==o||t[4]!==n?(a=()=>{!n||!o||l()},d=[n,o,l],t[2]=l,t[3]=o,t[4]=n,t[5]=a,t[6]=d):(a=t[5],d=t[6]),(0,y.useEffect)(a,d)}function Ws(t){let{height:e}=t;return e}function Ks(t){let{width:e}=t;return e}var qo=Re(),Qo=new Hs;const Gs=t=>{let e=(0,qo.c)(37),{cellIds:n,variables:o,cellAtoms:i,children:l}=t,a;e[0]!==i||e[1]!==n||e[2]!==o?(a=Qo.createElements(n,i,o,!1),e[0]=i,e[1]=n,e[2]=o,e[3]=a):a=e[3];let{nodes:d,edges:s}=a,c;e[4]===Symbol.for("react.memo_cache_sentinel")?(c=[],e[4]=c):c=e[4];let[u,r]=Xo(c),[g,h]=Vo(d),[p,m]=(0,y.useState)(),[v,x]=(0,y.useState)(),b=(0,y.useRef)(!1);Uo();let N=ne(qs),f;e[5]!==r||e[6]!==h?(f=j=>{h(j.nodes),r([])},e[5]=r,e[6]=h,e[7]=f):f=e[7];let C=Sn(f),M,O;e[8]!==i||e[9]!==n||e[10]!==C||e[11]!==o?(M=()=>{if(!b.current){b.current=!0;return}C(Qo.createElements(n,i,o,!1))},O=[n,o,i,C],e[8]=i,e[9]=n,e[10]=C,e[11]=o,e[12]=M,e[13]=O):(M=e[12],O=e[13]),(0,y.useEffect)(M,O);let D,P;e[14]!==s||e[15]!==p||e[16]!==r?(D=()=>{p&&r(s.filter(j=>{let{source:T,target:V,data:X}=j;return T===p&&X.direction==="outputs"||V===p&&X.direction==="inputs"}))},P=[p,r,s],e[14]=s,e[15]=p,e[16]=r,e[17]=D,e[18]=P):(D=e[17],P=e[18]),(0,y.useEffect)(D,P);let E=Us(g,N),w;e[19]===Symbol.for("react.memo_cache_sentinel")?(w=()=>{m(void 0),x(void 0)},e[19]=w):w=e[19];let _=w,k;e[20]!==u||e[21]!==v||e[22]!==p||e[23]!==o?(k=()=>v?(0,L.jsx)(_t,{selection:{type:"edge",source:v.source,target:v.target},onClearSelection:_,variables:o,edges:u}):p?(0,L.jsx)(_t,{selection:{type:"node",id:p},variables:o,edges:u,onClearSelection:_}):null,e[20]=u,e[21]=v,e[22]=p,e[23]=o,e[24]=k):k=e[24];let S=k,R;e[25]===r?R=e[26]:(R=(j,T)=>{let V=T.id;m(V),x(void 0),r([])},e[25]=r,e[26]=R);let z;e[27]===Symbol.for("react.memo_cache_sentinel")?(z=(j,T)=>{x(T)},e[27]=z):z=e[27];let $;e[28]===S?$=e[29]:($=S(),e[28]=S,e[29]=$);let F;return e[30]!==l||e[31]!==u||e[32]!==g||e[33]!==R||e[34]!==$||e[35]!==E?(F=(0,L.jsxs)(cn,{nodes:g,edges:u,nodeTypes:Ko,translateExtent:E,onNodeClick:R,onNodeDoubleClick:Qs,onEdgeClick:z,snapToGrid:!0,fitView:!0,elementsSelectable:!0,minZoom:1,maxZoom:1,draggable:!1,panOnScrollMode:Ae.Vertical,zoomOnDoubleClick:!1,nodesDraggable:!1,nodesConnectable:!1,nodesFocusable:!1,edgesFocusable:!1,selectNodesOnDrag:!1,panOnDrag:!1,preventScrolling:!1,zoomOnPinch:!1,panOnScroll:!0,autoPanOnNodeDrag:!1,autoPanOnConnect:!1,children:[$,l]}),e[30]=l,e[31]=u,e[32]=g,e[33]=R,e[34]=$,e[35]=E,e[36]=F):F=e[36],F};function Us(t,e){let n=(0,qo.c)(17),o;if(n[0]!==e||n[1]!==t){let u;n[3]===e?u=n[4]:(u=(r,g)=>{let{position:h}=g;return Math.min(r,h.y-e/2-10)},n[3]=e,n[4]=u),o=t.reduce(u,1/0),n[0]=e,n[1]=t,n[2]=o}else o=n[2];let i=o,l;if(n[5]!==e||n[6]!==t){let u;n[8]===e?u=n[9]:(u=(r,g)=>{let{position:h}=g;return Math.max(r,h.y+e/2+10)},n[8]=e,n[9]=u),l=t.reduce(u,-1/0),n[5]=e,n[6]=t,n[7]=l}else l=n[7];let a=l,d;n[10]===i?d=n[11]:(d=[-1/0,i],n[10]=i,n[11]=d);let s;n[12]===a?s=n[13]:(s=[1/0,a],n[12]=a,n[13]=s);let c;return n[14]!==d||n[15]!==s?(c=[d,s],n[14]=d,n[15]=s,n[16]=c):c=n[16],c}function qs(t){let{height:e}=t;return e}function Qs(t,e){Cn(e.id,"focus")}var gn=q(((t,e)=>{var n="\0",o="\0",i="",l=class{constructor(r){ie(this,"_isDirected",!0);ie(this,"_isMultigraph",!1);ie(this,"_isCompound",!1);ie(this,"_label");ie(this,"_defaultNodeLabelFn",()=>{});ie(this,"_defaultEdgeLabelFn",()=>{});ie(this,"_nodes",{});ie(this,"_in",{});ie(this,"_preds",{});ie(this,"_out",{});ie(this,"_sucs",{});ie(this,"_edgeObjs",{});ie(this,"_edgeLabels",{});ie(this,"_nodeCount",0);ie(this,"_edgeCount",0);ie(this,"_parent");ie(this,"_children");r&&(this._isDirected=Object.hasOwn(r,"directed")?r.directed:!0,this._isMultigraph=Object.hasOwn(r,"multigraph")?r.multigraph:!1,this._isCompound=Object.hasOwn(r,"compound")?r.compound:!1),this._isCompound&&(this._parent={},this._children={},this._children[o]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(r){return this._label=r,this}graph(){return this._label}setDefaultNodeLabel(r){return this._defaultNodeLabelFn=r,typeof r!="function"&&(this._defaultNodeLabelFn=()=>r),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var r=this;return this.nodes().filter(g=>Object.keys(r._in[g]).length===0)}sinks(){var r=this;return this.nodes().filter(g=>Object.keys(r._out[g]).length===0)}setNodes(r,g){var h=arguments,p=this;return r.forEach(function(m){h.length>1?p.setNode(m,g):p.setNode(m)}),this}setNode(r,g){return Object.hasOwn(this._nodes,r)?(arguments.length>1&&(this._nodes[r]=g),this):(this._nodes[r]=arguments.length>1?g:this._defaultNodeLabelFn(r),this._isCompound&&(this._parent[r]=o,this._children[r]={},this._children[o][r]=!0),this._in[r]={},this._preds[r]={},this._out[r]={},this._sucs[r]={},++this._nodeCount,this)}node(r){return this._nodes[r]}hasNode(r){return Object.hasOwn(this._nodes,r)}removeNode(r){var g=this;if(Object.hasOwn(this._nodes,r)){var h=p=>g.removeEdge(g._edgeObjs[p]);delete this._nodes[r],this._isCompound&&(this._removeFromParentsChildList(r),delete this._parent[r],this.children(r).forEach(function(p){g.setParent(p)}),delete this._children[r]),Object.keys(this._in[r]).forEach(h),delete this._in[r],delete this._preds[r],Object.keys(this._out[r]).forEach(h),delete this._out[r],delete this._sucs[r],--this._nodeCount}return this}setParent(r,g){if(!this._isCompound)throw Error("Cannot set parent in a non-compound graph");if(g===void 0)g=o;else{g+="";for(var h=g;h!==void 0;h=this.parent(h))if(h===r)throw Error("Setting "+g+" as parent of "+r+" would create a cycle");this.setNode(g)}return this.setNode(r),this._removeFromParentsChildList(r),this._parent[r]=g,this._children[g][r]=!0,this}_removeFromParentsChildList(r){delete this._children[this._parent[r]][r]}parent(r){if(this._isCompound){var g=this._parent[r];if(g!==o)return g}}children(r=o){if(this._isCompound){var g=this._children[r];if(g)return Object.keys(g)}else{if(r===o)return this.nodes();if(this.hasNode(r))return[]}}predecessors(r){var g=this._preds[r];if(g)return Object.keys(g)}successors(r){var g=this._sucs[r];if(g)return Object.keys(g)}neighbors(r){var g=this.predecessors(r);if(g){let p=new Set(g);for(var h of this.successors(r))p.add(h);return Array.from(p.values())}}isLeaf(r){return(this.isDirected()?this.successors(r):this.neighbors(r)).length===0}filterNodes(r){var g=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});g.setGraph(this.graph());var h=this;Object.entries(this._nodes).forEach(function([v,x]){r(v)&&g.setNode(v,x)}),Object.values(this._edgeObjs).forEach(function(v){g.hasNode(v.v)&&g.hasNode(v.w)&&g.setEdge(v,h.edge(v))});var p={};function m(v){var x=h.parent(v);return x===void 0||g.hasNode(x)?(p[v]=x,x):x in p?p[x]:m(x)}return this._isCompound&&g.nodes().forEach(v=>g.setParent(v,m(v))),g}setDefaultEdgeLabel(r){return this._defaultEdgeLabelFn=r,typeof r!="function"&&(this._defaultEdgeLabelFn=()=>r),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(r,g){var h=this,p=arguments;return r.reduce(function(m,v){return p.length>1?h.setEdge(m,v,g):h.setEdge(m,v),v}),this}setEdge(){var r,g,h,p,m=!1,v=arguments[0];typeof v=="object"&&v&&"v"in v?(r=v.v,g=v.w,h=v.name,arguments.length===2&&(p=arguments[1],m=!0)):(r=v,g=arguments[1],h=arguments[3],arguments.length>2&&(p=arguments[2],m=!0)),r=""+r,g=""+g,h!==void 0&&(h=""+h);var x=s(this._isDirected,r,g,h);if(Object.hasOwn(this._edgeLabels,x))return m&&(this._edgeLabels[x]=p),this;if(h!==void 0&&!this._isMultigraph)throw Error("Cannot set a named edge when isMultigraph = false");this.setNode(r),this.setNode(g),this._edgeLabels[x]=m?p:this._defaultEdgeLabelFn(r,g,h);var b=c(this._isDirected,r,g,h);return r=b.v,g=b.w,Object.freeze(b),this._edgeObjs[x]=b,a(this._preds[g],r),a(this._sucs[r],g),this._in[g][x]=b,this._out[r][x]=b,this._edgeCount++,this}edge(r,g,h){var p=arguments.length===1?u(this._isDirected,arguments[0]):s(this._isDirected,r,g,h);return this._edgeLabels[p]}edgeAsObj(){let r=this.edge(...arguments);return typeof r=="object"?r:{label:r}}hasEdge(r,g,h){var p=arguments.length===1?u(this._isDirected,arguments[0]):s(this._isDirected,r,g,h);return Object.hasOwn(this._edgeLabels,p)}removeEdge(r,g,h){var p=arguments.length===1?u(this._isDirected,arguments[0]):s(this._isDirected,r,g,h),m=this._edgeObjs[p];return m&&(r=m.v,g=m.w,delete this._edgeLabels[p],delete this._edgeObjs[p],d(this._preds[g],r),d(this._sucs[r],g),delete this._in[g][p],delete this._out[r][p],this._edgeCount--),this}inEdges(r,g){var h=this._in[r];if(h){var p=Object.values(h);return g?p.filter(m=>m.v===g):p}}outEdges(r,g){var h=this._out[r];if(h){var p=Object.values(h);return g?p.filter(m=>m.w===g):p}}nodeEdges(r,g){var h=this.inEdges(r,g);if(h)return h.concat(this.outEdges(r,g))}};function a(r,g){r[g]?r[g]++:r[g]=1}function d(r,g){--r[g]||delete r[g]}function s(r,g,h,p){var m=""+g,v=""+h;if(!r&&m>v){var x=m;m=v,v=x}return m+i+v+i+(p===void 0?n:p)}function c(r,g,h,p){var m=""+g,v=""+h;if(!r&&m>v){var x=m;m=v,v=x}var b={v:m,w:v};return p&&(b.name=p),b}function u(r,g){return s(r,g.v,g.w,g.name)}e.exports=l})),Js=q(((t,e)=>{e.exports="2.2.4"})),el=q(((t,e)=>{e.exports={Graph:gn(),version:Js()}})),tl=q(((t,e)=>{var n=gn();e.exports={write:o,read:a};function o(d){var s={options:{directed:d.isDirected(),multigraph:d.isMultigraph(),compound:d.isCompound()},nodes:i(d),edges:l(d)};return d.graph()!==void 0&&(s.value=structuredClone(d.graph())),s}function i(d){return d.nodes().map(function(s){var c=d.node(s),u=d.parent(s),r={v:s};return c!==void 0&&(r.value=c),u!==void 0&&(r.parent=u),r})}function l(d){return d.edges().map(function(s){var c=d.edge(s),u={v:s.v,w:s.w};return s.name!==void 0&&(u.name=s.name),c!==void 0&&(u.value=c),u})}function a(d){var s=new n(d.options).setGraph(d.value);return d.nodes.forEach(function(c){s.setNode(c.v,c.value),c.parent&&s.setParent(c.v,c.parent)}),d.edges.forEach(function(c){s.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),s}})),nl=q(((t,e)=>{e.exports=n;function n(o){var i={},l=[],a;function d(s){Object.hasOwn(i,s)||(i[s]=!0,a.push(s),o.successors(s).forEach(d),o.predecessors(s).forEach(d))}return o.nodes().forEach(function(s){a=[],d(s),a.length&&l.push(a)}),l}})),Jo=q(((t,e)=>{e.exports=class{constructor(){ie(this,"_arr",[]);ie(this,"_keyIndices",{})}size(){return this._arr.length}keys(){return this._arr.map(function(n){return n.key})}has(n){return Object.hasOwn(this._keyIndices,n)}priority(n){var o=this._keyIndices[n];if(o!==void 0)return this._arr[o].priority}min(){if(this.size()===0)throw Error("Queue underflow");return this._arr[0].key}add(n,o){var i=this._keyIndices;if(n=String(n),!Object.hasOwn(i,n)){var l=this._arr,a=l.length;return i[n]=a,l.push({key:n,priority:o}),this._decrease(a),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var n=this._arr.pop();return delete this._keyIndices[n.key],this._heapify(0),n.key}decrease(n,o){var i=this._keyIndices[n];if(o>this._arr[i].priority)throw Error("New priority is greater than current priority. Key: "+n+" Old: "+this._arr[i].priority+" New: "+o);this._arr[i].priority=o,this._decrease(i)}_heapify(n){var o=this._arr,i=2*n,l=i+1,a=n;i<o.length&&(a=o[i].priority<o[a].priority?i:a,l<o.length&&(a=o[l].priority<o[a].priority?l:a),a!==n&&(this._swap(n,a),this._heapify(a)))}_decrease(n){for(var o=this._arr,i=o[n].priority,l;n!==0&&(l=n>>1,!(o[l].priority<i));)this._swap(n,l),n=l}_swap(n,o){var i=this._arr,l=this._keyIndices,a=i[n],d=i[o];i[n]=d,i[o]=a,l[d.key]=n,l[a.key]=o}}})),er=q(((t,e)=>{var n=Jo();e.exports=i;var o=()=>1;function i(a,d,s,c){return l(a,String(d),s||o,c||function(u){return a.outEdges(u)})}function l(a,d,s,c){var u={},r=new n,g,h,p=function(m){var v=m.v===g?m.w:m.v,x=u[v],b=s(m),N=h.distance+b;if(b<0)throw Error("dijkstra does not allow negative edge weights. Bad edge: "+m+" Weight: "+b);N<x.distance&&(x.distance=N,x.predecessor=g,r.decrease(v,N))};for(a.nodes().forEach(function(m){var v=m===d?0:1/0;u[m]={distance:v},r.add(m,v)});r.size()>0&&(g=r.removeMin(),h=u[g],h.distance!==1/0);)c(g).forEach(p);return u}})),ol=q(((t,e)=>{var n=er();e.exports=o;function o(i,l,a){return i.nodes().reduce(function(d,s){return d[s]=n(i,s,l,a),d},{})}})),tr=q(((t,e)=>{e.exports=n;function n(o){var i=0,l=[],a={},d=[];function s(c){var u=a[c]={onStack:!0,lowlink:i,index:i++};if(l.push(c),o.successors(c).forEach(function(h){Object.hasOwn(a,h)?a[h].onStack&&(u.lowlink=Math.min(u.lowlink,a[h].index)):(s(h),u.lowlink=Math.min(u.lowlink,a[h].lowlink))}),u.lowlink===u.index){var r=[],g;do g=l.pop(),a[g].onStack=!1,r.push(g);while(c!==g);d.push(r)}}return o.nodes().forEach(function(c){Object.hasOwn(a,c)||s(c)}),d}})),rl=q(((t,e)=>{var n=tr();e.exports=o;function o(i){return n(i).filter(function(l){return l.length>1||l.length===1&&i.hasEdge(l[0],l[0])})}})),al=q(((t,e)=>{e.exports=o;var n=()=>1;function o(l,a,d){return i(l,a||n,d||function(s){return l.outEdges(s)})}function i(l,a,d){var s={},c=l.nodes();return c.forEach(function(u){s[u]={},s[u][u]={distance:0},c.forEach(function(r){u!==r&&(s[u][r]={distance:1/0})}),d(u).forEach(function(r){var g=r.v===u?r.w:r.v,h=a(r);s[u][g]={distance:h,predecessor:u}})}),c.forEach(function(u){var r=s[u];c.forEach(function(g){var h=s[g];c.forEach(function(p){var m=h[u],v=r[p],x=h[p],b=m.distance+v.distance;b<x.distance&&(x.distance=b,x.predecessor=v.predecessor)})})}),s}})),nr=q(((t,e)=>{function n(i){var l={},a={},d=[];function s(c){if(Object.hasOwn(a,c))throw new o;Object.hasOwn(l,c)||(a[c]=!0,l[c]=!0,i.predecessors(c).forEach(s),delete a[c],d.push(c))}if(i.sinks().forEach(s),Object.keys(l).length!==i.nodeCount())throw new o;return d}var o=class extends Error{constructor(){super(...arguments)}};e.exports=n,n.CycleException=o})),il=q(((t,e)=>{var n=nr();e.exports=o;function o(i){try{n(i)}catch(l){if(l instanceof n.CycleException)return!1;throw l}return!0}})),or=q(((t,e)=>{e.exports=n;function n(a,d,s){Array.isArray(d)||(d=[d]);var c=a.isDirected()?h=>a.successors(h):h=>a.neighbors(h),u=s==="post"?o:i,r=[],g={};return d.forEach(h=>{if(!a.hasNode(h))throw Error("Graph does not have node: "+h);u(h,c,g,r)}),r}function o(a,d,s,c){for(var u=[[a,!1]];u.length>0;){var r=u.pop();r[1]?c.push(r[0]):Object.hasOwn(s,r[0])||(s[r[0]]=!0,u.push([r[0],!0]),l(d(r[0]),g=>u.push([g,!1])))}}function i(a,d,s,c){for(var u=[a];u.length>0;){var r=u.pop();Object.hasOwn(s,r)||(s[r]=!0,c.push(r),l(d(r),g=>u.push(g)))}}function l(a,d){for(var s=a.length;s--;)d(a[s],s,a);return a}})),sl=q(((t,e)=>{var n=or();e.exports=o;function o(i,l){return n(i,l,"post")}})),ll=q(((t,e)=>{var n=or();e.exports=o;function o(i,l){return n(i,l,"pre")}})),dl=q(((t,e)=>{var n=gn(),o=Jo();e.exports=i;function i(l,a){var d=new n,s={},c=new o,u;function r(h){var p=h.v===u?h.w:h.v,m=c.priority(p);if(m!==void 0){var v=a(h);v<m&&(s[p]=u,c.decrease(p,v))}}if(l.nodeCount()===0)return d;l.nodes().forEach(function(h){c.add(h,1/0),d.setNode(h)}),c.decrease(l.nodes()[0],0);for(var g=!1;c.size()>0;){if(u=c.removeMin(),Object.hasOwn(s,u))d.setEdge(u,s[u]);else{if(g)throw Error("Input graph is not connected: "+l);g=!0}l.nodeEdges(u).forEach(r)}return d}})),cl=q(((t,e)=>{e.exports={components:nl(),dijkstra:er(),dijkstraAll:ol(),findCycles:rl(),floydWarshall:al(),isAcyclic:il(),postorder:sl(),preorder:ll(),prim:dl(),tarjan:tr(),topsort:nr()}})),ve=q(((t,e)=>{var n=el();e.exports={Graph:n.Graph,json:tl(),alg:cl(),version:n.version}})),ul=q(((t,e)=>{var n=class{constructor(){let l={};l._next=l._prev=l,this._sentinel=l}dequeue(){let l=this._sentinel,a=l._prev;if(a!==l)return o(a),a}enqueue(l){let a=this._sentinel;l._prev&&l._next&&o(l),l._next=a._next,a._next._prev=l,a._next=l,l._prev=a}toString(){let l=[],a=this._sentinel,d=a._prev;for(;d!==a;)l.push(JSON.stringify(d,i)),d=d._prev;return"["+l.join(", ")+"]"}};function o(l){l._prev._next=l._next,l._next._prev=l._prev,delete l._next,delete l._prev}function i(l,a){if(l!=="_next"&&l!=="_prev")return a}e.exports=n})),hl=q(((t,e)=>{var n=ve().Graph,o=ul();e.exports=l;var i=()=>1;function l(r,g){if(r.nodeCount()<=1)return[];let h=s(r,g||i);return a(h.graph,h.buckets,h.zeroIdx).flatMap(p=>r.outEdges(p.v,p.w))}function a(r,g,h){let p=[],m=g[g.length-1],v=g[0],x;for(;r.nodeCount();){for(;x=v.dequeue();)d(r,g,h,x);for(;x=m.dequeue();)d(r,g,h,x);if(r.nodeCount()){for(let b=g.length-2;b>0;--b)if(x=g[b].dequeue(),x){p=p.concat(d(r,g,h,x,!0));break}}}return p}function d(r,g,h,p,m){let v=m?[]:void 0;return r.inEdges(p.v).forEach(x=>{let b=r.edge(x),N=r.node(x.v);m&&v.push({v:x.v,w:x.w}),N.out-=b,c(g,h,N)}),r.outEdges(p.v).forEach(x=>{let b=r.edge(x),N=x.w,f=r.node(N);f.in-=b,c(g,h,f)}),r.removeNode(p.v),v}function s(r,g){let h=new n,p=0,m=0;r.nodes().forEach(b=>{h.setNode(b,{v:b,in:0,out:0})}),r.edges().forEach(b=>{let N=h.edge(b.v,b.w)||0,f=g(b),C=N+f;h.setEdge(b.v,b.w,C),m=Math.max(m,h.node(b.v).out+=f),p=Math.max(p,h.node(b.w).in+=f)});let v=u(m+p+3).map(()=>new o),x=p+1;return h.nodes().forEach(b=>{c(v,x,h.node(b))}),{graph:h,buckets:v,zeroIdx:x}}function c(r,g,h){h.out?h.in?r[h.out-h.in+g].enqueue(h):r[r.length-1].enqueue(h):r[0].enqueue(h)}function u(r){let g=[];for(let h=0;h<r;h++)g.push(h);return g}})),se=q(((t,e)=>{var n=ve().Graph;e.exports={addBorderNode:g,addDummyNode:o,applyWithChunking:m,asNonCompoundGraph:l,buildLayerMatrix:c,intersectRect:s,mapValues:D,maxRank:v,normalizeRanks:u,notime:N,partition:x,pick:O,predecessorWeights:d,range:M,removeEmptyRanks:r,simplify:i,successorWeights:a,time:b,uniqueId:C,zipObject:P};function o(E,w,_,k){for(var S=k;E.hasNode(S);)S=C(k);return _.dummy=w,E.setNode(S,_),S}function i(E){let w=new n().setGraph(E.graph());return E.nodes().forEach(_=>w.setNode(_,E.node(_))),E.edges().forEach(_=>{let k=w.edge(_.v,_.w)||{weight:0,minlen:1},S=E.edge(_);w.setEdge(_.v,_.w,{weight:k.weight+S.weight,minlen:Math.max(k.minlen,S.minlen)})}),w}function l(E){let w=new n({multigraph:E.isMultigraph()}).setGraph(E.graph());return E.nodes().forEach(_=>{E.children(_).length||w.setNode(_,E.node(_))}),E.edges().forEach(_=>{w.setEdge(_,E.edge(_))}),w}function a(E){let w=E.nodes().map(_=>{let k={};return E.outEdges(_).forEach(S=>{k[S.w]=(k[S.w]||0)+E.edge(S).weight}),k});return P(E.nodes(),w)}function d(E){let w=E.nodes().map(_=>{let k={};return E.inEdges(_).forEach(S=>{k[S.v]=(k[S.v]||0)+E.edge(S).weight}),k});return P(E.nodes(),w)}function s(E,w){let _=E.x,k=E.y,S=w.x-_,R=w.y-k,z=E.width/2,$=E.height/2;if(!S&&!R)throw Error("Not possible to find intersection inside of the rectangle");let F,j;return Math.abs(R)*z>Math.abs(S)*$?(R<0&&($=-$),F=$*S/R,j=$):(S<0&&(z=-z),F=z,j=z*R/S),{x:_+F,y:k+j}}function c(E){let w=M(v(E)+1).map(()=>[]);return E.nodes().forEach(_=>{let k=E.node(_),S=k.rank;S!==void 0&&(w[S][k.order]=_)}),w}function u(E){let w=E.nodes().map(k=>{let S=E.node(k).rank;return S===void 0?Number.MAX_VALUE:S}),_=m(Math.min,w);E.nodes().forEach(k=>{let S=E.node(k);Object.hasOwn(S,"rank")&&(S.rank-=_)})}function r(E){let w=E.nodes().map(z=>E.node(z).rank),_=m(Math.min,w),k=[];E.nodes().forEach(z=>{let $=E.node(z).rank-_;k[$]||(k[$]=[]),k[$].push(z)});let S=0,R=E.graph().nodeRankFactor;Array.from(k).forEach((z,$)=>{z===void 0&&$%R!==0?--S:z!==void 0&&S&&z.forEach(F=>E.node(F).rank+=S)})}function g(E,w,_,k){let S={width:0,height:0};return arguments.length>=4&&(S.rank=_,S.order=k),o(E,"border",S,w)}function h(E,w=p){let _=[];for(let k=0;k<E.length;k+=w){let S=E.slice(k,k+w);_.push(S)}return _}var p=65535;function m(E,w){if(w.length>p){let _=h(w);return E.apply(null,_.map(k=>E.apply(null,k)))}else return E.apply(null,w)}function v(E){let w=E.nodes().map(_=>{let k=E.node(_).rank;return k===void 0?Number.MIN_VALUE:k});return m(Math.max,w)}function x(E,w){let _={lhs:[],rhs:[]};return E.forEach(k=>{w(k)?_.lhs.push(k):_.rhs.push(k)}),_}function b(E,w){let _=Date.now();try{return w()}finally{console.log(E+" time: "+(Date.now()-_)+"ms")}}function N(E,w){return w()}var f=0;function C(E){return E+(""+ ++f)}function M(E,w,_=1){w??(w=E,E=0);let k=R=>R<w;_<0&&(k=R=>w<R);let S=[];for(let R=E;k(R);R+=_)S.push(R);return S}function O(E,w){let _={};for(let k of w)E[k]!==void 0&&(_[k]=E[k]);return _}function D(E,w){let _=w;return typeof w=="string"&&(_=k=>k[w]),Object.entries(E).reduce((k,[S,R])=>(k[S]=_(R,S),k),{})}function P(E,w){return E.reduce((_,k,S)=>(_[k]=w[S],_),{})}})),gl=q(((t,e)=>{var n=hl(),o=se().uniqueId;e.exports={run:i,undo:a};function i(d){(d.graph().acyclicer==="greedy"?n(d,s(d)):l(d)).forEach(c=>{let u=d.edge(c);d.removeEdge(c),u.forwardName=c.name,u.reversed=!0,d.setEdge(c.w,c.v,u,o("rev"))});function s(c){return u=>c.edge(u).weight}}function l(d){let s=[],c={},u={};function r(g){Object.hasOwn(u,g)||(u[g]=!0,c[g]=!0,d.outEdges(g).forEach(h=>{Object.hasOwn(c,h.w)?s.push(h):r(h.w)}),delete c[g])}return d.nodes().forEach(r),s}function a(d){d.edges().forEach(s=>{let c=d.edge(s);if(c.reversed){d.removeEdge(s);let u=c.forwardName;delete c.reversed,delete c.forwardName,d.setEdge(s.w,s.v,c,u)}})}})),ml=q(((t,e)=>{var n=se();e.exports={run:o,undo:l};function o(a){a.graph().dummyChains=[],a.edges().forEach(d=>i(a,d))}function i(a,d){let s=d.v,c=a.node(s).rank,u=d.w,r=a.node(u).rank,g=d.name,h=a.edge(d),p=h.labelRank;if(r===c+1)return;a.removeEdge(d);let m,v,x;for(x=0,++c;c<r;++x,++c)h.points=[],v={width:0,height:0,edgeLabel:h,edgeObj:d,rank:c},m=n.addDummyNode(a,"edge",v,"_d"),c===p&&(v.width=h.width,v.height=h.height,v.dummy="edge-label",v.labelpos=h.labelpos),a.setEdge(s,m,{weight:h.weight},g),x===0&&a.graph().dummyChains.push(m),s=m;a.setEdge(s,u,{weight:h.weight},g)}function l(a){a.graph().dummyChains.forEach(d=>{let s=a.node(d),c=s.edgeLabel,u;for(a.setEdge(s.edgeObj,c);s.dummy;)u=a.successors(d)[0],a.removeNode(d),c.points.push({x:s.x,y:s.y}),s.dummy==="edge-label"&&(c.x=s.x,c.y=s.y,c.width=s.width,c.height=s.height),d=u,s=a.node(d)})}})),Ot=q(((t,e)=>{var{applyWithChunking:n}=se();e.exports={longestPath:o,slack:i};function o(l){var a={};function d(s){var c=l.node(s);if(Object.hasOwn(a,s))return c.rank;a[s]=!0;let u=l.outEdges(s).map(g=>g==null?1/0:d(g.w)-l.edge(g).minlen);var r=n(Math.min,u);return r===1/0&&(r=0),c.rank=r}l.sources().forEach(d)}function i(l,a){return l.node(a.w).rank-l.node(a.v).rank-l.edge(a).minlen}})),rr=q(((t,e)=>{var n=ve().Graph,o=Ot().slack;e.exports=i;function i(s){var c=new n({directed:!1}),u=s.nodes()[0],r=s.nodeCount();c.setNode(u,{});for(var g,h;l(c,s)<r;)g=a(c,s),h=c.hasNode(g.v)?o(s,g):-o(s,g),d(c,s,h);return c}function l(s,c){function u(r){c.nodeEdges(r).forEach(g=>{var h=g.v,p=r===h?g.w:h;!s.hasNode(p)&&!o(c,g)&&(s.setNode(p,{}),s.setEdge(r,p,{}),u(p))})}return s.nodes().forEach(u),s.nodeCount()}function a(s,c){return c.edges().reduce((u,r)=>{let g=1/0;return s.hasNode(r.v)!==s.hasNode(r.w)&&(g=o(c,r)),g<u[0]?[g,r]:u},[1/0,null])[1]}function d(s,c,u){s.nodes().forEach(r=>c.node(r).rank+=u)}})),fl=q(((t,e)=>{var n=rr(),o=Ot().slack,i=Ot().longestPath,l=ve().alg.preorder,a=ve().alg.postorder,d=se().simplify;e.exports=s,s.initLowLimValues=g,s.initCutValues=c,s.calcCutValue=r,s.leaveEdge=p,s.enterEdge=m,s.exchangeEdges=v;function s(f){f=d(f),i(f);var C=n(f);g(C),c(C,f);for(var M,O;M=p(C);)O=m(C,f,M),v(C,f,M,O)}function c(f,C){var M=a(f,f.nodes());M=M.slice(0,M.length-1),M.forEach(O=>u(f,C,O))}function u(f,C,M){var O=f.node(M).parent;f.edge(M,O).cutvalue=r(f,C,M)}function r(f,C,M){var O=f.node(M).parent,D=!0,P=C.edge(M,O),E=0;return P||(P=(D=!1,C.edge(O,M))),E=P.weight,C.nodeEdges(M).forEach(w=>{var _=w.v===M,k=_?w.w:w.v;if(k!==O){var S=_===D,R=C.edge(w).weight;if(E+=S?R:-R,b(f,M,k)){var z=f.edge(M,k).cutvalue;E+=S?-z:z}}}),E}function g(f,C){arguments.length<2&&(C=f.nodes()[0]),h(f,{},1,C)}function h(f,C,M,O,D){var P=M,E=f.node(O);return C[O]=!0,f.neighbors(O).forEach(w=>{Object.hasOwn(C,w)||(M=h(f,C,M,w,O))}),E.low=P,E.lim=M++,D?E.parent=D:delete E.parent,M}function p(f){return f.edges().find(C=>f.edge(C).cutvalue<0)}function m(f,C,M){var O=M.v,D=M.w;C.hasEdge(O,D)||(O=M.w,D=M.v);var P=f.node(O),E=f.node(D),w=P,_=!1;return P.lim>E.lim&&(w=E,_=!0),C.edges().filter(k=>_===N(f,f.node(k.v),w)&&_!==N(f,f.node(k.w),w)).reduce((k,S)=>o(C,S)<o(C,k)?S:k)}function v(f,C,M,O){var D=M.v,P=M.w;f.removeEdge(D,P),f.setEdge(O.v,O.w,{}),g(f),c(f,C),x(f,C)}function x(f,C){var M=l(f,f.nodes().find(O=>!C.node(O).parent));M=M.slice(1),M.forEach(O=>{var D=f.node(O).parent,P=C.edge(O,D),E=!1;P||(P=C.edge(D,O),E=!0),C.node(O).rank=C.node(D).rank+(E?P.minlen:-P.minlen)})}function b(f,C,M){return f.hasEdge(C,M)}function N(f,C,M){return M.low<=C.lim&&C.lim<=M.lim}})),pl=q(((t,e)=>{var n=Ot().longestPath,o=rr(),i=fl();e.exports=l;function l(c){var u=c.graph().ranker;if(u instanceof Function)return u(c);switch(c.graph().ranker){case"network-simplex":s(c);break;case"tight-tree":d(c);break;case"longest-path":a(c);break;case"none":break;default:s(c)}}var a=n;function d(c){n(c),o(c)}function s(c){i(c)}})),yl=q(((t,e)=>{e.exports=n;function n(l){let a=i(l);l.graph().dummyChains.forEach(d=>{let s=l.node(d),c=s.edgeObj,u=o(l,a,c.v,c.w),r=u.path,g=u.lca,h=0,p=r[h],m=!0;for(;d!==c.w;){if(s=l.node(d),m){for(;(p=r[h])!==g&&l.node(p).maxRank<s.rank;)h++;p===g&&(m=!1)}if(!m){for(;h<r.length-1&&l.node(p=r[h+1]).minRank<=s.rank;)h++;p=r[h]}l.setParent(d,p),d=l.successors(d)[0]}})}function o(l,a,d,s){let c=[],u=[],r=Math.min(a[d].low,a[s].low),g=Math.max(a[d].lim,a[s].lim),h,p;h=d;do h=l.parent(h),c.push(h);while(h&&(a[h].low>r||g>a[h].lim));for(p=h,h=s;(h=l.parent(h))!==p;)u.push(h);return{path:c.concat(u.reverse()),lca:p}}function i(l){let a={},d=0;function s(c){let u=d;l.children(c).forEach(s),a[c]={low:u,lim:d++}}return l.children().forEach(s),a}})),vl=q(((t,e)=>{var n=se();e.exports={run:o,cleanup:d};function o(s){let c=n.addDummyNode(s,"root",{},"_root"),u=l(s),r=Object.values(u),g=n.applyWithChunking(Math.max,r)-1,h=2*g+1;s.graph().nestingRoot=c,s.edges().forEach(m=>s.edge(m).minlen*=h);let p=a(s)+1;s.children().forEach(m=>i(s,c,h,p,g,u,m)),s.graph().nodeRankFactor=h}function i(s,c,u,r,g,h,p){let m=s.children(p);if(!m.length){p!==c&&s.setEdge(c,p,{weight:0,minlen:u});return}let v=n.addBorderNode(s,"_bt"),x=n.addBorderNode(s,"_bb"),b=s.node(p);s.setParent(v,p),b.borderTop=v,s.setParent(x,p),b.borderBottom=x,m.forEach(N=>{i(s,c,u,r,g,h,N);let f=s.node(N),C=f.borderTop?f.borderTop:N,M=f.borderBottom?f.borderBottom:N,O=f.borderTop?r:2*r,D=C===M?g-h[p]+1:1;s.setEdge(v,C,{weight:O,minlen:D,nestingEdge:!0}),s.setEdge(M,x,{weight:O,minlen:D,nestingEdge:!0})}),s.parent(p)||s.setEdge(c,v,{weight:0,minlen:g+h[p]})}function l(s){var c={};function u(r,g){var h=s.children(r);h&&h.length&&h.forEach(p=>u(p,g+1)),c[r]=g}return s.children().forEach(r=>u(r,1)),c}function a(s){return s.edges().reduce((c,u)=>c+s.edge(u).weight,0)}function d(s){var c=s.graph();s.removeNode(c.nestingRoot),delete c.nestingRoot,s.edges().forEach(u=>{s.edge(u).nestingEdge&&s.removeEdge(u)})}})),bl=q(((t,e)=>{var n=se();e.exports=o;function o(l){function a(d){let s=l.children(d),c=l.node(d);if(s.length&&s.forEach(a),Object.hasOwn(c,"minRank")){c.borderLeft=[],c.borderRight=[];for(let u=c.minRank,r=c.maxRank+1;u<r;++u)i(l,"borderLeft","_bl",d,c,u),i(l,"borderRight","_br",d,c,u)}}l.children().forEach(a)}function i(l,a,d,s,c,u){let r={width:0,height:0,rank:u,borderType:a},g=c[a][u-1],h=n.addDummyNode(l,"border",r,d);c[a][u]=h,l.setParent(h,s),g&&l.setEdge(g,h,{weight:1})}})),xl=q(((t,e)=>{e.exports={adjust:n,undo:o};function n(u){let r=u.graph().rankdir.toLowerCase();(r==="lr"||r==="rl")&&i(u)}function o(u){let r=u.graph().rankdir.toLowerCase();(r==="bt"||r==="rl")&&a(u),(r==="lr"||r==="rl")&&(s(u),i(u))}function i(u){u.nodes().forEach(r=>l(u.node(r))),u.edges().forEach(r=>l(u.edge(r)))}function l(u){let r=u.width;u.width=u.height,u.height=r}function a(u){u.nodes().forEach(r=>d(u.node(r))),u.edges().forEach(r=>{let g=u.edge(r);g.points.forEach(d),Object.hasOwn(g,"y")&&d(g)})}function d(u){u.y=-u.y}function s(u){u.nodes().forEach(r=>c(u.node(r))),u.edges().forEach(r=>{let g=u.edge(r);g.points.forEach(c),Object.hasOwn(g,"x")&&c(g)})}function c(u){let r=u.x;u.x=u.y,u.y=r}})),El=q(((t,e)=>{var n=se();e.exports=o;function o(i){let l={},a=i.nodes().filter(r=>!i.children(r).length),d=a.map(r=>i.node(r).rank),s=n.applyWithChunking(Math.max,d),c=n.range(s+1).map(()=>[]);function u(r){l[r]||(l[r]=!0,c[i.node(r).rank].push(r),i.successors(r).forEach(u))}return a.sort((r,g)=>i.node(r).rank-i.node(g).rank).forEach(u),c}})),wl=q(((t,e)=>{var n=se().zipObject;e.exports=o;function o(l,a){let d=0;for(let s=1;s<a.length;++s)d+=i(l,a[s-1],a[s]);return d}function i(l,a,d){let s=n(d,d.map((p,m)=>m)),c=a.flatMap(p=>l.outEdges(p).map(m=>({pos:s[m.w],weight:l.edge(m).weight})).sort((m,v)=>m.pos-v.pos)),u=1;for(;u<d.length;)u<<=1;let r=2*u-1;--u;let g=Array(r).fill(0),h=0;return c.forEach(p=>{let m=p.pos+u;g[m]+=p.weight;let v=0;for(;m>0;)m%2&&(v+=g[m+1]),m=m-1>>1,g[m]+=p.weight;h+=p.weight*v}),h}})),Sl=q(((t,e)=>{e.exports=n;function n(o,i=[]){return i.map(l=>{let a=o.inEdges(l);if(a.length){let d=a.reduce((s,c)=>{let u=o.edge(c),r=o.node(c.v);return{sum:s.sum+u.weight*r.order,weight:s.weight+u.weight}},{sum:0,weight:0});return{v:l,barycenter:d.sum/d.weight,weight:d.weight}}else return{v:l}})}})),Cl=q(((t,e)=>{var n=se();e.exports=o;function o(a,d){let s={};return a.forEach((c,u)=>{let r=s[c.v]={indegree:0,in:[],out:[],vs:[c.v],i:u};c.barycenter!==void 0&&(r.barycenter=c.barycenter,r.weight=c.weight)}),d.edges().forEach(c=>{let u=s[c.v],r=s[c.w];u!==void 0&&r!==void 0&&(r.indegree++,u.out.push(s[c.w]))}),i(Object.values(s).filter(c=>!c.indegree))}function i(a){let d=[];function s(u){return r=>{r.merged||(r.barycenter===void 0||u.barycenter===void 0||r.barycenter>=u.barycenter)&&l(u,r)}}function c(u){return r=>{r.in.push(u),--r.indegree===0&&a.push(r)}}for(;a.length;){let u=a.pop();d.push(u),u.in.reverse().forEach(s(u)),u.out.forEach(c(u))}return d.filter(u=>!u.merged).map(u=>n.pick(u,["vs","i","barycenter","weight"]))}function l(a,d){let s=0,c=0;a.weight&&(s+=a.barycenter*a.weight,c+=a.weight),d.weight&&(s+=d.barycenter*d.weight,c+=d.weight),a.vs=d.vs.concat(a.vs),a.barycenter=s/c,a.weight=c,a.i=Math.min(d.i,a.i),d.merged=!0}})),Nl=q(((t,e)=>{var n=se();e.exports=o;function o(a,d){let s=n.partition(a,v=>Object.hasOwn(v,"barycenter")),c=s.lhs,u=s.rhs.sort((v,x)=>x.i-v.i),r=[],g=0,h=0,p=0;c.sort(l(!!d)),p=i(r,u,p),c.forEach(v=>{p+=v.vs.length,r.push(v.vs),g+=v.barycenter*v.weight,h+=v.weight,p=i(r,u,p)});let m={vs:r.flat(!0)};return h&&(m.barycenter=g/h,m.weight=h),m}function i(a,d,s){let c;for(;d.length&&(c=d[d.length-1]).i<=s;)d.pop(),a.push(c.vs),s++;return s}function l(a){return(d,s)=>d.barycenter<s.barycenter?-1:d.barycenter>s.barycenter?1:a?s.i-d.i:d.i-s.i}})),kl=q(((t,e)=>{var n=Sl(),o=Cl(),i=Nl();e.exports=l;function l(s,c,u,r){let g=s.children(c),h=s.node(c),p=h?h.borderLeft:void 0,m=h?h.borderRight:void 0,v={};p&&(g=g.filter(f=>f!==p&&f!==m));let x=n(s,g);x.forEach(f=>{if(s.children(f.v).length){let C=l(s,f.v,u,r);v[f.v]=C,Object.hasOwn(C,"barycenter")&&d(f,C)}});let b=o(x,u);a(b,v);let N=i(b,r);if(p&&(N.vs=[p,N.vs,m].flat(!0),s.predecessors(p).length)){let f=s.node(s.predecessors(p)[0]),C=s.node(s.predecessors(m)[0]);Object.hasOwn(N,"barycenter")||(N.barycenter=0,N.weight=0),N.barycenter=(N.barycenter*N.weight+f.order+C.order)/(N.weight+2),N.weight+=2}return N}function a(s,c){s.forEach(u=>{u.vs=u.vs.flatMap(r=>c[r]?c[r].vs:r)})}function d(s,c){s.barycenter===void 0?(s.barycenter=c.barycenter,s.weight=c.weight):(s.barycenter=(s.barycenter*s.weight+c.barycenter*c.weight)/(s.weight+c.weight),s.weight+=c.weight)}})),Ml=q(((t,e)=>{var n=ve().Graph,o=se();e.exports=i;function i(a,d,s,c){c||(c=a.nodes());let u=l(a),r=new n({compound:!0}).setGraph({root:u}).setDefaultNodeLabel(g=>a.node(g));return c.forEach(g=>{let h=a.node(g),p=a.parent(g);(h.rank===d||h.minRank<=d&&d<=h.maxRank)&&(r.setNode(g),r.setParent(g,p||u),a[s](g).forEach(m=>{let v=m.v===g?m.w:m.v,x=r.edge(v,g),b=x===void 0?0:x.weight;r.setEdge(v,g,{weight:a.edge(m).weight+b})}),Object.hasOwn(h,"minRank")&&r.setNode(g,{borderLeft:h.borderLeft[d],borderRight:h.borderRight[d]}))}),r}function l(a){for(var d;a.hasNode(d=o.uniqueId("_root")););return d}})),_l=q(((t,e)=>{e.exports=n;function n(o,i,l){let a={},d;l.forEach(s=>{let c=o.parent(s),u,r;for(;c;){if(u=o.parent(c),u?(r=a[u],a[u]=c):(r=d,d=c),r&&r!==c){i.setEdge(r,c);return}c=u}})}})),Ol=q(((t,e)=>{var n=El(),o=wl(),i=kl(),l=Ml(),a=_l(),d=ve().Graph,s=se();e.exports=c;function c(h,p){if(p&&typeof p.customOrder=="function"){p.customOrder(h,c);return}let m=s.maxRank(h),v=u(h,s.range(1,m+1),"inEdges"),x=u(h,s.range(m-1,-1,-1),"outEdges"),b=n(h);if(g(h,b),p&&p.disableOptimalOrderHeuristic)return;let N=1/0,f;for(let C=0,M=0;M<4;++C,++M){r(C%2?v:x,C%4>=2),b=s.buildLayerMatrix(h);let O=o(h,b);O<N&&(M=0,f=Object.assign({},b),N=O)}g(h,f)}function u(h,p,m){let v=new Map,x=(b,N)=>{v.has(b)||v.set(b,[]),v.get(b).push(N)};for(let b of h.nodes()){let N=h.node(b);if(typeof N.rank=="number"&&x(N.rank,b),typeof N.minRank=="number"&&typeof N.maxRank=="number")for(let f=N.minRank;f<=N.maxRank;f++)f!==N.rank&&x(f,b)}return p.map(function(b){return l(h,b,m,v.get(b)||[])})}function r(h,p){let m=new d;h.forEach(function(v){let x=v.graph().root,b=i(v,x,m,p);b.vs.forEach((N,f)=>v.node(N).order=f),a(v,m,b.vs)})}function g(h,p){Object.values(p).forEach(m=>m.forEach((v,x)=>h.node(v).order=x))}})),Pl=q(((t,e)=>{var n=ve().Graph,o=se();e.exports={positionX:m,findType1Conflicts:i,findType2Conflicts:l,addConflict:d,hasConflict:s,verticalAlignment:c,horizontalCompaction:u,alignCoordinates:h,findSmallestWidthAlignment:g,balance:p};function i(b,N){let f={};function C(M,O){let D=0,P=0,E=M.length,w=O[O.length-1];return O.forEach((_,k)=>{let S=a(b,_),R=S?b.node(S).order:E;(S||_===w)&&(O.slice(P,k+1).forEach(z=>{b.predecessors(z).forEach($=>{let F=b.node($),j=F.order;(j<D||R<j)&&!(F.dummy&&b.node(z).dummy)&&d(f,$,z)})}),P=k+1,D=R)}),O}return N.length&&N.reduce(C),f}function l(b,N){let f={};function C(O,D,P,E,w){let _;o.range(D,P).forEach(k=>{_=O[k],b.node(_).dummy&&b.predecessors(_).forEach(S=>{let R=b.node(S);R.dummy&&(R.order<E||R.order>w)&&d(f,S,_)})})}function M(O,D){let P=-1,E,w=0;return D.forEach((_,k)=>{if(b.node(_).dummy==="border"){let S=b.predecessors(_);S.length&&(E=b.node(S[0]).order,C(D,w,k,P,E),w=k,P=E)}C(D,w,D.length,E,O.length)}),D}return N.length&&N.reduce(M),f}function a(b,N){if(b.node(N).dummy)return b.predecessors(N).find(f=>b.node(f).dummy)}function d(b,N,f){if(N>f){let M=N;N=f,f=M}let C=b[N];C||(b[N]=C={}),C[f]=!0}function s(b,N,f){if(N>f){let C=N;N=f,f=C}return!!b[N]&&Object.hasOwn(b[N],f)}function c(b,N,f,C){let M={},O={},D={};return N.forEach(P=>{P.forEach((E,w)=>{M[E]=E,O[E]=E,D[E]=w})}),N.forEach(P=>{let E=-1;P.forEach(w=>{let _=C(w);if(_.length){_=_.sort((S,R)=>D[S]-D[R]);let k=(_.length-1)/2;for(let S=Math.floor(k),R=Math.ceil(k);S<=R;++S){let z=_[S];O[w]===w&&E<D[z]&&!s(f,w,z)&&(O[z]=w,O[w]=M[w]=M[z],E=D[z])}}})}),{root:M,align:O}}function u(b,N,f,C,M){let O={},D=r(b,N,f,M),P=M?"borderLeft":"borderRight";function E(k,S){let R=D.nodes(),z=R.pop(),$={};for(;z;)$[z]?k(z):($[z]=!0,R.push(z),R=R.concat(S(z))),z=R.pop()}function w(k){O[k]=D.inEdges(k).reduce((S,R)=>Math.max(S,O[R.v]+D.edge(R)),0)}function _(k){let S=D.outEdges(k).reduce((z,$)=>Math.min(z,O[$.w]-D.edge($)),1/0),R=b.node(k);S!==1/0&&R.borderType!==P&&(O[k]=Math.max(O[k],S))}return E(w,D.predecessors.bind(D)),E(_,D.successors.bind(D)),Object.keys(C).forEach(k=>O[k]=O[f[k]]),O}function r(b,N,f,C){let M=new n,O=b.graph(),D=v(O.nodesep,O.edgesep,C);return N.forEach(P=>{let E;P.forEach(w=>{let _=f[w];if(M.setNode(_),E){var k=f[E],S=M.edge(k,_);M.setEdge(k,_,Math.max(D(b,w,E),S||0))}E=w})}),M}function g(b,N){return Object.values(N).reduce((f,C)=>{let M=-1/0,O=1/0;Object.entries(C).forEach(([P,E])=>{let w=x(b,P)/2;M=Math.max(E+w,M),O=Math.min(E-w,O)});let D=M-O;return D<f[0]&&(f=[D,C]),f},[1/0,null])[1]}function h(b,N){let f=Object.values(N),C=o.applyWithChunking(Math.min,f),M=o.applyWithChunking(Math.max,f);["u","d"].forEach(O=>{["l","r"].forEach(D=>{let P=O+D,E=b[P];if(E===N)return;let w=Object.values(E),_=C-o.applyWithChunking(Math.min,w);D!=="l"&&(_=M-o.applyWithChunking(Math.max,w)),_&&(b[P]=o.mapValues(E,k=>k+_))})})}function p(b,N){return o.mapValues(b.ul,(f,C)=>{if(N)return b[N.toLowerCase()][C];{let M=Object.values(b).map(O=>O[C]).sort((O,D)=>O-D);return(M[1]+M[2])/2}})}function m(b){let N=o.buildLayerMatrix(b),f=Object.assign(i(b,N),l(b,N)),C={},M;return["u","d"].forEach(O=>{M=O==="u"?N:Object.values(N).reverse(),["l","r"].forEach(D=>{D==="r"&&(M=M.map(_=>Object.values(_).reverse()));let P=(O==="u"?b.predecessors:b.successors).bind(b),E=c(b,M,f,P),w=u(b,M,E.root,E.align,D==="r");D==="r"&&(w=o.mapValues(w,_=>-_)),C[O+D]=w})}),h(C,g(b,C)),p(C,b.graph().align)}function v(b,N,f){return(C,M,O)=>{let D=C.node(M),P=C.node(O),E=0,w;if(E+=D.width/2,Object.hasOwn(D,"labelpos"))switch(D.labelpos.toLowerCase()){case"l":w=-D.width/2;break;case"r":w=D.width/2;break}if(w&&(E+=f?w:-w),w=0,E+=(D.dummy?N:b)/2,E+=(P.dummy?N:b)/2,E+=P.width/2,Object.hasOwn(P,"labelpos"))switch(P.labelpos.toLowerCase()){case"l":w=P.width/2;break;case"r":w=-P.width/2;break}return w&&(E+=f?w:-w),w=0,E}}function x(b,N){return b.node(N).width}})),Dl=q(((t,e)=>{var n=se(),o=Pl().positionX;e.exports=i;function i(a){a=n.asNonCompoundGraph(a),l(a),Object.entries(o(a)).forEach(([d,s])=>a.node(d).x=s)}function l(a){let d=n.buildLayerMatrix(a),s=a.graph().ranksep,c=0;d.forEach(u=>{let r=u.reduce((g,h)=>{let p=a.node(h).height;return g>p?g:p},0);u.forEach(g=>a.node(g).y=c+r/2),c+=r+s})}})),Il=q(((t,e)=>{var n=gl(),o=ml(),i=pl(),l=se().normalizeRanks,a=yl(),d=se().removeEmptyRanks,s=vl(),c=bl(),u=xl(),r=Ol(),g=Dl(),h=se(),p=ve().Graph;e.exports=m;function m(I,A){let B=A&&A.debugTiming?h.time:h.notime;B("layout",()=>{let H=B("  buildLayoutGraph",()=>E(I));B("  runLayout",()=>v(H,B,A)),B("  updateInputGraph",()=>x(I,H))})}function v(I,A,B){A("    makeSpaceForEdgeLabels",()=>w(I)),A("    removeSelfEdges",()=>T(I)),A("    acyclic",()=>n.run(I)),A("    nestingGraph.run",()=>s.run(I)),A("    rank",()=>i(h.asNonCompoundGraph(I))),A("    injectEdgeLabelProxies",()=>_(I)),A("    removeEmptyRanks",()=>d(I)),A("    nestingGraph.cleanup",()=>s.cleanup(I)),A("    normalizeRanks",()=>l(I)),A("    assignRankMinMax",()=>k(I)),A("    removeEdgeLabelProxies",()=>S(I)),A("    normalize.run",()=>o.run(I)),A("    parentDummyChains",()=>a(I)),A("    addBorderSegments",()=>c(I)),A("    order",()=>r(I,B)),A("    insertSelfEdges",()=>V(I)),A("    adjustCoordinateSystem",()=>u.adjust(I)),A("    position",()=>g(I)),A("    positionSelfEdges",()=>X(I)),A("    removeBorderNodes",()=>j(I)),A("    normalize.undo",()=>o.undo(I)),A("    fixupEdgeLabelCoords",()=>$(I)),A("    undoCoordinateSystem",()=>u.undo(I)),A("    translateGraph",()=>R(I)),A("    assignNodeIntersects",()=>z(I)),A("    reversePoints",()=>F(I)),A("    acyclic.undo",()=>n.undo(I))}function x(I,A){I.nodes().forEach(B=>{let H=I.node(B),Z=A.node(B);H&&(H.x=Z.x,H.y=Z.y,H.rank=Z.rank,A.children(B).length&&(H.width=Z.width,H.height=Z.height))}),I.edges().forEach(B=>{let H=I.edge(B),Z=A.edge(B);H.points=Z.points,Object.hasOwn(Z,"x")&&(H.x=Z.x,H.y=Z.y)}),I.graph().width=A.graph().width,I.graph().height=A.graph().height}var b=["nodesep","edgesep","ranksep","marginx","marginy"],N={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},f=["acyclicer","ranker","rankdir","align"],C=["width","height","rank"],M={width:0,height:0},O=["minlen","weight","width","height","labeloffset"],D={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},P=["labelpos"];function E(I){let A=new p({multigraph:!0,compound:!0}),B=U(I.graph());return A.setGraph(Object.assign({},N,W(B,b),h.pick(B,f))),I.nodes().forEach(H=>{let Z=W(U(I.node(H)),C);Object.keys(M).forEach(G=>{Z[G]===void 0&&(Z[G]=M[G])}),A.setNode(H,Z),A.setParent(H,I.parent(H))}),I.edges().forEach(H=>{let Z=U(I.edge(H));A.setEdge(H,Object.assign({},D,W(Z,O),h.pick(Z,P)))}),A}function w(I){let A=I.graph();A.ranksep/=2,I.edges().forEach(B=>{let H=I.edge(B);H.minlen*=2,H.labelpos.toLowerCase()!=="c"&&(A.rankdir==="TB"||A.rankdir==="BT"?H.width+=H.labeloffset:H.height+=H.labeloffset)})}function _(I){I.edges().forEach(A=>{let B=I.edge(A);if(B.width&&B.height){let H=I.node(A.v),Z={rank:(I.node(A.w).rank-H.rank)/2+H.rank,e:A};h.addDummyNode(I,"edge-proxy",Z,"_ep")}})}function k(I){let A=0;I.nodes().forEach(B=>{let H=I.node(B);H.borderTop&&(H.minRank=I.node(H.borderTop).rank,H.maxRank=I.node(H.borderBottom).rank,A=Math.max(A,H.maxRank))}),I.graph().maxRank=A}function S(I){I.nodes().forEach(A=>{let B=I.node(A);B.dummy==="edge-proxy"&&(I.edge(B.e).labelRank=B.rank,I.removeNode(A))})}function R(I){let A=1/0,B=0,H=1/0,Z=0,G=I.graph(),ee=G.marginx||0,ae=G.marginy||0;function ge(oe){let J=oe.x,de=oe.y,te=oe.width,K=oe.height;A=Math.min(A,J-te/2),B=Math.max(B,J+te/2),H=Math.min(H,de-K/2),Z=Math.max(Z,de+K/2)}I.nodes().forEach(oe=>ge(I.node(oe))),I.edges().forEach(oe=>{let J=I.edge(oe);Object.hasOwn(J,"x")&&ge(J)}),A-=ee,H-=ae,I.nodes().forEach(oe=>{let J=I.node(oe);J.x-=A,J.y-=H}),I.edges().forEach(oe=>{let J=I.edge(oe);J.points.forEach(de=>{de.x-=A,de.y-=H}),Object.hasOwn(J,"x")&&(J.x-=A),Object.hasOwn(J,"y")&&(J.y-=H)}),G.width=B-A+ee,G.height=Z-H+ae}function z(I){I.edges().forEach(A=>{let B=I.edge(A),H=I.node(A.v),Z=I.node(A.w),G,ee;B.points?(G=B.points[0],ee=B.points[B.points.length-1]):(B.points=[],G=Z,ee=H),B.points.unshift(h.intersectRect(H,G)),B.points.push(h.intersectRect(Z,ee))})}function $(I){I.edges().forEach(A=>{let B=I.edge(A);if(Object.hasOwn(B,"x"))switch((B.labelpos==="l"||B.labelpos==="r")&&(B.width-=B.labeloffset),B.labelpos){case"l":B.x-=B.width/2+B.labeloffset;break;case"r":B.x+=B.width/2+B.labeloffset;break}})}function F(I){I.edges().forEach(A=>{let B=I.edge(A);B.reversed&&B.points.reverse()})}function j(I){I.nodes().forEach(A=>{if(I.children(A).length){let B=I.node(A),H=I.node(B.borderTop),Z=I.node(B.borderBottom),G=I.node(B.borderLeft[B.borderLeft.length-1]),ee=I.node(B.borderRight[B.borderRight.length-1]);B.width=Math.abs(ee.x-G.x),B.height=Math.abs(Z.y-H.y),B.x=G.x+B.width/2,B.y=H.y+B.height/2}}),I.nodes().forEach(A=>{I.node(A).dummy==="border"&&I.removeNode(A)})}function T(I){I.edges().forEach(A=>{if(A.v===A.w){var B=I.node(A.v);B.selfEdges||(B.selfEdges=[]),B.selfEdges.push({e:A,label:I.edge(A)}),I.removeEdge(A)}})}function V(I){h.buildLayerMatrix(I).forEach(A=>{var B=0;A.forEach((H,Z)=>{var G=I.node(H);G.order=Z+B,(G.selfEdges||[]).forEach(ee=>{h.addDummyNode(I,"selfedge",{width:ee.label.width,height:ee.label.height,rank:G.rank,order:Z+ ++B,e:ee.e,label:ee.label},"_se")}),delete G.selfEdges})})}function X(I){I.nodes().forEach(A=>{var B=I.node(A);if(B.dummy==="selfedge"){var H=I.node(B.e.v),Z=H.x+H.width/2,G=H.y,ee=B.x-Z,ae=H.height/2;I.setEdge(B.e,B.label),I.removeNode(A),B.label.points=[{x:Z+2*ee/3,y:G-ae},{x:Z+5*ee/6,y:G-ae},{x:Z+ee,y:G},{x:Z+5*ee/6,y:G+ae},{x:Z+2*ee/3,y:G+ae}],B.label.x=B.x,B.label.y=B.y}})}function W(I,A){return h.mapValues(h.pick(I,A),Number)}function U(I){var A={};return I&&Object.entries(I).forEach(([B,H])=>{typeof B=="string"&&(B=B.toLowerCase()),A[B]=H}),A}})),jl=q(((t,e)=>{var n=se(),o=ve().Graph;e.exports={debugOrdering:i};function i(l){let a=n.buildLayerMatrix(l),d=new o({compound:!0,multigraph:!0}).setGraph({});return l.nodes().forEach(s=>{d.setNode(s,{label:s}),d.setParent(s,"layer"+l.node(s).rank)}),l.edges().forEach(s=>d.setEdge(s.v,s.w,{},s.name)),a.forEach((s,c)=>{let u="layer"+c;d.setNode(u,{rank:"same"}),s.reduce((r,g)=>(d.setEdge(r,g,{style:"invis"}),g))}),d}})),Rl=q(((t,e)=>{e.exports="1.1.8"})),ar=q(((t,e)=>{e.exports={graphlib:ve(),layout:Il(),debug:jl(),util:{time:se().time,notime:se().notime},version:Rl()}}))(),ut=new ar.graphlib.Graph().setDefaultEdgeLabel(()=>({}));const ir=({nodes:t,edges:e,direction:n})=>(ut.setGraph({rankdir:n,nodesep:150,ranksep:200,ranker:"longest-path"}),e.forEach(o=>ut.setEdge(o.source,o.target)),t.forEach(o=>ut.setNode(o.id,{...o,width:o.width??0,height:o.height??0})),(0,ar.layout)(ut),{nodes:t.map(o=>{let{x:i,y:l}=ut.node(o.id);return{...o,position:{x:i,y:l}}}),edges:e});var Al=Re(),sr=new Vs;const Bl=t=>{let e=(0,Al.c)(43),{cellIds:n,variables:o,cellAtoms:i,children:l,layoutDirection:a,settings:d}=t,s;e[0]!==i||e[1]!==n||e[2]!==a||e[3]!==d.hidePureMarkdown||e[4]!==o?(s=()=>{let j=sr.createElements(n,i,o,d.hidePureMarkdown);return j=ir({nodes:j.nodes,edges:j.edges,direction:a}),j},e[0]=i,e[1]=n,e[2]=a,e[3]=d.hidePureMarkdown,e[4]=o,e[5]=s):s=e[5];let[c]=(0,y.useState)(s),[u,r,g]=Vo(c.nodes),[h,p,m]=Xo(c.edges),v=lt(),x;e[6]!==a||e[7]!==p||e[8]!==r?(x=j=>{let T=ir({nodes:j.nodes,edges:j.edges,direction:a});r(T.nodes),p(T.edges)},e[6]=a,e[7]=p,e[8]=r,e[9]=x):x=e[9];let b=Sn(x),N,f;e[10]!==i||e[11]!==n||e[12]!==d.hidePureMarkdown||e[13]!==b||e[14]!==o?(N=()=>{b(sr.createElements(n,i,o,d.hidePureMarkdown))},f=[n,o,i,b,d.hidePureMarkdown],e[10]=i,e[11]=n,e[12]=d.hidePureMarkdown,e[13]=b,e[14]=o,e[15]=N,e[16]=f):(N=e[15],f=e[16]),(0,y.useEffect)(N,f);let[C,M]=(0,y.useState)();Uo();let O;e[17]===Symbol.for("react.memo_cache_sentinel")?(O=()=>{M(void 0)},e[17]=O):O=e[17];let D=O,P,E,w;e[18]===Symbol.for("react.memo_cache_sentinel")?(P={minZoom:.5,maxZoom:1.5},E=(j,T)=>{M({type:"node",id:T.id})},w=(j,T)=>{let{source:V,target:X}=T;M({type:"edge",source:V,target:X})},e[18]=P,e[19]=E,e[20]=w):(P=e[18],E=e[19],w=e[20]);let _;e[21]===Symbol.for("react.memo_cache_sentinel")?(_=(0,L.jsx)($s,{color:"#ccc",variant:ye.Dots}),e[21]=_):_=e[21];let k;e[22]!==v||e[23]!==u?(k=()=>{let j=ht.get(va);if(j){let T=u.find(V=>V.id===j);T&&(v.fitView({padding:1,duration:600,nodes:[T]}),M({type:"node",id:j}))}},e[22]=v,e[23]=u,e[24]=k):k=e[24];let S;e[25]===Symbol.for("react.memo_cache_sentinel")?(S=(0,L.jsx)(_a,{className:"size-4"}),e[25]=S):S=e[25];let R;e[26]===k?R=e[27]:(R=(0,L.jsx)(js,{position:"bottom-right",showInteractive:!1,children:(0,L.jsx)(ha,{content:"Jump to focused cell",delayDuration:200,side:"left",asChild:!1,children:(0,L.jsx)(et,{onMouseDown:na.preventFocus,onClick:k,children:S})})}),e[26]=k,e[27]=R);let z;e[28]!==h||e[29]!==C||e[30]!==o?(z=(0,L.jsx)(_t,{selection:C,variables:o,edges:h,onClearSelection:D}),e[28]=h,e[29]=C,e[30]=o,e[31]=z):z=e[31];let $;e[32]!==l||e[33]!==h||e[34]!==u||e[35]!==m||e[36]!==g||e[37]!==R||e[38]!==z?($=(0,L.jsxs)(cn,{nodes:u,edges:h,nodeTypes:Ko,minZoom:.2,fitViewOptions:P,onNodeClick:E,onEdgeClick:w,onNodeDoubleClick:zl,fitView:!0,onNodesChange:g,onEdgesChange:m,zoomOnDoubleClick:!1,nodesConnectable:!1,children:[_,R,z,l]}),e[32]=l,e[33]=h,e[34]=u,e[35]=m,e[36]=g,e[37]=R,e[38]=z,e[39]=$):$=e[39];let F;return e[40]!==a||e[41]!==$?(F=(0,L.jsx)(Zo,{value:a,children:$}),e[40]=a,e[41]=$,e[42]=F):F=e[42],F};function zl(t,e){Cn(e.id,"focus")}var Ll=Re(),$l=yn("_minimap_"),Tl=yn({hidePureMarkdown:!0});const Hl=t=>{let e=(0,Ll.c)(11),[n,o]=vn($l),[i,l]=vn(Tl),a;e[0]!==n||e[1]!==t||e[2]!==o||e[3]!==l||e[4]!==i?(a=()=>n==="_minimap_"?(0,L.jsx)(Gs,{...t,children:(0,L.jsx)(hn,{settings:i,onSettingsChange:l,view:n,onChange:o})}):(0,L.jsx)(Bl,{...t,settings:i,layoutDirection:n,children:(0,L.jsx)(hn,{settings:i,onSettingsChange:l,view:n,onChange:o})}),e[0]=n,e[1]=t,e[2]=o,e[3]=l,e[4]=i,e[5]=a):a=e[5];let d=a,s;e[6]===d?s=e[7]:(s=d(),e[6]=d,e[7]=s);let c;return e[8]!==n||e[9]!==s?(c=(0,L.jsx)(dn,{children:s},n),e[8]=n,e[9]=s,e[10]=c):c=e[10],c};var Vl=Re(),Xl=()=>{let t=(0,Vl.c)(5),e=Qr(),n=bn(),[o]=Kr(),i;t[0]===Symbol.for("react.memo_cache_sentinel")?(i=xn("w-full h-full flex-1 mx-auto -mb-4 relative"),t[0]=i):i=t[0];let l;return t[1]!==n.inOrderIds||t[2]!==o||t[3]!==e?(l=(0,L.jsx)("div",{className:i,children:(0,L.jsx)(Hl,{cellAtoms:o,variables:e,cellIds:n.inOrderIds})}),t[1]=n.inOrderIds,t[2]=o,t[3]=e,t[4]=l):l=t[4],l};export{Xl as default};
