import{s as A}from"./chunk-LvLJmgfZ.js";import{u as re}from"./useEvent-BhXAndur.js";import{t as ae}from"./react-Bj1aDYRI.js";import{Mt as oe,w as ie,wt as le}from"./cells-DPp5cDaO.js";import{t as q}from"./compiler-runtime-B3qBwwSJ.js";import{o as se}from"./utils-YqBXNpsM.js";import{t as ce}from"./jsx-runtime-ZmTK25f3.js";import{t as D}from"./button-CZ3Cs4qb.js";import{at as ue}from"./dist-DBwNzi3C.js";import{t as P}from"./createLucideIcon-BCdY6lG5.js";import{n as he,t as me}from"./LazyAnyLanguageCodeMirror-DgZ8iknE.js";import{r as pe}from"./useTheme-DQozhcp1.js";import{t as fe}from"./copy-DHrHayPa.js";import{c as v,d as de,f as ge,g as xe,h as ye,l as we,m as C,o as ve,p as ke,s as N}from"./chunk-5FQGJX7Z-DPlx2kjA.js";import{c as I}from"./katex-CDLTCvjQ.js";import{r as be}from"./html-to-image-CIQqSu-S.js";import{o as Fe}from"./focus-C1YokgL7.js";var Ne=P("chevrons-up-down",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]),Te=P("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]),Ce=q(),b=A(ae(),1),_={};function Ee(e){let t=(0,Ce.c)(5),[r,n]=(0,b.useState)(_[e]??!1),a;t[0]===e?a=t[1]:(a=i=>{n(i),_[e]=i},t[0]=e,t[1]=a);let o;return t[2]!==r||t[3]!==a?(o=[r,a],t[2]=r,t[3]=a,t[4]=o):o=t[4],o}function Se(e){return e==null||e.data==null||e.data===""}function Me(e,t){return`data:${t};base64,${e}`}function $e(e){return e.startsWith("data:")&&e.includes(";base64,")}function je(e){return e.split(",")[1]}function Ae(e){let t=globalThis.atob(e),r=t.length,n=new Uint8Array(r);for(let a=0;a<r;a++)n[a]=t.charCodeAt(a);return n}const B=Uint8Array.fromBase64??Ae;function z(e){let t=B(e);return new DataView(t.buffer)}function qe(e){let t="",r=e.length;for(let n=0;n<r;n++)t+=String.fromCharCode(e[n]);return globalThis.btoa(t)}const De=Uint8Array.prototype.toBase64?e=>e.toBase64():qe;function Pe(e){return De(new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function Ie(e){return(e.buffers??[]).map(z)}function _e(e,t){return O(e,t||{})||{type:"root",children:[]}}function O(e,t){let r=Be(e,t);return r&&t.afterTransform&&t.afterTransform(e,r),r}function Be(e,t){switch(e.nodeType){case 1:return Ue(e,t);case 3:return Oe(e);case 8:return Ve(e);case 9:return V(e,t);case 10:return ze();case 11:return V(e,t);default:return}}function V(e,t){return{type:"root",children:U(e,t)}}function ze(){return{type:"doctype"}}function Oe(e){return{type:"text",value:e.nodeValue||""}}function Ve(e){return{type:"comment",value:e.nodeValue||""}}function Ue(e,t){let r=e.namespaceURI,n=r===C.svg?xe:ye,a=r===C.html?e.tagName.toLowerCase():e.tagName,o=r===C.html&&a==="template"?e.content:e,i=e.getAttributeNames(),s={},l=-1;for(;++l<i.length;)s[i[l]]=e.getAttribute(i[l])||"";return n(a,s,U(o,t))}function U(e,t){let r=e.childNodes,n=[],a=-1;for(;++a<r.length;){let o=O(r[a],t);o!==void 0&&n.push(o)}return n}var Le=new DOMParser;function Re(e,t){return _e(t!=null&&t.fragment?We(e):Le.parseFromString(e,"text/html"))}function We(e){let t=document.createElement("template");return t.innerHTML=e,t.content}const L=(function(e,t,r){let n=ke(r);if(!e||!e.type||!e.children)throw Error("Expected parent node");if(typeof t=="number"){if(t<0||t===1/0)throw Error("Expected positive finite number as index")}else if(t=e.children.indexOf(t),t<0)throw Error("Expected child node or index");for(;++t<e.children.length;)if(n(e.children[t],t,e))return e.children[t]}),k=(function(e){if(e==null)return Qe;if(typeof e=="string")return Ke(e);if(typeof e=="object")return He(e);if(typeof e=="function")return E(e);throw Error("Expected function, string, or array as `test`")});function He(e){let t=[],r=-1;for(;++r<e.length;)t[r]=k(e[r]);return E(n);function n(...a){let o=-1;for(;++o<t.length;)if(t[o].apply(this,a))return!0;return!1}}function Ke(e){return E(t);function t(r){return r.tagName===e}}function E(e){return t;function t(r,n,a){return!!(Xe(r)&&e.call(this,r,typeof n=="number"?n:void 0,a||void 0))}}function Qe(e){return!!(e&&typeof e=="object"&&"type"in e&&e.type==="element"&&"tagName"in e&&typeof e.tagName=="string")}function Xe(e){return typeof e=="object"&&!!e&&"type"in e&&"tagName"in e}var R=/\n/g,W=/[\t ]+/g,S=k("br"),H=k(rt),Ge=k("p"),K=k("tr"),Je=k(["datalist","head","noembed","noframes","noscript","rp","script","style","template","title",nt,at]),Q=k("address.article.aside.blockquote.body.caption.center.dd.dialog.dir.dl.dt.div.figure.figcaption.footer.form,.h1.h2.h3.h4.h5.h6.header.hgroup.hr.html.legend.li.listing.main.menu.nav.ol.p.plaintext.pre.section.ul.xmp".split("."));function Ye(e,t){let r=t||{},n="children"in e?e.children:[],a=Q(e),o=J(e,{whitespace:r.whitespace||"normal",breakBefore:!1,breakAfter:!1}),i=[];(e.type==="text"||e.type==="comment")&&i.push(...G(e,{whitespace:o,breakBefore:!0,breakAfter:!0}));let s=-1;for(;++s<n.length;)i.push(...X(n[s],e,{whitespace:o,breakBefore:s?void 0:a,breakAfter:s<n.length-1?S(n[s+1]):a}));let l=[],h;for(s=-1;++s<i.length;){let m=i[s];typeof m=="number"?h!==void 0&&m>h&&(h=m):m&&(h!==void 0&&h>-1&&l.push(`
`.repeat(h)||" "),h=-1,l.push(m))}return l.join("")}function X(e,t,r){return e.type==="element"?Ze(e,t,r):e.type==="text"?r.whitespace==="normal"?G(e,r):et(e):[]}function Ze(e,t,r){let n=J(e,r),a=e.children||[],o=-1,i=[];if(Je(e))return i;let s,l;for(S(e)||K(e)&&L(t,e,K)?l=`
`:Ge(e)?(s=2,l=2):Q(e)&&(s=1,l=1);++o<a.length;)i=i.concat(X(a[o],e,{whitespace:n,breakBefore:o?void 0:s,breakAfter:o<a.length-1?S(a[o+1]):l}));return H(e)&&L(t,e,H)&&i.push("	"),s&&i.unshift(s),l&&i.push(l),i}function G(e,t){let r=String(e.value),n=[],a=[],o=0;for(;o<=r.length;){R.lastIndex=o;let l=R.exec(r),h=l&&"index"in l?l.index:r.length;n.push(tt(r.slice(o,h).replace(/[\u061C\u200E\u200F\u202A-\u202E\u2066-\u2069]/g,""),o===0?t.breakBefore:!0,h===r.length?t.breakAfter:!0)),o=h+1}let i=-1,s;for(;++i<n.length;)n[i].charCodeAt(n[i].length-1)===8203||i<n.length-1&&n[i+1].charCodeAt(0)===8203?(a.push(n[i]),s=void 0):n[i]?(typeof s=="number"&&a.push(s),a.push(n[i]),s=0):(i===0||i===n.length-1)&&a.push(0);return a}function et(e){return[String(e.value)]}function tt(e,t,r){let n=[],a=0,o;for(;a<e.length;){W.lastIndex=a;let i=W.exec(e);o=i?i.index:e.length,!a&&!o&&i&&!t&&n.push(""),a!==o&&n.push(e.slice(a,o)),a=i?o+i[0].length:o}return a!==o&&!r&&n.push(""),n.join(" ")}function J(e,t){if(e.type==="element"){let r=e.properties||{};switch(e.tagName){case"listing":case"plaintext":case"xmp":return"pre";case"nobr":return"nowrap";case"pre":return r.wrap?"pre-wrap":"pre";case"td":case"th":return r.noWrap?"nowrap":t.whitespace;case"textarea":return"pre-wrap";default:}}return t.whitespace}function nt(e){return!!(e.properties||{}).hidden}function rt(e){return e.tagName==="td"||e.tagName==="th"}function at(e){return e.tagName==="dialog"&&!(e.properties||{}).open}var ot={},it=[];function lt(e){let t=e||ot;return function(r,n){ge(r,"element",function(a,o){let i=Array.isArray(a.properties.className)?a.properties.className:it,s=i.includes("language-math"),l=i.includes("math-display"),h=i.includes("math-inline"),m=l;if(!s&&!l&&!h)return;let p=o[o.length-1],d=a;if(a.tagName==="code"&&s&&p&&p.type==="element"&&p.tagName==="pre"&&(d=p,p=o[o.length-2],m=!0),!p)return;let f=Ye(d,{whitespace:"pre"}),c;try{c=I.renderToString(f,{...t,displayMode:m,throwOnError:!0})}catch(w){let F=w,u=F.name.toLowerCase();n.message("Could not render math with KaTeX",{ancestors:[...o,a],cause:F,place:a.position,ruleId:u,source:"rehype-katex"});try{c=I.renderToString(f,{...t,displayMode:m,strict:"ignore",throwOnError:!1})}catch{c=[{type:"element",tagName:"span",properties:{className:["katex-error"],style:"color:"+(t.errorColor||"#cc0000"),title:String(w)},children:[{type:"text",value:f}]}]}}typeof c=="string"&&(c=Re(c,{fragment:!0}).children);let g=p.children.indexOf(d);return p.children.splice(g,1,...c),de})}}function st(){return{enter:{mathFlow:e,mathFlowFenceMeta:t,mathText:o},exit:{mathFlow:a,mathFlowFence:n,mathFlowFenceMeta:r,mathFlowValue:s,mathText:i,mathTextData:s}};function e(l){this.enter({type:"math",meta:null,value:"",data:{hName:"pre",hChildren:[{type:"element",tagName:"code",properties:{className:["language-math","math-display"]},children:[]}]}},l)}function t(){this.buffer()}function r(){let l=this.resume(),h=this.stack[this.stack.length-1];h.type,h.meta=l}function n(){this.data.mathFlowInside||(this.buffer(),this.data.mathFlowInside=!0)}function a(l){let h=this.resume().replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),m=this.stack[this.stack.length-1];m.type,this.exit(l),m.value=h;let p=m.data.hChildren[0];p.type,p.tagName,p.children.push({type:"text",value:h}),this.data.mathFlowInside=void 0}function o(l){this.enter({type:"inlineMath",value:"",data:{hName:"code",hProperties:{className:["language-math","math-inline"]},hChildren:[]}},l),this.buffer()}function i(l){let h=this.resume(),m=this.stack[this.stack.length-1];m.type,this.exit(l),m.value=h,m.data.hChildren.push({type:"text",value:h})}function s(l){this.config.enter.data.call(this,l),this.config.exit.data.call(this,l)}}function ct(e){let t=(e||{}).singleDollarTextMath;return t??(t=!0),n.peek=a,{unsafe:[{character:"\r",inConstruct:"mathFlowMeta"},{character:`
`,inConstruct:"mathFlowMeta"},{character:"$",after:t?void 0:"\\$",inConstruct:"phrasing"},{character:"$",inConstruct:"mathFlowMeta"},{atBreak:!0,character:"$",after:"\\$"}],handlers:{math:r,inlineMath:n}};function r(o,i,s,l){let h=o.value||"",m=s.createTracker(l),p="$".repeat(Math.max(we(h,"$")+1,2)),d=s.enter("mathFlow"),f=m.move(p);if(o.meta){let c=s.enter("mathFlowMeta");f+=m.move(s.safe(o.meta,{after:`
`,before:f,encode:["$"],...m.current()})),c()}return f+=m.move(`
`),h&&(f+=m.move(h+`
`)),f+=m.move(p),d(),f}function n(o,i,s){let l=o.value||"",h=1;for(t||h++;RegExp("(^|[^$])"+"\\$".repeat(h)+"([^$]|$)").test(l);)h++;let m="$".repeat(h);/[^ \r\n]/.test(l)&&(/^[ \r\n]/.test(l)&&/[ \r\n]$/.test(l)||/^\$|\$$/.test(l))&&(l=" "+l+" ");let p=-1;for(;++p<s.unsafe.length;){let d=s.unsafe[p];if(!d.atBreak)continue;let f=s.compilePattern(d),c;for(;c=f.exec(l);){let g=c.index;l.codePointAt(g)===10&&l.codePointAt(g-1)===13&&g--,l=l.slice(0,g)+" "+l.slice(c.index+1)}}return m+l+m}function a(){return"$"}}const ut={tokenize:ht,concrete:!0,name:"mathFlow"};var Y={tokenize:mt,partial:!0};function ht(e,t,r){let n=this,a=n.events[n.events.length-1],o=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,i=0;return s;function s(u){return e.enter("mathFlow"),e.enter("mathFlowFence"),e.enter("mathFlowFenceSequence"),l(u)}function l(u){return u===36?(e.consume(u),i++,l):i<2?r(u):(e.exit("mathFlowFenceSequence"),N(e,h,"whitespace")(u))}function h(u){return u===null||v(u)?p(u):(e.enter("mathFlowFenceMeta"),e.enter("chunkString",{contentType:"string"}),m(u))}function m(u){return u===null||v(u)?(e.exit("chunkString"),e.exit("mathFlowFenceMeta"),p(u)):u===36?r(u):(e.consume(u),m)}function p(u){return e.exit("mathFlowFence"),n.interrupt?t(u):e.attempt(Y,d,w)(u)}function d(u){return e.attempt({tokenize:F,partial:!0},w,f)(u)}function f(u){return(o?N(e,c,"linePrefix",o+1):c)(u)}function c(u){return u===null?w(u):v(u)?e.attempt(Y,d,w)(u):(e.enter("mathFlowValue"),g(u))}function g(u){return u===null||v(u)?(e.exit("mathFlowValue"),c(u)):(e.consume(u),g)}function w(u){return e.exit("mathFlow"),t(u)}function F(u,ee,M){let $=0;return N(u,te,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4);function te(y){return u.enter("mathFlowFence"),u.enter("mathFlowFenceSequence"),j(y)}function j(y){return y===36?($++,u.consume(y),j):$<i?M(y):(u.exit("mathFlowFenceSequence"),N(u,ne,"whitespace")(y))}function ne(y){return y===null||v(y)?(u.exit("mathFlowFence"),ee(y)):M(y)}}}function mt(e,t,r){let n=this;return a;function a(i){return i===null?t(i):(e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),o)}function o(i){return n.parser.lazy[n.now().line]?r(i):t(i)}}function pt(e){let t=(e||{}).singleDollarTextMath;return t??(t=!0),{tokenize:r,resolve:ft,previous:dt,name:"mathText"};function r(n,a,o){let i=0,s,l;return h;function h(c){return n.enter("mathText"),n.enter("mathTextSequence"),m(c)}function m(c){return c===36?(n.consume(c),i++,m):i<2&&!t?o(c):(n.exit("mathTextSequence"),p(c))}function p(c){return c===null?o(c):c===36?(l=n.enter("mathTextSequence"),s=0,f(c)):c===32?(n.enter("space"),n.consume(c),n.exit("space"),p):v(c)?(n.enter("lineEnding"),n.consume(c),n.exit("lineEnding"),p):(n.enter("mathTextData"),d(c))}function d(c){return c===null||c===32||c===36||v(c)?(n.exit("mathTextData"),p(c)):(n.consume(c),d)}function f(c){return c===36?(n.consume(c),s++,f):s===i?(n.exit("mathTextSequence"),n.exit("mathText"),a(c)):(l.type="mathTextData",d(c))}}}function ft(e){let t=e.length-4,r=3,n,a;if((e[r][1].type==="lineEnding"||e[r][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(n=r;++n<t;)if(e[n][1].type==="mathTextData"){e[t][1].type="mathTextPadding",e[r][1].type="mathTextPadding",r+=2,t-=2;break}}for(n=r-1,t++;++n<=t;)a===void 0?n!==t&&e[n][1].type!=="lineEnding"&&(a=n):(n===t||e[n][1].type==="lineEnding")&&(e[a][1].type="mathTextData",n!==a+2&&(e[a][1].end=e[n-1][1].end,e.splice(a+2,n-a-2),t-=n-a-2,n=a+2),a=void 0);return e}function dt(e){return e!==36||this.events[this.events.length-1][1].type==="characterEscape"}function gt(e){return{flow:{36:ut},text:{36:pt(e)}}}var xt={};function yt(e){let t=this,r=e||xt,n=t.data(),a=n.micromarkExtensions||(n.micromarkExtensions=[]),o=n.fromMarkdownExtensions||(n.fromMarkdownExtensions=[]),i=n.toMarkdownExtensions||(n.toMarkdownExtensions=[]);a.push(gt(r)),o.push(st()),i.push(ct(r))}function wt(e={}){return{name:"katex",type:"math",remarkPlugin:[yt,{singleDollarTextMath:e.singleDollarTextMath??!1}],rehypePlugin:[lt,{errorColor:e.errorColor??"var(--color-muted-foreground)"}],getStyles(){return"katex/dist/katex.min.css"}}}var vt=wt(),T=q(),x=A(ce(),1),kt=[ue.lineWrapping],bt=new Set(["python","markdown","sql","json","yaml","toml","shell","javascript","typescript","jsx","tsx","css","html"]);function Ft(e,t){return e?e==="python"?{language:e,code:t}:e==="sql"?{language:"python",code:le.fromQuery(t)}:e==="markdown"?{language:"python",code:oe.fromMarkdown(t)}:e==="shell"||e==="bash"?{language:"python",code:`import subprocess
subprocess.run("${t}")`}:{language:"python",code:`_${e} = """
${t}
"""`}:{language:"python",code:t}}var Nt=e=>{let t=(0,T.c)(9),{code:r,language:n}=e,{createNewCell:a}=ie(),o=Fe(),i=re(se),s;t[0]!==i||t[1]!==r||t[2]!==a||t[3]!==n||t[4]!==o?(s=()=>{let p=Ft(n,r);n==="sql"&&be({autoInstantiate:i,createNewCell:a,fromCellId:o}),a({code:p.code,before:!1,cellId:o??"__end__"})},t[0]=i,t[1]=r,t[2]=a,t[3]=n,t[4]=o,t[5]=s):s=t[5];let l=s,h;t[6]===Symbol.for("react.memo_cache_sentinel")?(h=(0,x.jsx)(he,{className:"ml-2 h-4 w-4"}),t[6]=h):h=t[6];let m;return t[7]===l?m=t[8]:(m=(0,x.jsxs)(D,{size:"xs",variant:"outline",onClick:l,children:["Add to Notebook",h]}),t[7]=l,t[8]=m),m},Tt=e=>{let t=(0,T.c)(17),{code:r,language:n}=e,{theme:a}=pe(),[o,i]=(0,b.useState)(r);o!==r&&i(r);let s;t[0]===o?s=t[1]:(s=async()=>{await fe(o)},t[0]=o,t[1]=s);let l=s,h=a==="dark"?"dark":"light",m=n&&bt.has(n)?n:void 0,p;t[2]!==h||t[3]!==m||t[4]!==o?(p=(0,x.jsx)(b.Suspense,{children:(0,x.jsx)(me,{theme:h,language:m,className:"cm border rounded overflow-hidden",extensions:kt,value:o,onChange:i})}),t[2]=h,t[3]=m,t[4]=o,t[5]=p):p=t[5];let d;t[6]===l?d=t[7]:(d=(0,x.jsx)(Ct,{size:"xs",variant:"outline",onClick:l,children:"Copy"}),t[6]=l,t[7]=d);let f;t[8]!==n||t[9]!==o?(f=(0,x.jsx)(Nt,{code:o,language:n}),t[8]=n,t[9]=o,t[10]=f):f=t[10];let c;t[11]!==d||t[12]!==f?(c=(0,x.jsxs)("div",{className:"flex justify-end mt-2 space-x-2",children:[d,f]}),t[11]=d,t[12]=f,t[13]=c):c=t[13];let g;return t[14]!==p||t[15]!==c?(g=(0,x.jsxs)("div",{className:"relative",children:[p,c]}),t[14]=p,t[15]=c,t[16]=g):g=t[16],g},Ct=e=>{let t=(0,T.c)(9),r,n;t[0]===e?(r=t[1],n=t[2]):({onClick:r,...n}=e,t[0]=e,t[1]=r,t[2]=n);let[a,o]=(0,b.useState)(!1),i;t[3]===r?i=t[4]:(i=h=>{r==null||r(h),o(!0),setTimeout(()=>o(!1),1e3)},t[3]=r,t[4]=i);let s=a?"Copied":"Copy",l;return t[5]!==n||t[6]!==i||t[7]!==s?(l=(0,x.jsx)(D,{...n,onClick:i,children:s}),t[5]=n,t[6]=i,t[7]=s,t[8]=l):l=t[8],l},Et={code:({children:e,className:t})=>{let r=t==null?void 0:t.replace("language-","");if(r&&typeof e=="string"){let n=e.trim();return(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"text-xs text-muted-foreground pl-1",children:r}),(0,x.jsx)(Tt,{code:n,language:r})]})}return(0,x.jsx)("code",{className:t,children:e})}};const Z=(0,b.memo)(e=>{let t=(0,T.c)(3),{content:r}=e,n;t[0]===Symbol.for("react.memo_cache_sentinel")?(n={math:vt},t[0]=n):n=t[0];let a;return t[1]===r?a=t[2]:(a=(0,x.jsx)(ve,{components:Et,plugins:n,className:"mo-markdown-renderer",children:r}),t[1]=r,t[2]=a),a});Z.displayName="MarkdownRenderer";export{Pe as a,Ie as c,Te as d,Ne as f,B as i,Se as l,Me as n,je as o,z as r,$e as s,Z as t,Ee as u};
