import{s as D}from"./chunk-LvLJmgfZ.js";import{n as m}from"./jotai-D74Ef_p1.js";import{_ as u,w as p,y as I}from"./cells-B1ds6ZjK.js";import{t as h}from"./compiler-runtime-QczY1yfQ.js";import{t as _}from"./useEventListener-BMXqdHZ5.js";import{t as v}from"./jsx-runtime-B4_2-8Ho.js";import{t as w}from"./button-BtVgadIf.js";import{r as C}from"./requests-CMMs4cl8.js";import{t as y}from"./use-toast-CTk3v2Fk.js";import{n as b}from"./useEvent-bc5jSpSz.js";import{n as x}from"./renderShortcut-CF5R2n1d.js";var j=h(),d=D(v(),1);const f=e=>{let t=(0,j.c)(7),l;t[0]===e?l=t[1]:(l=n=>{var i;(n.ctrlKey||n.metaKey)&&n.key==="z"&&(n.preventDefault(),n.stopPropagation(),(i=e.onClick)==null||i.call(e,n))},t[0]=e,t[1]=l);let r;t[2]===Symbol.for("react.memo_cache_sentinel")?(r={capture:!0},t[2]=r):r=t[2],_(window,"keydown",l,r);let o=e.children??"Undo",s;t[3]===Symbol.for("react.memo_cache_sentinel")?(s=(0,d.jsx)(x,{className:"ml-2",shortcut:"cmd-z"}),t[3]=s):s=t[3];let a;return t[4]!==o||t[5]!==e?(a=(0,d.jsxs)(w,{"data-testid":"undo-button",size:"sm",variant:"outline",...e,children:[o," ",s]}),t[4]=o,t[5]=e,t[6]=a):a=t[6],a};var g=h();function z(){let e=(0,g.c)(4),{deleteCell:t,undoDeleteCell:l}=p(),{sendDeleteCell:r}=C(),o;return e[0]!==t||e[1]!==r||e[2]!==l?(o=s=>{var i;if(m.get(u))return;let{cellId:a}=s,n=(((i=m.get(I).cellData[a])==null?void 0:i.code)??"").trim()==="";if(t({cellId:a}),r({cellId:a}).catch(()=>{l()}),!n){let{dismiss:c}=y({title:"Cell deleted",description:"You can bring it back by clicking undo or through the command palette.",action:(0,d.jsx)(f,{"data-testid":"undo-delete-button",onClick:()=>{l(),k()}})}),k=c}},e[0]=t,e[1]=r,e[2]=l,e[3]=o):o=e[3],b(o)}function K(){let e=(0,g.c)(4),{deleteCell:t,undoDeleteCell:l}=p(),{sendDeleteCell:r}=C(),o;return e[0]!==t||e[1]!==r||e[2]!==l?(o=async s=>{if(m.get(u))return;let{cellIds:a}=s;for(let c of a)await r({cellId:c}).then(()=>{t({cellId:c})});let{dismiss:n}=y({title:"Cells deleted",action:(0,d.jsx)(f,{"data-testid":"undo-delete-button",onClick:()=>{for(let c of a)l();i()}})}),i=n},e[0]=t,e[1]=r,e[2]=l,e[3]=o):o=e[3],b(o)}export{K as n,f as r,z as t};
