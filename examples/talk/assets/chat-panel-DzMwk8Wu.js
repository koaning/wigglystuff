import{s as Je}from"./chunk-LvLJmgfZ.js";import{d as kt,f as Lt,l as It,n as ue,u as Ue}from"./useEvent-BhXAndur.js";import{t as Pt}from"./react-Bj1aDYRI.js";import{Kn as Dt,w as zt}from"./cells-DPp5cDaO.js";import"./react-dom-CSu739Rf.js";import{t as Qe}from"./compiler-runtime-B3qBwwSJ.js";import{T as Mt,o as Ft,r as Ze,t as Ht,w as Wt}from"./ai-model-dropdown-Dk2SdB3C.js";import{d as Ae}from"./hotkeys-BHHWjLlp.js";import{n as et,r as Ot}from"./utils-YqBXNpsM.js";import{o as Ut}from"./config-Q0O7_stz.js";import{r as le}from"./useEventListener-Cb-RVVEn.js";import{t as Yt}from"./jsx-runtime-ZmTK25f3.js";import{t as oe}from"./button-CZ3Cs4qb.js";import{t as ae}from"./cn-BKtXLv3a.js";import"./dist-DBwNzi3C.js";import"./cjs-CH5Rj0g8.js";import"./main-U5Goe76G.js";import"./useNonce-CS26E0hA.js";import{r as Xt}from"./requests-B4FYHTZl.js";import{t as tt}from"./createLucideIcon-BCdY6lG5.js";import{C as Vt,N as Bt,O as qt,T as $t,_ as Kt,b as Gt,c as Jt,d as Qt,f as Zt,g as er,h as rt,j as tr,l as rr,m as lr,n as lt,p as or,s as ot,u as ar,v as nr,y as sr}from"./add-cell-with-ai-e_HMl7UU.js";import{t as at}from"./bot-message-square-B2ThzDUZ.js";import{d as ir}from"./markdown-renderer-DJy8ww5d.js";import{n as cr}from"./spinner-DA8-7wQv.js";import{t as dr}from"./plus-B7DF33lD.js";import{lt as ur,r as pr}from"./input-DUrq2DiR.js";import{t as mr}from"./settings-OBbrbhij.js";import{r as nt,t as hr}from"./state-D4T75eZb.js";import"./dist-bBwmhqty.js";import"./dist-Btv5Rh1v.js";import"./dist-Dcqqg9UU.js";import"./dist-sMh6mJ2d.js";import"./dist-CoCQUAeM.js";import"./session-BOFn9QrD.js";import{C as fr,E as xr,_ as pe,g as X,w as V,x as _e}from"./Combination-BAEdC-rz.js";import{a as vr,i as gr,n as wr,p as br,r as yr,s as jr,t as Sr}from"./select-BVdzZKAh.js";import{i as st,t as Ye}from"./tooltip-CMQz28hC.js";import{u as Cr}from"./menu-items-BMjcEb2j.js";import{i as Nr}from"./dates-CrvjILe3.js";import{t as Rr}from"./context-BfYAMNLF.js";import{i as Tr,r as Ar,t as _r}from"./popover-CH1FzjxU.js";import{t as Er}from"./copy-icon-v8ME_JKB.js";import{n as kr}from"./error-banner-B9ts0mNl.js";import"./chunk-5FQGJX7Z-DPlx2kjA.js";import"./katex-CDLTCvjQ.js";import"./html-to-image-CIQqSu-S.js";import{t as Lr}from"./chat-display--jAB7huF.js";import"./esm-Bmu2DhPy.js";import{t as Xe}from"./empty-state-B8Cxr9nj.js";var Ir=tt("hat-glasses",[["path",{d:"M14 18a2 2 0 0 0-4 0",key:"1v8fkw"}],["path",{d:"m19 11-2.11-6.657a2 2 0 0 0-2.752-1.148l-1.276.61A2 2 0 0 1 12 4H8.5a2 2 0 0 0-1.925 1.456L5 11",key:"1fkr7p"}],["path",{d:"M2 11h20",key:"3eubbj"}],["circle",{cx:"17",cy:"18",r:"3",key:"82mm0e"}],["circle",{cx:"7",cy:"18",r:"3",key:"lvkj7j"}]]),Pr=tt("notebook-text",[["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["path",{d:"M9.5 8h5",key:"11mslq"}],["path",{d:"M9.5 12H16",key:"ktog6x"}],["path",{d:"M9.5 16H14",key:"p1seyn"}]]),it=Qe(),p=Je(Pt(),1);const Dr=({chatState:e,chatId:t,messages:r})=>{if(!t)return Ae.warn("No active chat"),e;let n=e.chats.get(t);if(!n)return Ae.warn("No active chat"),e;let l=new Map(e.chats),a=Date.now();return l.set(n.id,{...n,messages:r,updatedAt:a}),{...e,chats:l}};var o=Je(Yt(),1);function zr(e,t){return p.useReducer((r,n)=>t[r][n]??r,e)}var Ve="ScrollArea",[ct,po]=xr(Ve),[Mr,M]=ct(Ve),dt=p.forwardRef((e,t)=>{let{__scopeScrollArea:r,type:n="hover",dir:l,scrollHideDelay:a=600,...s}=e,[i,c]=p.useState(null),[u,d]=p.useState(null),[m,h]=p.useState(null),[f,v]=p.useState(null),[S,_]=p.useState(null),[w,N]=p.useState(0),[R,y]=p.useState(0),[j,C]=p.useState(!1),[E,I]=p.useState(!1),g=le(t,k=>c(k)),A=Cr(l);return(0,o.jsx)(Mr,{scope:r,type:n,dir:A,scrollHideDelay:a,scrollArea:i,viewport:u,onViewportChange:d,content:m,onContentChange:h,scrollbarX:f,onScrollbarXChange:v,scrollbarXEnabled:j,onScrollbarXEnabledChange:C,scrollbarY:S,onScrollbarYChange:_,scrollbarYEnabled:E,onScrollbarYEnabledChange:I,onCornerWidthChange:N,onCornerHeightChange:y,children:(0,o.jsx)(pe.div,{dir:A,...s,ref:g,style:{position:"relative","--radix-scroll-area-corner-width":w+"px","--radix-scroll-area-corner-height":R+"px",...e.style}})})});dt.displayName=Ve;var ut="ScrollAreaViewport",pt=p.forwardRef((e,t)=>{let{__scopeScrollArea:r,children:n,nonce:l,...a}=e,s=M(ut,r),i=le(t,p.useRef(null),s.onViewportChange);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:l}),(0,o.jsx)(pe.div,{"data-radix-scroll-area-viewport":"",...a,ref:i,style:{overflowX:s.scrollbarXEnabled?"scroll":"hidden",overflowY:s.scrollbarYEnabled?"scroll":"hidden",...e.style},children:(0,o.jsx)("div",{ref:s.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});pt.displayName=ut;var O="ScrollAreaScrollbar",Be=p.forwardRef((e,t)=>{let{forceMount:r,...n}=e,l=M(O,e.__scopeScrollArea),{onScrollbarXEnabledChange:a,onScrollbarYEnabledChange:s}=l,i=e.orientation==="horizontal";return p.useEffect(()=>(i?a(!0):s(!0),()=>{i?a(!1):s(!1)}),[i,a,s]),l.type==="hover"?(0,o.jsx)(Fr,{...n,ref:t,forceMount:r}):l.type==="scroll"?(0,o.jsx)(Hr,{...n,ref:t,forceMount:r}):l.type==="auto"?(0,o.jsx)(mt,{...n,ref:t,forceMount:r}):l.type==="always"?(0,o.jsx)(qe,{...n,ref:t}):null});Be.displayName=O;var Fr=p.forwardRef((e,t)=>{let{forceMount:r,...n}=e,l=M(O,e.__scopeScrollArea),[a,s]=p.useState(!1);return p.useEffect(()=>{let i=l.scrollArea,c=0;if(i){let u=()=>{window.clearTimeout(c),s(!0)},d=()=>{c=window.setTimeout(()=>s(!1),l.scrollHideDelay)};return i.addEventListener("pointerenter",u),i.addEventListener("pointerleave",d),()=>{window.clearTimeout(c),i.removeEventListener("pointerenter",u),i.removeEventListener("pointerleave",d)}}},[l.scrollArea,l.scrollHideDelay]),(0,o.jsx)(_e,{present:r||a,children:(0,o.jsx)(mt,{"data-state":a?"visible":"hidden",...n,ref:t})})}),Hr=p.forwardRef((e,t)=>{let{forceMount:r,...n}=e,l=M(O,e.__scopeScrollArea),a=e.orientation==="horizontal",s=Ie(()=>c("SCROLL_END"),100),[i,c]=zr("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return p.useEffect(()=>{if(i==="idle"){let u=window.setTimeout(()=>c("HIDE"),l.scrollHideDelay);return()=>window.clearTimeout(u)}},[i,l.scrollHideDelay,c]),p.useEffect(()=>{let u=l.viewport,d=a?"scrollLeft":"scrollTop";if(u){let m=u[d],h=()=>{let f=u[d];m!==f&&(c("SCROLL"),s()),m=f};return u.addEventListener("scroll",h),()=>u.removeEventListener("scroll",h)}},[l.viewport,a,c,s]),(0,o.jsx)(_e,{present:r||i!=="hidden",children:(0,o.jsx)(qe,{"data-state":i==="hidden"?"hidden":"visible",...n,ref:t,onPointerEnter:V(e.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:V(e.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),mt=p.forwardRef((e,t)=>{let r=M(O,e.__scopeScrollArea),{forceMount:n,...l}=e,[a,s]=p.useState(!1),i=e.orientation==="horizontal",c=Ie(()=>{if(r.viewport){let u=r.viewport.offsetWidth<r.viewport.scrollWidth,d=r.viewport.offsetHeight<r.viewport.scrollHeight;s(i?u:d)}},10);return ne(r.viewport,c),ne(r.content,c),(0,o.jsx)(_e,{present:n||a,children:(0,o.jsx)(qe,{"data-state":a?"visible":"hidden",...l,ref:t})})}),qe=p.forwardRef((e,t)=>{let{orientation:r="vertical",...n}=e,l=M(O,e.__scopeScrollArea),a=p.useRef(null),s=p.useRef(0),[i,c]=p.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=gt(i.viewport,i.content),d={...n,sizes:i,onSizesChange:c,hasThumb:u>0&&u<1,onThumbChange:h=>a.current=h,onThumbPointerUp:()=>s.current=0,onThumbPointerDown:h=>s.current=h};function m(h,f){return Vr(h,s.current,i,f)}return r==="horizontal"?(0,o.jsx)(Wr,{...d,ref:t,onThumbPositionChange:()=>{if(l.viewport&&a.current){let h=l.viewport.scrollLeft,f=wt(h,i,l.dir);a.current.style.transform=`translate3d(${f}px, 0, 0)`}},onWheelScroll:h=>{l.viewport&&(l.viewport.scrollLeft=h)},onDragScroll:h=>{l.viewport&&(l.viewport.scrollLeft=m(h,l.dir))}}):r==="vertical"?(0,o.jsx)(Or,{...d,ref:t,onThumbPositionChange:()=>{if(l.viewport&&a.current){let h=l.viewport.scrollTop,f=wt(h,i);a.current.style.transform=`translate3d(0, ${f}px, 0)`}},onWheelScroll:h=>{l.viewport&&(l.viewport.scrollTop=h)},onDragScroll:h=>{l.viewport&&(l.viewport.scrollTop=m(h))}}):null}),Wr=p.forwardRef((e,t)=>{let{sizes:r,onSizesChange:n,...l}=e,a=M(O,e.__scopeScrollArea),[s,i]=p.useState(),c=p.useRef(null),u=le(t,c,a.onScrollbarXChange);return p.useEffect(()=>{c.current&&i(getComputedStyle(c.current))},[c]),(0,o.jsx)(ft,{"data-orientation":"horizontal",...l,ref:u,sizes:r,style:{bottom:0,left:a.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:a.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Le(r)+"px",...e.style},onThumbPointerDown:d=>e.onThumbPointerDown(d.x),onDragScroll:d=>e.onDragScroll(d.x),onWheelScroll:(d,m)=>{if(a.viewport){let h=a.viewport.scrollLeft+d.deltaX;e.onWheelScroll(h),yt(h,m)&&d.preventDefault()}},onResize:()=>{c.current&&a.viewport&&s&&n({content:a.viewport.scrollWidth,viewport:a.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:ke(s.paddingLeft),paddingEnd:ke(s.paddingRight)}})}})}),Or=p.forwardRef((e,t)=>{let{sizes:r,onSizesChange:n,...l}=e,a=M(O,e.__scopeScrollArea),[s,i]=p.useState(),c=p.useRef(null),u=le(t,c,a.onScrollbarYChange);return p.useEffect(()=>{c.current&&i(getComputedStyle(c.current))},[c]),(0,o.jsx)(ft,{"data-orientation":"vertical",...l,ref:u,sizes:r,style:{top:0,right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Le(r)+"px",...e.style},onThumbPointerDown:d=>e.onThumbPointerDown(d.y),onDragScroll:d=>e.onDragScroll(d.y),onWheelScroll:(d,m)=>{if(a.viewport){let h=a.viewport.scrollTop+d.deltaY;e.onWheelScroll(h),yt(h,m)&&d.preventDefault()}},onResize:()=>{c.current&&a.viewport&&s&&n({content:a.viewport.scrollHeight,viewport:a.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:ke(s.paddingTop),paddingEnd:ke(s.paddingBottom)}})}})}),[Ur,ht]=ct(O),ft=p.forwardRef((e,t)=>{let{__scopeScrollArea:r,sizes:n,hasThumb:l,onThumbChange:a,onThumbPointerUp:s,onThumbPointerDown:i,onThumbPositionChange:c,onDragScroll:u,onWheelScroll:d,onResize:m,...h}=e,f=M(O,r),[v,S]=p.useState(null),_=le(t,g=>S(g)),w=p.useRef(null),N=p.useRef(""),R=f.viewport,y=n.content-n.viewport,j=X(d),C=X(c),E=Ie(m,10);function I(g){w.current&&u({x:g.clientX-w.current.left,y:g.clientY-w.current.top})}return p.useEffect(()=>{let g=A=>{let k=A.target;v!=null&&v.contains(k)&&j(A,y)};return document.addEventListener("wheel",g,{passive:!1}),()=>document.removeEventListener("wheel",g,{passive:!1})},[R,v,y,j]),p.useEffect(C,[n,C]),ne(v,E),ne(f.content,E),(0,o.jsx)(Ur,{scope:r,scrollbar:v,hasThumb:l,onThumbChange:X(a),onThumbPointerUp:X(s),onThumbPositionChange:C,onThumbPointerDown:X(i),children:(0,o.jsx)(pe.div,{...h,ref:_,style:{position:"absolute",...h.style},onPointerDown:V(e.onPointerDown,g=>{g.button===0&&(g.target.setPointerCapture(g.pointerId),w.current=v.getBoundingClientRect(),N.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",f.viewport&&(f.viewport.style.scrollBehavior="auto"),I(g))}),onPointerMove:V(e.onPointerMove,I),onPointerUp:V(e.onPointerUp,g=>{let A=g.target;A.hasPointerCapture(g.pointerId)&&A.releasePointerCapture(g.pointerId),document.body.style.webkitUserSelect=N.current,f.viewport&&(f.viewport.style.scrollBehavior=""),w.current=null})})})}),Ee="ScrollAreaThumb",xt=p.forwardRef((e,t)=>{let{forceMount:r,...n}=e,l=ht(Ee,e.__scopeScrollArea);return(0,o.jsx)(_e,{present:r||l.hasThumb,children:(0,o.jsx)(Yr,{ref:t,...n})})}),Yr=p.forwardRef((e,t)=>{let{__scopeScrollArea:r,style:n,...l}=e,a=M(Ee,r),s=ht(Ee,r),{onThumbPositionChange:i}=s,c=le(t,m=>s.onThumbChange(m)),u=p.useRef(void 0),d=Ie(()=>{u.current&&(u.current=(u.current(),void 0))},100);return p.useEffect(()=>{let m=a.viewport;if(m){let h=()=>{d(),u.current||(u.current=Br(m,i),i())};return i(),m.addEventListener("scroll",h),()=>m.removeEventListener("scroll",h)}},[a.viewport,d,i]),(0,o.jsx)(pe.div,{"data-state":s.hasThumb?"visible":"hidden",...l,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:V(e.onPointerDownCapture,m=>{let h=m.target.getBoundingClientRect(),f=m.clientX-h.left,v=m.clientY-h.top;s.onThumbPointerDown({x:f,y:v})}),onPointerUp:V(e.onPointerUp,s.onThumbPointerUp)})});xt.displayName=Ee;var $e="ScrollAreaCorner",vt=p.forwardRef((e,t)=>{let r=M($e,e.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&n?(0,o.jsx)(Xr,{...e,ref:t}):null});vt.displayName=$e;var Xr=p.forwardRef((e,t)=>{let{__scopeScrollArea:r,...n}=e,l=M($e,r),[a,s]=p.useState(0),[i,c]=p.useState(0),u=!!(a&&i);return ne(l.scrollbarX,()=>{var m;let d=((m=l.scrollbarX)==null?void 0:m.offsetHeight)||0;l.onCornerHeightChange(d),c(d)}),ne(l.scrollbarY,()=>{var m;let d=((m=l.scrollbarY)==null?void 0:m.offsetWidth)||0;l.onCornerWidthChange(d),s(d)}),u?(0,o.jsx)(pe.div,{...n,ref:t,style:{width:a,height:i,position:"absolute",right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function ke(e){return e?parseInt(e,10):0}function gt(e,t){let r=e/t;return isNaN(r)?0:r}function Le(e){let t=gt(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,n=(e.scrollbar.size-r)*t;return Math.max(n,18)}function Vr(e,t,r,n="ltr"){let l=Le(r),a=l/2,s=t||a,i=l-s,c=r.scrollbar.paddingStart+s,u=r.scrollbar.size-r.scrollbar.paddingEnd-i,d=r.content-r.viewport,m=n==="ltr"?[0,d]:[d*-1,0];return bt([c,u],m)(e)}function wt(e,t,r="ltr"){let n=Le(t),l=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,a=t.scrollbar.size-l,s=t.content-t.viewport,i=a-n,c=br(e,r==="ltr"?[0,s]:[s*-1,0]);return bt([0,s],[0,i])(c)}function bt(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let n=(t[1]-t[0])/(e[1]-e[0]);return t[0]+n*(r-e[0])}}function yt(e,t){return e>0&&e<t}var Br=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},n=0;return(function l(){let a={left:e.scrollLeft,top:e.scrollTop},s=r.left!==a.left,i=r.top!==a.top;(s||i)&&t(),r=a,n=window.requestAnimationFrame(l)})(),()=>window.cancelAnimationFrame(n)};function Ie(e,t){let r=X(e),n=p.useRef(0);return p.useEffect(()=>()=>window.clearTimeout(n.current),[]),p.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,t)},[r,t])}function ne(e,t){let r=X(t);fr(()=>{let n=0;if(e){let l=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return l.observe(e),()=>{window.cancelAnimationFrame(n),l.unobserve(e)}}},[e,r])}var jt=dt,qr=pt,$r=vt,St=p.forwardRef((e,t)=>{let r=(0,it.c)(15),n,l,a;r[0]===e?(n=r[1],l=r[2],a=r[3]):({className:l,children:n,...a}=e,r[0]=e,r[1]=n,r[2]=l,r[3]=a);let s;r[4]===l?s=r[5]:(s=ae("relative overflow-hidden",l),r[4]=l,r[5]=s);let i;r[6]===n?i=r[7]:(i=(0,o.jsx)(qr,{className:"h-full w-full rounded-[inherit]",children:n}),r[6]=n,r[7]=i);let c,u;r[8]===Symbol.for("react.memo_cache_sentinel")?(c=(0,o.jsx)(Ct,{}),u=(0,o.jsx)($r,{}),r[8]=c,r[9]=u):(c=r[8],u=r[9]);let d;return r[10]!==a||r[11]!==t||r[12]!==s||r[13]!==i?(d=(0,o.jsxs)(jt,{ref:t,className:s,...a,children:[i,c,u]}),r[10]=a,r[11]=t,r[12]=s,r[13]=i,r[14]=d):d=r[14],d});St.displayName=jt.displayName;var Ct=p.forwardRef((e,t)=>{let r=(0,it.c)(14),n,l,a;r[0]===e?(n=r[1],l=r[2],a=r[3]):({className:n,orientation:a,...l}=e,r[0]=e,r[1]=n,r[2]=l,r[3]=a);let s=a===void 0?"vertical":a,i=s==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-px",c=s==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-px",u;r[4]!==n||r[5]!==i||r[6]!==c?(u=ae("flex touch-none select-none transition-colors",i,c,n),r[4]=n,r[5]=i,r[6]=c,r[7]=u):u=r[7];let d;r[8]===Symbol.for("react.memo_cache_sentinel")?(d=(0,o.jsx)(xt,{className:"relative flex-1 rounded-full bg-border"}),r[8]=d):d=r[8];let m;return r[9]!==s||r[10]!==l||r[11]!==t||r[12]!==u?(m=(0,o.jsx)(Be,{ref:t,orientation:s,className:u,...l,children:d}),r[9]=s,r[10]=l,r[11]=t,r[12]=u,r[13]=m):m=r[13],m});Ct.displayName=Be.displayName;var Kr=[{label:"Today",days:0},{label:"Yesterday",days:1},{label:"2d ago",days:2},{label:"3d ago",days:3},{label:"This week",days:7},{label:"This month",days:30}];const Gr=e=>{let t=Date.now(),r=Kr.map(a=>({...a,chats:[]})),n={label:"Older",days:1/0,chats:[]},l=a=>{switch(a){case 0:return r[0];case 1:return r[1];case 2:return r[2];case 3:return r[3];default:return a>=4&&a<=7?r[4]:a>=8&&a<=30?r[5]:n}};for(let a of e)l(Math.floor((t-a.updatedAt)/864e5)).chats.push(a);return[...r,n].filter(a=>a.chats.length>0)},Jr=({activeChatId:e,setActiveChat:t})=>{let r=Ue(nt),{locale:n}=Rr(),[l,a]=(0,p.useState)(""),s=(0,p.useMemo)(()=>[...r.chats.values()].sort((u,d)=>d.updatedAt-u.updatedAt),[r.chats]),i=(0,p.useMemo)(()=>l.trim()?s.filter(u=>u.title.toLowerCase().includes(l.toLowerCase())):s,[s,l]),c=(0,p.useMemo)(()=>Gr(i),[i]);return(0,o.jsxs)(_r,{children:[(0,o.jsx)(Ye,{content:"Previous chats",children:(0,o.jsx)(Tr,{asChild:!0,children:(0,o.jsx)(oe,{variant:"text",size:"icon",children:(0,o.jsx)(Dt,{className:"h-4 w-4"})})})}),(0,o.jsxs)(Ar,{className:"w-[480px] p-0",align:"start",side:"right",children:[(0,o.jsx)("div",{className:"pt-3 px-3 w-full",children:(0,o.jsx)(pr,{placeholder:"Search chat history...",value:l,onChange:u=>a(u.target.value),className:"text-xs"})}),(0,o.jsx)(St,{className:"h-[450px] p-2",children:(0,o.jsxs)("div",{className:"space-y-3",children:[s.length===0&&(0,o.jsx)(Xe,{title:"No chats yet",description:"Start a new chat to get started",icon:(0,o.jsx)(at,{})}),i.length===0&&l&&s.length>0&&(0,o.jsx)(Xe,{title:"No chats found",description:`No chats match "${l}"`,icon:(0,o.jsx)(ur,{})}),c.map((u,d)=>(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsx)("div",{className:"text-xs px-1 text-muted-foreground/60",children:u.label}),(0,o.jsx)("div",{children:u.chats.map(m=>(0,o.jsxs)("button",{className:ae("w-full p-1 rounded-md cursor-pointer text-left flex items-center justify-between",m.id===e&&"bg-accent",m.id!==e&&"hover:bg-muted/20"),onClick:()=>{t(m.id)},type:"button",children:[(0,o.jsx)("div",{className:"flex-1 min-w-0",children:(0,o.jsx)("div",{className:"text-sm truncate",children:m.title})}),(0,o.jsx)("div",{className:"text-xs text-muted-foreground/60 ml-2 flex-shrink-0",children:Nr(m.updatedAt,n)})]},m.id))}),d!==c.length-1&&(0,o.jsx)("hr",{})]},u.label))]})})]})]})};var se=Qe(),Nt="manual",Qr=e=>{let t=(0,se.c)(18),{onNewChat:r,activeChatId:n,setActiveChat:l}=e,{handleClick:a}=Ze(),s;t[0]===Symbol.for("react.memo_cache_sentinel")?(s=(0,o.jsx)(dr,{className:"h-4 w-4"}),t[0]=s):s=t[0];let i;t[1]===r?i=t[2]:(i=(0,o.jsx)(Ye,{content:"New chat",children:(0,o.jsx)(oe,{variant:"text",size:"icon",onClick:r,children:s})}),t[1]=r,t[2]=i);let c;t[3]===Symbol.for("react.memo_cache_sentinel")?(c=(0,o.jsx)(Ft,{}),t[3]=c):c=t[3];let u;t[4]===a?u=t[5]:(u=()=>a("ai"),t[4]=a,t[5]=u);let d;t[6]===Symbol.for("react.memo_cache_sentinel")?(d=(0,o.jsx)(mr,{className:"h-4 w-4"}),t[6]=d):d=t[6];let m;t[7]===u?m=t[8]:(m=(0,o.jsx)(Ye,{content:"AI Settings",children:(0,o.jsx)(oe,{variant:"text",size:"xs",className:"hover:bg-foreground/10 py-2",onClick:u,children:d})}),t[7]=u,t[8]=m);let h;t[9]!==n||t[10]!==l?(h=(0,o.jsx)(Jr,{activeChatId:n,setActiveChat:l}),t[9]=n,t[10]=l,t[11]=h):h=t[11];let f;t[12]!==m||t[13]!==h?(f=(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[c,m,h]}),t[12]=m,t[13]=h,t[14]=f):f=t[14];let v;return t[15]!==i||t[16]!==f?(v=(0,o.jsxs)("div",{className:"flex border-b px-2 py-1 justify-between shrink-0 items-center",children:[i,f]}),t[15]=i,t[16]=f,t[17]=v):v=t[17],v},Rt=(0,p.memo)(e=>{let t=(0,se.c)(15),{message:r,index:n,onEdit:l,isStreamingReasoning:a,isLast:s}=e,i;t[0]!==n||t[1]!==l?(i=S=>{var N,R,y;let _=(R=(N=S.parts)==null?void 0:N.filter(rl))==null?void 0:R.map(ll).join(`
`),w=(y=S.parts)==null?void 0:y.filter(ol);return(0,o.jsxs)("div",{className:"w-[95%] bg-background border p-1 rounded-sm",children:[w==null?void 0:w.map(al),(0,o.jsx)(lt,{value:_,placeholder:"Type your message...",onChange:nl,onSubmit:(j,C)=>{C.trim()&&l(n,C)},onClose:sl},S.id)]})},t[0]=n,t[1]=l,t[2]=i):i=t[2];let c=i,u;t[3]!==s||t[4]!==a?(u=S=>(0,o.jsxs)("div",{className:"w-[95%] wrap-break-word",children:[(0,o.jsx)("div",{className:"absolute right-1 top-1 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,o.jsx)(Er,{className:"h-3 w-3",value:S.parts.filter(il).map(cl).join(`
`)||""})}),Lr({message:S,isStreamingReasoning:a,isLast:s})]}),t[3]=s,t[4]=a,t[5]=u):u=t[5];let d=u,m=r.role==="user"?"justify-end":"justify-start",h;t[6]===m?h=t[7]:(h=ae("flex group relative",m),t[6]=m,t[7]=h);let f;t[8]!==r||t[9]!==d||t[10]!==c?(f=r.role==="user"?c(r):d(r),t[8]=r,t[9]=d,t[10]=c,t[11]=f):f=t[11];let v;return t[12]!==h||t[13]!==f?(v=(0,o.jsx)("div",{className:h,children:f}),t[12]=h,t[13]=f,t[14]=v):v=t[14],v});Rt.displayName="ChatMessage";var Tt=(0,p.memo)(e=>{var D,U;let t=(0,se.c)(39),{isEmpty:r,onSendClick:n,isLoading:l,onStop:a,fileInputRef:s,onAddFiles:i,onAddContext:c}=e,u=Ue(et),d=(u==null?void 0:u.mode)||Nt,m=((D=u==null?void 0:u.models)==null?void 0:D.chat_model)||"openai/gpt-4o",h=Wt.parse(m).providerId,{saveModeChange:f}=Mt(),v;t[0]===Symbol.for("react.memo_cache_sentinel")?(v=[{value:"manual",label:"Manual",subtitle:"Pure chat, no tool usage",Icon:ir},{value:"ask",label:"Ask",subtitle:"Use AI with access to read-only tools like documentation search",Icon:Pr},{value:"agent",label:"Agent (beta)",subtitle:"Use AI with access to read and write tools",Icon:Ir}],t[0]=v):v=t[0];let S=v,_=or.has(h),w=(U=S.find(me=>me.value===d))==null?void 0:U.Icon,N;t[1]===w?N=t[2]:(N=w&&(0,o.jsx)(w,{className:"h-3 w-3"}),t[1]=w,t[2]=N);let R;t[3]===d?R=t[4]:(R=(0,o.jsx)("span",{className:"capitalize",children:d}),t[3]=d,t[4]=R);let y;t[5]!==N||t[6]!==R?(y=(0,o.jsxs)(jr,{className:"h-6 text-xs border-border shadow-none! ring-0! bg-muted hover:bg-muted/30 py-0 px-2 gap-1.5",children:[N,R]}),t[5]=N,t[6]=R,t[7]=y):y=t[7];let j;t[8]===Symbol.for("react.memo_cache_sentinel")?(j=(0,o.jsx)(vr,{className:"text-xs uppercase tracking-wider text-muted-foreground/70 font-medium",children:"AI Mode"}),t[8]=j):j=t[8];let C;t[9]===S?C=t[10]:(C=(0,o.jsx)(wr,{children:(0,o.jsxs)(yr,{children:[j,S.map(dl)]})}),t[9]=S,t[10]=C);let E;t[11]!==d||t[12]!==f||t[13]!==y||t[14]!==C?(E=(0,o.jsxs)(Sr,{value:d,onValueChange:f,children:[y,C]}),t[11]=d,t[12]=f,t[13]=y,t[14]=C,t[15]=E):E=t[15];let I;t[16]===Symbol.for("react.memo_cache_sentinel")?(I=(0,o.jsx)(Ht,{placeholder:"Model",triggerClassName:"h-6 text-xs shadow-none! ring-0! bg-muted hover:bg-muted/30 rounded-sm",iconSize:"small",showAddCustomModelDocs:!0,forRole:"chat"}),t[16]=I):I=t[16];let g;t[17]===E?g=t[18]:(g=(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[E,I]}),t[17]=E,t[18]=g);let A;t[19]!==l||t[20]!==c?(A=(0,o.jsx)(Jt,{handleAddContext:c,isLoading:l}),t[19]=l,t[20]=c,t[21]=A):A=t[21];let k;t[22]!==s||t[23]!==_||t[24]!==l||t[25]!==i?(k=_&&(0,o.jsx)(rr,{fileInputRef:s,isLoading:l,onAddFiles:i}),t[22]=s,t[23]=_,t[24]=l,t[25]=i,t[26]=k):k=t[26];let F;t[27]!==r||t[28]!==l||t[29]!==n||t[30]!==a?(F=(0,o.jsx)(Zt,{isLoading:l,onStop:a,onSendClick:n,isEmpty:r}),t[27]=r,t[28]=l,t[29]=n,t[30]=a,t[31]=F):F=t[31];let H;t[32]!==A||t[33]!==k||t[34]!==F?(H=(0,o.jsxs)("div",{className:"flex flex-row",children:[A,k,F]}),t[32]=A,t[33]=k,t[34]=F,t[35]=H):H=t[35];let T;return t[36]!==H||t[37]!==g?(T=(0,o.jsx)(st,{children:(0,o.jsxs)("div",{className:"px-3 py-2 border-t border-border/20 flex flex-row flex-wrap items-center justify-between gap-1",children:[g,H]})}),t[36]=H,t[37]=g,t[38]=T):T=t[38],T});Tt.displayName="ChatInputFooter";var Ke=(0,p.memo)(e=>{let t=(0,se.c)(29),{placeholder:r,input:n,inputClassName:l,setInput:a,onSubmit:s,inputRef:i,isLoading:c,onStop:u,fileInputRef:d,onAddFiles:m,onClose:h}=e,f;t[0]!==n||t[1]!==s?(f=()=>{n.trim()&&s(void 0,n)},t[0]=n,t[1]=s,t[2]=f):f=t[2];let v=ue(f),S;t[3]===l?S=t[4]:(S=ae("px-2 py-3 flex-1",l),t[3]=l,t[4]=S);let _=r||"Type your message...",w;t[5]!==n||t[6]!==i||t[7]!==m||t[8]!==h||t[9]!==s||t[10]!==a||t[11]!==_?(w=(0,o.jsx)(lt,{inputRef:i,value:n,onChange:a,onSubmit:s,onClose:h,onAddFiles:m,placeholder:_}),t[5]=n,t[6]=i,t[7]=m,t[8]=h,t[9]=s,t[10]=a,t[11]=_,t[12]=w):w=t[12];let N;t[13]!==S||t[14]!==w?(N=(0,o.jsx)("div",{className:S,children:w}),t[13]=S,t[14]=w,t[15]=N):N=t[15];let R=!n.trim(),y;t[16]===i?y=t[17]:(y=()=>qt(i),t[16]=i,t[17]=y);let j;t[18]!==d||t[19]!==v||t[20]!==c||t[21]!==m||t[22]!==u||t[23]!==R||t[24]!==y?(j=(0,o.jsx)(Tt,{isEmpty:R,onAddContext:y,onSendClick:v,isLoading:c,onStop:u,fileInputRef:d,onAddFiles:m}),t[18]=d,t[19]=v,t[20]=c,t[21]=m,t[22]=u,t[23]=R,t[24]=y,t[25]=j):j=t[25];let C;return t[26]!==N||t[27]!==j?(C=(0,o.jsxs)("div",{className:"relative shrink-0 min-h-[80px] flex flex-col border-t",children:[N,j]}),t[26]=N,t[27]=j,t[28]=C):C=t[28],C});Ke.displayName="ChatInput";var Zr=()=>{let e=(0,se.c)(6),t=Ue(Ot),{handleClick:r}=Ze();if(!t){let l;e[0]===r?l=e[1]:(l=(0,o.jsx)(oe,{variant:"outline",size:"sm",onClick:()=>r("ai","ai-providers"),children:"Edit AI settings"}),e[0]=r,e[1]=l);let a;e[2]===Symbol.for("react.memo_cache_sentinel")?(a=(0,o.jsx)(at,{}),e[2]=a):a=e[2];let s;return e[3]===l?s=e[4]:(s=(0,o.jsx)(Xe,{title:"Chat with AI",description:"No AI provider configured or Chat model not selected",action:l,icon:a}),e[3]=l,e[4]=s),s}let n;return e[5]===Symbol.for("react.memo_cache_sentinel")?(n=(0,o.jsx)(el,{}),e[5]=n):n=e[5],n},el=()=>{let e=(0,se.c)(95),t=kt(nt),[r,n]=It(hr),[l,a]=(0,p.useState)(""),[s,i]=(0,p.useState)(""),{files:c,addFiles:u,clearFiles:d,removeFile:m}=Gt(),h=(0,p.useRef)(null),f=(0,p.useRef)(null),v=(0,p.useRef)(null),S=(0,p.useRef)(null),_=(0,p.useRef)(null),w=Ut(),{invokeAiTool:N,sendRun:R}=Xt(),y=r==null?void 0:r.id,j=Lt(),{addStagedCell:C}=$t(),{createNewCell:E,prepareForRun:I}=zt(),g;e[0]!==C||e[1]!==E||e[2]!==I||e[3]!==R||e[4]!==j?(g={addStagedCell:C,createNewCell:E,prepareForRun:I,sendRun:R,store:j},e[0]=C,e[1]=E,e[2]=I,e[3]=R,e[4]=j,e[5]=g):g=e[5];let A=g,k;e[6]===(r==null?void 0:r.messages)?k=e[7]:(k=(r==null?void 0:r.messages)||[],e[6]=r==null?void 0:r.messages,e[7]=k);let F;if(e[8]!==w||e[9]!==j){let x;e[11]===j?x=e[12]:(x=async b=>{var re;let L=await lr(b.messages),W=((re=j.get(et))==null?void 0:re.mode)||Nt;return{body:{tools:Vt.getToolSchemas(W),...b,...L}}},e[11]=j,e[12]=x),F=new Bt({api:w.getAiURL("chat").toString(),headers:w.headers(),prepareSendMessagesRequest:x}),e[8]=w,e[9]=j,e[10]=F}else F=e[10];let H;e[13]===t?H=e[14]:(H=x=>{let{messages:b}=x;t(L=>Dr({chatState:L,chatId:L.activeChatId,messages:b}))},e[13]=t,e[14]=H);let{messages:T,sendMessage:D,error:U,status:me,regenerate:Pe,stop:Y,addToolOutput:At,id:De}=tr({id:y,sendAutomaticallyWhen:ul,messages:k,transport:F,onFinish:H,onToolCall:async x=>{let{toolCall:b}=x;if(b.dynamic){Ae.debug("Skipping dynamic tool call",b);return}await Kt({invokeAiTool:N,addToolOutput:_t,toolCall:{toolName:b.toolName,toolCallId:b.toolCallId,input:b.input},toolContext:A})},onError:pl}),_t=At,P=me==="submitted"||me==="streaming",he;e[15]!==P||e[16]!==T?(he=P&&T.length>0&&sr(T),e[15]=P,e[16]=T,e[17]=he):he=e[17];let ie=he,fe;e[18]===Symbol.for("react.memo_cache_sentinel")?(fe=()=>{requestAnimationFrame(()=>{if(v.current){let x=v.current;x.scrollTop=x.scrollHeight}})},e[18]=fe):fe=e[18];let xe;e[19]===y?xe=e[20]:(xe=[y],e[19]=y,e[20]=xe),(0,p.useEffect)(fe,xe);let ve;e[21]!==De||e[22]!==d||e[23]!==D||e[24]!==t?(ve=async(x,b)=>{let L=Date.now(),W={id:De,title:er(x),messages:[],createdAt:L,updatedAt:L};t(de=>{let Ge=new Map(de.chats);return Ge.set(W.id,W),{...de,chats:Ge,activeChatId:W.id}});let re=b&&b.length>0?await rt(b):void 0;D({role:"user",parts:[{type:"text",text:x},...re??[]]}),d(),a("")},e[21]=De,e[22]=d,e[23]=D,e[24]=t,e[25]=ve):ve=e[25];let ze=ve,ge;e[26]!==d||e[27]!==n?(ge=()=>{n(null),a(""),i(""),d()},e[26]=d,e[27]=n,e[28]=ge):ge=e[28];let Me=ue(ge),we;e[29]!==T||e[30]!==D?(we=(x,b)=>{var de;let L=T[x],W=(de=L.parts)==null?void 0:de.filter(ml),re=L.id;D({messageId:re,role:"user",parts:[{type:"text",text:b},...W]})},e[29]=T,e[30]=D,e[31]=we):we=e[31];let ce=ue(we),be;e[32]!==d||e[33]!==c||e[34]!==D?(be=async(x,b)=>{var W;if(!b.trim())return;(W=f.current)!=null&&W.view&&ot(f.current.view);let L=c?await rt(c):void 0;x==null||x.preventDefault(),D({text:b,files:L}),a(""),d()},e[32]=d,e[33]=c,e[34]=D,e[35]=be):be=e[35];let Fe=ue(be),ye;e[36]===Pe?ye=e[37]:(ye=()=>{Pe()},e[36]=Pe,e[37]=ye);let He=ye,je;e[38]!==ze||e[39]!==c||e[40]!==s?(je=()=>{var x;s.trim()&&((x=h.current)!=null&&x.view&&ot(h.current.view),ze(s.trim(),c))},e[38]=ze,e[39]=c,e[40]=s,e[41]=je):je=e[41];let We=ue(je),Se;e[42]===Symbol.for("react.memo_cache_sentinel")?(Se=()=>{var x,b;return(b=(x=h.current)==null?void 0:x.editor)==null?void 0:b.blur()},e[42]=Se):Se=e[42];let Et=Se,z=T.length===0,Ce;e[43]!==u||e[44]!==Fe||e[45]!==We||e[46]!==l||e[47]!==P||e[48]!==z||e[49]!==s||e[50]!==Y?(Ce=z?(0,o.jsx)(Ke,{placeholder:"Ask anything, @ to include context about tables or dataframes",input:s,inputRef:h,inputClassName:"px-1 py-0",setInput:i,onSubmit:We,isLoading:P,onStop:Y,fileInputRef:S,onAddFiles:u,onClose:Et},"new-thread-input"):(0,o.jsx)(Ke,{input:l,setInput:a,onSubmit:Fe,inputRef:f,isLoading:P,onStop:Y,onClose:()=>{var x,b;return(b=(x=f.current)==null?void 0:x.editor)==null?void 0:b.blur()},fileInputRef:S,onAddFiles:u}),e[43]=u,e[44]=Fe,e[45]=We,e[46]=l,e[47]=P,e[48]=z,e[49]=s,e[50]=Y,e[51]=Ce):Ce=e[51];let B=Ce,Ne;e[52]!==c||e[53]!==z||e[54]!==m?(Ne=c&&c.length>0&&(0,o.jsx)("div",{className:ae("flex flex-row gap-1 flex-wrap p-1",z&&"py-2 px-1"),children:c==null?void 0:c.map(x=>(0,o.jsx)(Qt,{file:x,onRemove:()=>m(x)},x.name))}),e[52]=c,e[53]=z,e[54]=m,e[55]=Ne):Ne=e[55];let q=Ne,Oe=r==null?void 0:r.id,$;e[56]!==Me||e[57]!==n||e[58]!==Oe?($=(0,o.jsx)(st,{children:(0,o.jsx)(Qr,{onNewChat:Me,activeChatId:Oe,setActiveChat:n})}),e[56]=Me,e[57]=n,e[58]=Oe,e[59]=$):$=e[59];let K;e[60]!==B||e[61]!==q||e[62]!==z?(K=z&&(0,o.jsxs)("div",{className:"rounded-md border bg-background",children:[q,B]}),e[60]=B,e[61]=q,e[62]=z,e[63]=K):K=e[63];let G;if(e[64]!==ce||e[65]!==ie||e[66]!==T){let x;e[68]!==ce||e[69]!==ie||e[70]!==T.length?(x=(b,L)=>(0,o.jsx)(Rt,{message:b,index:L,onEdit:ce,isStreamingReasoning:ie,isLast:L===T.length-1},b.id),e[68]=ce,e[69]=ie,e[70]=T.length,e[71]=x):x=e[71],G=T.map(x),e[64]=ce,e[65]=ie,e[66]=T,e[67]=G}else G=e[67];let J;e[72]===P?J=e[73]:(J=P&&(0,o.jsx)("div",{className:"flex justify-center py-4",children:(0,o.jsx)(cr,{className:"h-4 w-4 animate-spin"})}),e[72]=P,e[73]=J);let Q;e[74]!==U||e[75]!==He?(Q=U&&(0,o.jsxs)("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[(0,o.jsx)(kr,{error:U||Error("Unknown error")}),(0,o.jsx)(oe,{variant:"outline",size:"sm",onClick:He,children:"Retry"})]}),e[74]=U,e[75]=He,e[76]=Q):Q=e[76];let Re;e[77]===Symbol.for("react.memo_cache_sentinel")?(Re=(0,o.jsx)("div",{ref:_}),e[77]=Re):Re=e[77];let Z;e[78]!==K||e[79]!==G||e[80]!==J||e[81]!==Q?(Z=(0,o.jsxs)("div",{className:"flex-1 px-3 bg-(--slate-1) gap-4 py-3 flex flex-col overflow-y-auto",ref:v,children:[K,G,J,Q,Re]}),e[78]=K,e[79]=G,e[80]=J,e[81]=Q,e[82]=Z):Z=e[82];let ee;e[83]!==P||e[84]!==Y?(ee=P&&(0,o.jsx)("div",{className:"w-full flex justify-center items-center z-20 border-t",children:(0,o.jsx)(oe,{variant:"linkDestructive",size:"sm",onClick:Y,children:"Stop"})}),e[83]=P,e[84]=Y,e[85]=ee):ee=e[85];let te;e[86]!==B||e[87]!==q||e[88]!==z?(te=!z&&(0,o.jsxs)(o.Fragment,{children:[q,B]}),e[86]=B,e[87]=q,e[88]=z,e[89]=te):te=e[89];let Te;return e[90]!==$||e[91]!==Z||e[92]!==ee||e[93]!==te?(Te=(0,o.jsxs)("div",{className:"flex flex-col h-[calc(100%-53px)]",children:[$,Z,ee,te]}),e[90]=$,e[91]=Z,e[92]=ee,e[93]=te,e[94]=Te):Te=e[94],Te},tl=Zr;function rl(e){return e.type==="text"}function ll(e){return e.text}function ol(e){return e.type==="file"}function al(e,t){return(0,o.jsx)(ar,{attachment:e},t)}function nl(){}function sl(){}function il(e){return e.type==="text"}function cl(e){return e.text}function dl(e){return(0,o.jsx)(gr,{value:e.value,className:"text-xs py-1",children:(0,o.jsxs)("div",{className:"flex items-start gap-2.5",children:[(0,o.jsx)("span",{className:"mt-1 text-muted-foreground",children:(0,o.jsx)(e.Icon,{className:"h-3 w-3"})}),(0,o.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,o.jsx)("span",{className:"font-semibold",children:e.label}),(0,o.jsx)("span",{className:"text-muted-foreground",children:e.subtitle})]})]})},e.value)}function ul(e){let{messages:t}=e;return nr(t)}function pl(e){Ae.error("An error occurred:",e)}function ml(e){return e.type==="file"}export{tl as default};
